Loading a Hamiltonian from a file
#################################


Supported features
==================

Horton offers the possibility to import Hamiltonians generated by other quantum chemistry software packages. The following features are supported

1. Spin-restricted orbitals
2. ``DenseLinalgFactory``. Note that ``CholeskyLinalgFactory`` is not supported.



Supported file formats
======================

.. _molprohamformat:

ASCII format
------------

If the external Hamiltonian is stored in ASCII format, the integrals must be sorted according to the Molpro file convention. An example input file for a system containing 46 electrons and 115 orbitals is as follows

.. code-block:: text

     &FCI NORB=115, NELEC=46, MS2=0,
      ORBSYM=1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
     1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
     1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
     1,1,1,1,1,
      ISYM=1,
     &END
       0.2449044606843990E+01   1   1   1   1
       0.4127424125971091E-06   2   1   1   1
       0.2290646773300842E+01   2   1   2   1
       .
       .
       .
       0.2915770720675271E-14 115 112   0   0
      -0.2158974591374400E-13 115 113   0   0
       0.1681155215038643E-12 115 114   0   0
       0.7737232651538216E+02 115 115   0   0
       0.1723786836502994E+03   0   0   0   0

The input file is divided into two blocks. The first block (between ``&FCI`` and ``&END``) contains system-specific information:

    :NORB: number of orbitals/basis functions
    :NELEC: number of electrons
    :MS2: spin projection
    :ORBSYM: irreducible representation of each orbital
    :ISYM: total symmetry of the wavefunction

The second block (after ``&END``) contains the one- and two-electron integrals as well as the core energy. First, all symmetry-unique elements of the two-electron integrals are listed, where the first column is the value of the integral, followed by the orbital indices. Note that the orbital indices (``i j k l``) need to be given in chemists' notation,

.. math::

    (ij\vert kl) = \langle ik \vert jl \rangle = \int \phi_i^*(\mathbf{x}_1) \phi_k^*(\mathbf{x}_2) \frac{1}{r_{12}} \phi_j(\mathbf{x}_1) \phi_l(\mathbf{x}_2) d\mathbf{x}_1 d\mathbf{x}_2

Second, all symmetry-unique elements of the one-electron integrals are listed, where again the first column is the value of the integral, followed by the orbital indices. Note that the last two columns contain zeros.

The core energy (for instance, the nuclear repulsion term, etc.) is written on the last line with all orbital indices equal 0.


.. _readhamfromfile:

How to read a Hamiltonian from file
===================================


ASCII format
------------

If the Hamiltonian is stored in ASCII format (see :ref:`molprohamformat` for further details), the one- and two-electron integrals as well as the core energy can be imported in Horton as follows

.. code-block:: python

    one, two, coreenergy = load_fcidump(lf, filename='./FCIDUMP')

with arguments

    :lf: A linear algebra factory. Must be of type ``DenseLinalgFactory``

and optional arguments

    :filename: (str) the filename containing the Hamiltonian (default ``FCIDUMP``)

The function ``load_fcidump`` has 3 return values; the one-electron integrals (``one``) stored as a ``TwoIndex`` object, the two-electron integrals (``two``) stored as a ``FourIndex`` object, and the core energy (``coreenergy``, float).


Example input files
===================

TODO: This will be done differently, i.e. quote few lines from a complete example.
