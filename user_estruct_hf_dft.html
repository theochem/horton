

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>4.1. How to use HORTON as a Hartree-Fock/DFT program &mdash; HORTON 2.0.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
    <link rel="top" title="HORTON 2.0.0 documentation" href="index.html"/>
        <link rel="up" title="4. Electronic Structure Methods" href="user_estruct.html"/>
        <link rel="next" title="4.2. The AP1roG module" href="user_estruct_ap1rog.html"/>
        <link rel="prev" title="4. Electronic Structure Methods" href="user_estruct.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="index.html">
        

        
          
          <img src="_static/horton.png" class="logo" />
        
        </a>

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul>
<li class="toctree-l1"><a class="reference internal" href="intro_horton_overview.html">1. HORTON Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="intro_horton_overview.html#our-manifesto">1.1. Our Manifesto</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro_horton_overview.html#main-features">1.2. Main Features</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="intro_citing_horton.html">2. Citing HORTON</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro_license_information.html">3. License Information</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro_contact_information.html">4. Contact Information</a></li>
</ul>
<p class="caption"><span class="caption-text">User documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="user_download_and_install.html">1. Download and Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="user_download_and_install_linux.html">1.1. Download and installation on Linux (Fedora and Ubuntu)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="user_download_and_install_linux.html#disclaimer">1.1.1. Disclaimer</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_download_and_install_linux.html#download-the-code">1.1.2. Download the code</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_download_and_install_linux.html#dependencies-for-building-installing-and-testing-horton">1.1.3. Dependencies for building, installing and testing HORTON</a><ul>
<li class="toctree-l4"><a class="reference internal" href="user_download_and_install_linux.html#installing-dependencies-with-a-package-manager">1.1.3.1. Installing dependencies with a package manager</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_download_and_install_linux.html#installing-dependencies-manually">1.1.3.2. Installing dependencies manually</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="user_download_and_install_linux.html#compilation-and-installation">1.1.4. Compilation and installation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="user_download_and_install_linux.html#build-and-install">1.1.4.1. Build and install</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_download_and_install_linux.html#overriding-default-compiler-linker-settings-for-libxc-libint2-and-blas">1.1.4.2. Overriding default compiler/linker settings for LibXC, LibInt2 and BLAS</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_download_and_install_linux.html#runtime-configuration">1.1.4.3. Runtime configuration</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="user_download_and_install_linux.html#running-the-tests">1.1.5. Running the tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_download_and_install_linux.html#building-the-documentation">1.1.6. Building the documentation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="user_download_and_install_linux.html#dependencies">1.1.6.1. Dependencies</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_download_and_install_linux.html#installing-the-dependencies-with-a-package-manager-and-pip">1.1.6.2. Installing the dependencies with a package manager and PIP</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_download_and_install_linux.html#actual-build">1.1.6.3. Actual build</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="user_download_and_install_mac.html">1.2. Download and installation on Mac OS X (10.8&#8211;10.10)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="user_download_and_install_mac.html#disclaimer">1.2.1. Disclaimer</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_download_and_install_mac.html#macports">1.2.2. MacPorts</a><ul>
<li class="toctree-l4"><a class="reference internal" href="user_download_and_install_mac.html#quick-tour-of-macports">1.2.2.1. Quick tour of MacPorts</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="user_download_and_install_mac.html#download-the-code">1.2.3. Download the code</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_download_and_install_mac.html#dependencies-for-building-installing-and-testing-horton">1.2.4. Dependencies for building, installing and testing HORTON</a><ul>
<li class="toctree-l4"><a class="reference internal" href="user_download_and_install_mac.html#installing-the-dependencies-with-macports">1.2.4.1. Installing the dependencies with MacPorts</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_download_and_install_mac.html#installing-dependencies-manually">1.2.4.2. Installing dependencies manually</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="user_download_and_install_mac.html#compilation-and-installation">1.2.5. Compilation and installation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="user_download_and_install_mac.html#build-and-install">1.2.5.1. Build and install</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_download_and_install_mac.html#overriding-default-compiler-linker-settings-for-libxc-libint2-and-blas">1.2.5.2. Overriding default compiler/linker settings for LibXC, LibInt2 and BLAS</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_download_and_install_mac.html#runtime-configuration">1.2.5.3. Runtime configuration</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="user_download_and_install_mac.html#running-the-tests">1.2.6. Running the tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_download_and_install_mac.html#building-the-documentation">1.2.7. Building the documentation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="user_download_and_install_mac.html#dependencies">1.2.7.1. Dependencies</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_download_and_install_mac.html#installing-the-dependencies-with-macports-and-pip">1.2.7.2. Installing the dependencies with MacPorts and PIP</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_download_and_install_mac.html#actual-build">1.2.7.3. Actual build</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="user_download_and_install_setup_cfg.html">1.3. Controlling dynamic/static linking against LibXC, LibInt2 and BLAS</a><ul>
<li class="toctree-l3"><a class="reference internal" href="user_download_and_install_setup_cfg.html#introduction">1.3.1. Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_download_and_install_setup_cfg.html#setup-cfg-and-environment-variables">1.3.2. <code class="docutils literal"><span class="pre">setup.cfg</span></code> and environment variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_download_and_install_setup_cfg.html#other-ways-of-controlling-compilation-and-linker-flags">1.3.3. Other ways of controlling compilation and linker flags</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="user_download_and_install_troubleshooting.html">1.4. Troubleshooting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="user_download_and_install_troubleshooting.html#introduction">1.4.1. Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_download_and_install_troubleshooting.html#python-modules">1.4.2. Python modules</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_download_and_install_troubleshooting.html#excecutables">1.4.3. Excecutables</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_download_and_install_troubleshooting.html#libraries">1.4.4. Libraries</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="user_getting_started.html">2. Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="user_getting_started.html#how-to-use-horton">2.1. How to use HORTON?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="user_getting_started.html#running-horton-as-a-python-library">2.1.1. Running HORTON as a Python library</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_getting_started.html#running-horton-as-horton-py-scripts">2.1.2. Running HORTON as <code class="docutils literal"><span class="pre">horton-*.py</span></code> scripts</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="user_getting_started.html#writing-a-basic-horton-python-script">2.2. Writing a basic HORTON Python script</a><ul>
<li class="toctree-l3"><a class="reference internal" href="user_getting_started.html#atomic-units">2.2.1. Atomic Units</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_getting_started.html#array-indexing">2.2.2. Array Indexing</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_getting_started.html#loading-dumping-data-from-to-a-file">2.2.3. Loading/Dumping Data from/to a File</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_getting_started.html#periodic-table">2.2.4. Periodic Table</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_getting_started.html#a-complete-example">2.2.5. A Complete Example</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="user_hamiltonian.html">3. Hamiltonians</a><ul>
<li class="toctree-l2"><a class="reference internal" href="user_hamiltonian_molecular.html">3.1. Molecular Hamiltonians</a><ul>
<li class="toctree-l3"><a class="reference internal" href="user_hamiltonian_molecular.html#specifying-the-molecular-geometry">3.1.1. Specifying the molecular geometry</a><ul>
<li class="toctree-l4"><a class="reference internal" href="user_hamiltonian_molecular.html#reading-the-molecular-geometry-from-file">3.1.1.1. Reading the molecular geometry from file</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_hamiltonian_molecular.html#constructing-a-molecular-geometry-from-scratch">3.1.1.2. Constructing a molecular geometry from scratch</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="user_hamiltonian_molecular.html#specifying-the-basis-set">3.1.2. Specifying the basis set</a><ul>
<li class="toctree-l4"><a class="reference internal" href="user_hamiltonian_molecular.html#unique-basis-set-for-all-atoms">3.1.2.1. Unique basis set for all atoms</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_hamiltonian_molecular.html#specifying-different-basis-sets-for-different-atoms">3.1.2.2. Specifying different basis sets for different atoms</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_hamiltonian_molecular.html#loading-custom-basis-sets-from-file">3.1.2.3. Loading custom basis sets from file</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_hamiltonian_molecular.html#defining-basis-sets-with-python-code">3.1.2.4. Defining basis sets with Python code</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_hamiltonian_molecular.html#loading-geometry-and-basis-set-info-from-one-file">3.1.2.5. Loading geometry and basis set info from one file</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="user_hamiltonian_molecular.html#computing-hamiltonian-matrix-elements">3.1.3. Computing (Hamiltonian) matrix elements</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="user_hamiltonian_model.html">3.2. Defining a model Hamiltonian</a><ul>
<li class="toctree-l3"><a class="reference internal" href="user_hamiltonian_model.html#supported-features">3.2.1. Supported features</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_hamiltonian_model.html#the-hubbard-model-hamiltonian">3.2.2. The Hubbard model Hamiltonian</a><ul>
<li class="toctree-l4"><a class="reference internal" href="user_hamiltonian_model.html#preliminaries">3.2.2.1. Preliminaries</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_hamiltonian_model.html#defining-the-hamiltonian-and-boundary-conditions-open-or-periodic">3.2.2.2. Defining the Hamiltonian and boundary conditions (open or periodic)</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_hamiltonian_model.html#filling-the-lattice">3.2.2.3. Filling the lattice</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_hamiltonian_model.html#generate-initial-guess-orbitals-and-overlap-matrix">3.2.2.4. Generate initial guess orbitals and overlap matrix</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="user_hamiltonian_model.html#example-python-script">3.2.3. Example Python script</a><ul>
<li class="toctree-l4"><a class="reference internal" href="user_hamiltonian_model.html#restricted-hartree-fock-calculations-using-the-1-dim-hubbard-model-hamiltonian-with-pbc">3.2.3.1. Restricted Hartree-Fock calculations using the 1-dim Hubbard model Hamiltonian with PBC</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="user_hamiltonian_io.html">3.3. Dumping/Loading a Hamiltonian to/from a file</a><ul>
<li class="toctree-l3"><a class="reference internal" href="user_hamiltonian_io.html#horton-s-internal-format">3.3.1. HORTON&#8217;s internal format</a><ul>
<li class="toctree-l4"><a class="reference internal" href="user_hamiltonian_io.html#dumping">3.3.1.1. Dumping</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_hamiltonian_io.html#loading">3.3.1.2. Loading</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="user_hamiltonian_io.html#fcidump-format">3.3.2. FCIDUMP format</a><ul>
<li class="toctree-l4"><a class="reference internal" href="user_hamiltonian_io.html#id1">3.3.2.1. Dumping</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_hamiltonian_io.html#id2">3.3.2.2. Loading</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="user_estruct.html">4. Electronic Structure Methods</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="">4.1. How to use HORTON as a Hartree-Fock/DFT program</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#setting-up-the-molecular-electronic-hamiltonian">4.1.1. Setting up the (molecular electronic) Hamiltonian</a></li>
<li class="toctree-l3"><a class="reference internal" href="#generating-an-initial-guess-of-the-wavefunction">4.1.2. Generating an initial guess of the wavefunction</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#core-hamiltonian-guess">4.1.2.1. Core Hamiltonian guess</a></li>
<li class="toctree-l4"><a class="reference internal" href="#randomizing-an-initial-guess">4.1.2.2. Randomizing an initial guess</a></li>
<li class="toctree-l4"><a class="reference internal" href="#modifying-the-initial-guess">4.1.2.3. Modifying the initial guess</a></li>
<li class="toctree-l4"><a class="reference internal" href="#reading-a-guess-from-a-file">4.1.2.4. Reading a guess from a file</a></li>
<li class="toctree-l4"><a class="reference internal" href="#projecting-orbitals-from-a-smaller-basis-onto-a-larger-one">4.1.2.5. Projecting orbitals from a smaller basis onto a larger one</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#defining-the-effective-hamiltonian">4.1.3. Defining the effective Hamiltonian</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#supported-energy-terms-for-the-effective-hamiltonians">4.1.3.1. Supported energy terms for the effective Hamiltonians</a></li>
<li class="toctree-l4"><a class="reference internal" href="#a-few-typical-examples">4.1.3.2. A few typical examples</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#choose-an-orbital-occupation-scheme">4.1.4. Choose an orbital occupation scheme</a></li>
<li class="toctree-l3"><a class="reference internal" href="#optimize-the-wavefunction-with-a-self-consistent-field-algorithm">4.1.5. Optimize the wavefunction with a self-consistent field algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="#conversion-of-density-and-fock-matrix-to-orbitals">4.1.6. Conversion of density and Fock matrix to orbitals</a></li>
<li class="toctree-l3"><a class="reference internal" href="#writing-scf-results-to-a-file">4.1.7. Writing SCF results to a file</a></li>
<li class="toctree-l3"><a class="reference internal" href="#preparing-for-a-post-hartree-fock-calculation">4.1.8. Preparing for a Post-Hartree-Fock calculation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#transforming-the-hamiltonian-to-the-molecular-orbital-mo-basis">4.1.8.1. Transforming the Hamiltonian to the molecular-orbital (MO) basis</a></li>
<li class="toctree-l4"><a class="reference internal" href="#reducing-the-hamiltonian-to-an-active-space">4.1.8.2. Reducing the Hamiltonian to an active space</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#complete-examples">4.1.9. Complete examples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="user_estruct_ap1rog.html">4.2. The AP1roG module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="user_estruct_ap1rog.html#the-ap1rog-model">4.2.1. The AP1roG model</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_estruct_ap1rog.html#currently-supported-features">4.2.2. Currently supported features</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_estruct_ap1rog.html#input-structure">4.2.3. Input structure</a><ul>
<li class="toctree-l4"><a class="reference internal" href="user_estruct_ap1rog.html#getting-started">4.2.3.1. Getting started</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_estruct_ap1rog.html#ap1rog-with-orbital-optimization">4.2.3.2. AP1roG with orbital optimization</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_estruct_ap1rog.html#ap1rog-without-orbital-optimization">4.2.3.3. AP1roG without orbital optimization</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="user_estruct_ap1rog.html#troubleshooting-in-ap1rog-scf-calculations">4.2.4. Troubleshooting in AP1roG-SCF calculations</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_estruct_ap1rog.html#example-python-scripts">4.2.5. Example Python scripts</a><ul>
<li class="toctree-l4"><a class="reference internal" href="user_estruct_ap1rog.html#the-water-molecule-a-minimum-input-example">4.2.5.1. The water molecule (a minimum input example)</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_estruct_ap1rog.html#the-water-molecule-with-all-default-keyword-arguments">4.2.5.2. The water molecule (with all default keyword arguments)</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_estruct_ap1rog.html#ap1rog-with-external-integrals">4.2.5.3. AP1roG with external integrals</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_estruct_ap1rog.html#ap1rog-using-model-hamiltonians">4.2.5.4. AP1roG using model Hamiltonians</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="user_estruct_perturbation.html">4.3. The perturbation theory module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="user_estruct_perturbation.html#supported-features">4.3.1. Supported features</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_estruct_perturbation.html#moller-plesset-perturbation-theory-of-second-order">4.3.2. Moller-Plesset perturbation theory of second order</a><ul>
<li class="toctree-l4"><a class="reference internal" href="user_estruct_perturbation.html#getting-started">4.3.2.1. Getting started</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_estruct_perturbation.html#how-to-set-up-an-mp2-calculation">4.3.2.2. How to set-up an MP2 calculation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="user_estruct_perturbation.html#the-pta-module">4.3.3. The PTa module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="user_estruct_perturbation.html#getstartedpta">4.3.3.1. Getting started</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_estruct_perturbation.html#how-to-set-up-a-calculation">4.3.3.2. How to set-up a calculation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="user_estruct_perturbation.html#the-ptb-module">4.3.4. The PTb module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="user_estruct_perturbation.html#getstartedptb">4.3.4.1. Getting started</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_estruct_perturbation.html#id5">4.3.4.2. How to set-up a calculation</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_estruct_perturbation.html#summary-of-keyword-arguments">4.3.4.3. Summary of keyword arguments</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="user_estruct_perturbation.html#example-python-scripts">4.3.5. Example Python scripts</a><ul>
<li class="toctree-l4"><a class="reference internal" href="user_estruct_perturbation.html#mp2-calculation-on-the-water-molecule">4.3.5.1. MP2 calculation on the water molecule</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_estruct_perturbation.html#pta-calculation-on-the-water-molecule">4.3.5.2. PTa calculation on the water molecule</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_estruct_perturbation.html#ptb-calculation-on-the-water-molecule">4.3.5.3. PTb calculation on the water molecule</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="user_postproc.html">5. Post-processing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="user_postproc_aim.html">5.1. Atoms-in-Molecules (AIM) analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="user_postproc_aim.html#introduction">5.1.1. Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_postproc_aim.html#horton-atomdb-py-build-a-pro-atom-database">5.1.2. <code class="docutils literal"><span class="pre">horton-atomdb.py</span></code> &#8211; Build a pro-atom database</a><ul>
<li class="toctree-l4"><a class="reference internal" href="user_postproc_aim.html#template-files">5.1.2.1. Template files</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_postproc_aim.html#basic-template-file-for-gaussian-03-09">5.1.2.2. Basic template file for Gaussian 03/09</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_postproc_aim.html#advanced-template-file-for-gaussian-03-09">5.1.2.3. Advanced template file for Gaussian 03/09</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_postproc_aim.html#simple-template-file-for-orca">5.1.2.4. Simple template file for ORCA</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_postproc_aim.html#template-file-for-cp2k">5.1.2.5. Template file for CP2K</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_postproc_aim.html#simple-template-file-for-psi4">5.1.2.6. Simple template file for PSI4</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="user_postproc_aim.html#horton-wpart-py-aim-analysis-based-on-a-wavefunction-file">5.1.3. <code class="docutils literal"><span class="pre">horton-wpart.py</span></code> &#8211; AIM analysis based on a wavefunction file</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_postproc_aim.html#horton-cpart-py-aim-analysis-based-on-a-cube-file">5.1.4. <code class="docutils literal"><span class="pre">horton-cpart.py</span></code> &#8211; AIM analysis based on a cube file</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_postproc_aim.html#python-interface-to-the-partitioning-code">5.1.5. Python interface to the partitioning code</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_postproc_aim.html#frequently-asked-questions">5.1.6. Frequently asked questions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="user_postproc_espfit.html">5.2. Electrostatic potential fitting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="user_postproc_espfit.html#introduction">5.2.1. Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_postproc_espfit.html#horton-esp-cost-py-set-up-an-esp-cost-function">5.2.2. <code class="docutils literal"><span class="pre">horton-esp-cost.py</span></code> &#8211; Set up an ESP cost function</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_postproc_espfit.html#horton-esp-fit-py-fit-atomic-charges-to-the-esp">5.2.3. <code class="docutils literal"><span class="pre">horton-esp-fit.py</span></code> &#8211; Fit atomic charges to the ESP</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_postproc_espfit.html#horton-esp-test-py-test-the-esp-quality-of-a-given-set-of-charges">5.2.4. <code class="docutils literal"><span class="pre">horton-esp-test.py</span></code> &#8211; Test the ESP quality of a given set of charges</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_postproc_espfit.html#making-nice-cube-files-with-gaussian">5.2.5. Making nice cube files with Gaussian</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_postproc_espfit.html#making-cube-files-with-cp2k">5.2.6. Making cube files with CP2K</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_postproc_espfit.html#python-interface-to-the-esp-fitting-code">5.2.7. Python interface to the ESP fitting code</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="user_postproc_localization.html">5.3. Localization of molecular orbitals</a><ul>
<li class="toctree-l3"><a class="reference internal" href="user_postproc_localization.html#pipek-mezey-localization">5.3.1. Pipek-Mezey localization</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_postproc_localization.html#example-python-scripts">5.3.2. Example Python scripts</a><ul>
<li class="toctree-l4"><a class="reference internal" href="user_postproc_localization.html#pipek-mezey-localization-of-restricted-hartree-fock-orbitals-for-the-water-molecule">5.3.2.1. Pipek-Mezey localization of restricted Hartree-Fock orbitals for the water molecule</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="user_postproc_orbital_entanglement.html">5.4. Orbital entanglement analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="user_postproc_orbital_entanglement.html#orbital-entanglement-and-orbital-correlation">5.4.1. Orbital entanglement and orbital correlation</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_postproc_orbital_entanglement.html#supported-features">5.4.2. Supported features</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_postproc_orbital_entanglement.html#orbital-entanglement-and-correlation-for-a-seniority-zero-wavefunction">5.4.3. Orbital entanglement and correlation for a seniority zero wavefunction</a><ul>
<li class="toctree-l4"><a class="reference internal" href="user_postproc_orbital_entanglement.html#how-to-set-up-a-calculation">5.4.3.1. How to set-up a calculation</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_postproc_orbital_entanglement.html#how-to-generate-correlation-diagrams">5.4.3.2. How to generate correlation diagrams</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="user_postproc_orbital_entanglement.html#example-python-scripts">5.4.4. Example Python scripts</a><ul>
<li class="toctree-l4"><a class="reference internal" href="user_postproc_orbital_entanglement.html#orbital-entanglement-analysis-of-an-ap1rog-wavefunction">5.4.4.1. Orbital entanglement analysis of an AP1roG wavefunction</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="user_other.html">6. Other Topics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="user_other_numerical_integration.html">6.1. How to use HORTON for numerical integration?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="user_other_numerical_integration.html#building-an-integration-grid">6.1.1. Building an integration grid</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_other_numerical_integration.html#computing-an-integral-involving-the-electron-density">6.1.2. Computing an integral involving the electron density</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_other_numerical_integration.html#constructing-a-one-body-operator-from-a-real-space-potential">6.1.3. Constructing a one-body operator from a real-space potential</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="user_other_matrix.html">6.2. How to use HORTON&#8217;s <code class="docutils literal"><span class="pre">matrix</span></code> package?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="user_other_matrix.html#introduction">6.2.1. Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_other_matrix.html#using-the-matrix-package">6.2.2. Using the <code class="docutils literal"><span class="pre">matrix</span></code> package</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="user_other_conversion.html">6.3. How to use HORTON to convert between file formats?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="user_other_conversion.html#horton-convert-py-conversion-between-file-formats-supported-by-horton">6.3.1. <code class="docutils literal"><span class="pre">horton-convert.py</span></code> &#8211; Conversion between file formats supported by HORTON</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_other_conversion.html#horton-hdf2csv-py-conversion-of-hdf5-files-to-csv-format">6.3.2. <code class="docutils literal"><span class="pre">horton-hdf2csv.py</span></code> &#8211; Conversion of HDF5 files to CSV format</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Technical stuff</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tech_dev.html">1. Developer Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tech_dev_coding_guidelines.html">1.1. Coding guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="tech_dev_git.html">1.2. How to use Git</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tech_dev_git.html#installing-git">1.2.1. Installing Git</a></li>
<li class="toctree-l3"><a class="reference internal" href="tech_dev_git.html#git-configuration">1.2.2. Git configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="tech_dev_git.html#some-terminology">1.2.3. Some terminology</a></li>
<li class="toctree-l3"><a class="reference internal" href="tech_dev_git.html#cloning-the-horton-git-repository">1.2.4. Cloning the HORTON git repository</a></li>
<li class="toctree-l3"><a class="reference internal" href="tech_dev_git.html#additional-steps-required-to-build-the-development-version-of-horton">1.2.5. Additional steps required to build the development version of HORTON</a></li>
<li class="toctree-l3"><a class="reference internal" href="tech_dev_git.html#work-flow-for-adding-a-new-feature">1.2.6. Work flow for adding a new feature</a><ul>
<li class="toctree-l4"><a class="reference internal" href="tech_dev_git.html#develop-the-feature-in-a-separate-branch">1.2.6.1. Develop the feature in a separate branch</a></li>
<li class="toctree-l4"><a class="reference internal" href="tech_dev_git.html#make-your-branch-available-for-review">1.2.6.2. Make your branch available for review</a></li>
<li class="toctree-l4"><a class="reference internal" href="tech_dev_git.html#rebase-your-branch-on-top-of-the-master-branch">1.2.6.3. Rebase your branch on top of the <code class="docutils literal"><span class="pre">master</span></code> branch</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="tech_dev_git.html#common-issues">1.2.7. Common issues</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tech_dev_documentation.html">1.3. Writing documentation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tech_dev_documentation.html#introduction">1.3.1. Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="tech_dev_documentation.html#building-documentation">1.3.2. Building documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="tech_dev_documentation.html#common-issues">1.3.3. Common issues</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tech_dev_unit_tests.html">1.4. Writing unit tests</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tech_dev_unit_tests.html#running-the-tests">1.4.1. Running the tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="tech_dev_unit_tests.html#writing-new-tests">1.4.2. Writing new tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="tech_dev_unit_tests.html#writing-tests-that-need-a-temporary-directory">1.4.3. Writing tests that need a temporary directory</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tech_dev_examples.html">1.5. Writing examples scripts</a></li>
<li class="toctree-l2"><a class="reference internal" href="tech_dev_citing_papers.html">1.6. Citing scientific work</a></li>
<li class="toctree-l2"><a class="reference internal" href="tech_dev_cython.html">1.7. Accelerating HORTON code with Cython</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tech_dev_cython.html#before-you-begin">1.7.1. Before you begin</a></li>
<li class="toctree-l3"><a class="reference internal" href="tech_dev_cython.html#basic-example">1.7.2. Basic example</a><ul>
<li class="toctree-l4"><a class="reference internal" href="tech_dev_cython.html#background">1.7.2.1. Background</a></li>
<li class="toctree-l4"><a class="reference internal" href="tech_dev_cython.html#cythonizing-your-code">1.7.2.2. Cythonizing your code</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="tech_dev_cython.html#additional-notes">1.7.3. Additional notes</a></li>
<li class="toctree-l3"><a class="reference internal" href="tech_dev_cython.html#further-reading">1.7.4. Further reading</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tech_ref.html">2. Reference Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tech_ref_contributors.html">2.1. Contributors</a></li>
<li class="toctree-l2"><a class="reference internal" href="tech_ref_release_planning.html">2.2. Release planning</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tech_ref_release_planning.html#stable-api-and-beta-code">2.2.1. Stable API and beta code</a></li>
<li class="toctree-l3"><a class="reference internal" href="tech_ref_release_planning.html#unstable-code-in-horton-version">2.2.2. Unstable code in HORTON 2.0.0</a></li>
<li class="toctree-l3"><a class="reference internal" href="tech_ref_release_planning.html#features-in-development">2.2.3. Features in development</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tech_ref_release_history.html">2.3. Release history</a></li>
<li class="toctree-l2"><a class="reference internal" href="tech_ref_file_formats.html">2.4. Data file formats (input and output)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tech_ref_file_formats.html#molecular-geometry-file-formats">2.4.1. Molecular geometry file formats</a><ul>
<li class="toctree-l4"><a class="reference internal" href="tech_ref_file_formats.html#the-xyz-format">2.4.1.1. The <code class="docutils literal"><span class="pre">.xyz</span></code> format</a></li>
<li class="toctree-l4"><a class="reference internal" href="tech_ref_file_formats.html#the-poscar-format">2.4.1.2. The <code class="docutils literal"><span class="pre">POSCAR</span></code> format</a></li>
<li class="toctree-l4"><a class="reference internal" href="tech_ref_file_formats.html#the-cif-crystalographic-information-file-format">2.4.1.3. The <code class="docutils literal"><span class="pre">.cif</span></code> (Crystalographic Information File) format</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="tech_ref_file_formats.html#cube-file-formats">2.4.2. Cube file formats</a><ul>
<li class="toctree-l4"><a class="reference internal" href="tech_ref_file_formats.html#the-gaussian-cube-format">2.4.2.1. The Gaussian <code class="docutils literal"><span class="pre">.cube</span></code> format</a></li>
<li class="toctree-l4"><a class="reference internal" href="tech_ref_file_formats.html#the-vasp-chgcar-and-locpot-formats">2.4.2.2. The VASP <code class="docutils literal"><span class="pre">CHGCAR</span></code> and <code class="docutils literal"><span class="pre">LOCPOT</span></code> formats</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="tech_ref_file_formats.html#wavefunction-formats-using-a-gaussian-basis-set">2.4.3. Wavefunction formats (using a Gaussian basis set)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="tech_ref_file_formats.html#the-gaussian-fchk-format">2.4.3.1. The Gaussian <code class="docutils literal"><span class="pre">.fchk</span></code> format</a></li>
<li class="toctree-l4"><a class="reference internal" href="tech_ref_file_formats.html#the-molden-format">2.4.3.2. The <code class="docutils literal"><span class="pre">.molden</span></code> format</a></li>
<li class="toctree-l4"><a class="reference internal" href="tech_ref_file_formats.html#the-mkl-molekel-format">2.4.3.3. The <code class="docutils literal"><span class="pre">.mkl</span></code> (Molekel) format</a></li>
<li class="toctree-l4"><a class="reference internal" href="tech_ref_file_formats.html#the-wfn-format">2.4.3.4. The <code class="docutils literal"><span class="pre">.wfn</span></code> format</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="tech_ref_file_formats.html#hamiltonian-file-formats">2.4.4. Hamiltonian file formats</a><ul>
<li class="toctree-l4"><a class="reference internal" href="tech_ref_file_formats.html#the-molpro-2012-fcidump-format">2.4.4.1. The Molpro 2012 <code class="docutils literal"><span class="pre">FCIDUMP</span></code> format</a></li>
<li class="toctree-l4"><a class="reference internal" href="tech_ref_file_formats.html#the-gaussian-log-file">2.4.4.2. The Gaussian <code class="docutils literal"><span class="pre">.log</span></code> file</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="tech_ref_file_formats.html#horton-s-internal-file-format">2.4.5. HORTON&#8217;s internal file format</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tech_ref_grids.html">2.5. Atomic integration grids</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tech_ref_grids.html#built-in-grids">2.5.1. Built-in grids</a></li>
<li class="toctree-l3"><a class="reference internal" href="tech_ref_grids.html#the-grid-option">2.5.2. The <code class="docutils literal"><span class="pre">--grid</span></code> option</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tech_ref_gaussian_basis.html">2.6. Gaussian basis sets</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tech_ref_gaussian_basis.html#standard-basis-sets">2.6.1. Standard basis sets</a></li>
<li class="toctree-l3"><a class="reference internal" href="tech_ref_gaussian_basis.html#collected-notes-on-gaussian-basis-sets">2.6.2. Collected notes on Gaussian basis sets</a><ul>
<li class="toctree-l4"><a class="reference internal" href="tech_ref_gaussian_basis.html#introduction">2.6.2.1. Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="tech_ref_gaussian_basis.html#cartesian-basis-functions">2.6.2.2. Cartesian basis functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="tech_ref_gaussian_basis.html#pure-or-harmonic-basis-functions">2.6.2.3. Pure or harmonic basis functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="tech_ref_gaussian_basis.html#transformation-from-cartesian-to-pure-basis-functions">2.6.2.4. Transformation from Cartesian to pure basis functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="tech_ref_gaussian_basis.html#recursion-relations-for-real-regular-solid-harmonics">2.6.2.5. Recursion relations for real regular solid harmonics</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tech_ref_functionals.html">2.7. LibXC Functionals</a></li>
<li class="toctree-l2"><a class="reference internal" href="tech_ref_acronyms.html">2.8. Acronyms</a></li>
<li class="toctree-l2"><a class="reference internal" href="tech_ref_dictionary.html">2.9. HORTON dictionary of variables</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tech_ref_dictionary.html#rules">2.9.1. Rules</a></li>
<li class="toctree-l3"><a class="reference internal" href="tech_ref_dictionary.html#variable-names-and-prefixes">2.9.2. Variable names and prefixes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tech_ref_literature.html">2.10. Literature</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tech_api.html">3. API Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="lib/pck_horton.html">3.1. <code class="docutils literal"><span class="pre">horton</span></code> &#8211; The main HORTON Package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_cache.html">3.1.1. <code class="docutils literal"><span class="pre">horton.cache</span></code> &#8211; Avoid recomputation of earlier results and reallocation of existing arrays</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_cext.html">3.1.2. <code class="docutils literal"><span class="pre">horton.cext</span></code> &#8211; C++ extensions</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_constants.html">3.1.3. <code class="docutils literal"><span class="pre">horton.constants</span></code> &#8211; Physicochemical constants in atomic units</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_context.html">3.1.4. <code class="docutils literal"><span class="pre">horton.context</span></code> &#8211; The context in which HORTON is used</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_exceptions.html">3.1.5. <code class="docutils literal"><span class="pre">horton.exceptions</span></code> &#8211; Definition of all excpetions in HORTON</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_log.html">3.1.6. <code class="docutils literal"><span class="pre">horton.log</span></code> &#8211; Screen logging, timing and citation management</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_moments.html">3.1.7. <code class="docutils literal"><span class="pre">horton.moments</span></code> &#8211; Auxiliary routines related to multipole moments</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_orbital_utils.html">3.1.8. <code class="docutils literal"><span class="pre">horton.orbital_utils</span></code> &#8211; Utility functions for orbital modifications</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_periodic.html">3.1.9. <code class="docutils literal"><span class="pre">horton.periodic</span></code> &#8211; Periodic table of elements</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_quadprog.html">3.1.10. <code class="docutils literal"><span class="pre">horton.quadprog</span></code> &#8211; A light-weight quadratic programming solver</a><ul>
<li class="toctree-l4"><a class="reference internal" href="lib/mod_horton_quadprog.html#notation">3.1.10.1. Notation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_symmetry.html">3.1.11. <code class="docutils literal"><span class="pre">horton.symmetry</span></code> &#8211; Geometric symmetries</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_units.html">3.1.12. <code class="docutils literal"><span class="pre">horton.units</span></code> &#8211; Conversion from and to atomic units</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_utils.html">3.1.13. <code class="docutils literal"><span class="pre">horton.utils</span></code> &#8211; Utility functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_cell_h.html">3.1.14. <code class="docutils literal"><span class="pre">horton/cell.h</span></code> &#8211; Unit cell code to specify periodic boundary conditions</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_moments_h.html">3.1.15. <code class="docutils literal"><span class="pre">horton/moments.h</span></code> &#8211; Efficient evaluation of various of polynomials</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_nucpot_h.html">3.1.16. <code class="docutils literal"><span class="pre">horton/nucpot.h</span></code> &#8211; Low-level implementation of nuclear potential on a grid</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="lib/pck_horton_correlatedwfn.html">3.2. <code class="docutils literal"><span class="pre">horton.correlatedwfn</span></code> &#8211; Methods for correlated wavefunctions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_correlatedwfn_geminal.html">3.2.1. <code class="docutils literal"><span class="pre">horton.correlatedwfn.geminal</span></code> &#8211; Correlated wavefunction implementations</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_correlatedwfn_perturbation.html">3.2.2. <code class="docutils literal"><span class="pre">horton.correlatedwfn.perturbation</span></code> &#8211; Perturbation theory module</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_correlatedwfn_restricted_ap1rog.html">3.2.3. <code class="docutils literal"><span class="pre">horton.correlatedwfn.restricted_ap1rog</span></code> &#8211; Correlated wavefunction implementations</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_correlatedwfn_stepsearch.html">3.2.4. <code class="docutils literal"><span class="pre">horton.correlatedwfn.stepsearch</span></code> &#8211; Step search methods for orbital rotations</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_correlatedwfn_trustregionopt.html">3.2.5. <code class="docutils literal"><span class="pre">horton.correlatedwfn.trustregionopt</span></code> &#8211; Optimization of Newton step</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="lib/pck_horton_espfit.html">3.3. <code class="docutils literal"><span class="pre">horton.espfit</span></code> &#8211; Electrostatic potential fitting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_espfit_cext.html">3.3.1. <code class="docutils literal"><span class="pre">horton.espfit.cext</span></code> &#8211; C++ extensions</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_espfit_cost.html">3.3.2. <code class="docutils literal"><span class="pre">horton.espfit.cost</span></code> &#8211; ESP cost functions for estimating and testing charges</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_espfit_electrostatics_h.html">3.3.3. <code class="docutils literal"><span class="pre">horton/espfit/electrostatics.h</span></code> &#8211; Computation of ESP cost functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_espfit_mask_h.html">3.3.4. <code class="docutils literal"><span class="pre">horton/espfit/mask.h</span></code> &#8211; Computation of weights for ESP cost functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="lib/pck_horton_gbasis.html">3.4. <code class="docutils literal"><span class="pre">horton.gbasis</span></code> &#8211; Gaussian basis sets</a><ul>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_gbasis_cext.html">3.4.1. <code class="docutils literal"><span class="pre">horton.gbasis.cext</span></code> &#8211; C++ extensions</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_gbasis_gobasis.html">3.4.2. <code class="docutils literal"><span class="pre">horton.gbasis.gobasis</span></code> &#8211; Gaussian orbital basis set module.</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_gbasis_iobas.html">3.4.3. <code class="docutils literal"><span class="pre">horton.gbasis.iobas</span></code> &#8211; Input/Output routines for gaussian basis sets</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_gbasis_boys_h.html">3.4.4. <code class="docutils literal"><span class="pre">horton/gbasis/boys.h</span></code> &#8211; The Boys function</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_gbasis_calc_h.html">3.4.5. <code class="docutils literal"><span class="pre">horton/gbasis/calc.h</span></code> &#8211; Base class for any integral/evaluation of Gaussian functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_gbasis_cartpure_h.html">3.4.6. <code class="docutils literal"><span class="pre">horton/gbasis/cartpure.h</span></code> &#8211; Conversion of Cartesian to Pure Gaussian functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_gbasis_cholesky_h.html">3.4.7. <code class="docutils literal"><span class="pre">horton/gbasis/cholesky.h</span></code> &#8211; Cholesky decomposition of (any) four-center integrals</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_gbasis_common_h.html">3.4.8. <code class="docutils literal"><span class="pre">horton/gbasis/common.h</span></code> &#8211; Auxiliary functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_gbasis_fns_h.html">3.4.9. <code class="docutils literal"><span class="pre">horton/gbasis/fns.h</span></code> &#8211; Evaluation of functions expanded in a Gaussian basis</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_gbasis_gbasis_h.html">3.4.10. <code class="docutils literal"><span class="pre">horton/gbasis/gbasis.h</span></code> &#8211; Gaussian basis set classes</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_gbasis_gbw_h.html">3.4.11. <code class="docutils literal"><span class="pre">horton/gbasis/gbw.h</span></code> &#8211; A four-center integral wrapper for the Cholesky code</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_gbasis_ints_h.html">3.4.12. <code class="docutils literal"><span class="pre">horton/gbasis/ints.h</span></code> &#8211; Evaluation of integrals of Gaussian basis functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_gbasis_iter_gb_h.html">3.4.13. <code class="docutils literal"><span class="pre">horton/gbasis/iter_gb.h</span></code> &#8211; Iterators over Gaussian basis functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_gbasis_iter_pow_h.html">3.4.14. <code class="docutils literal"><span class="pre">horton/gbasis/iter_pow.h</span></code> &#8211; Iterators over Cartesian polynomials in one shell</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="lib/pck_horton_grid.html">3.5. <code class="docutils literal"><span class="pre">horton.grid</span></code> &#8211; Numerical integration grids</a><ul>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_grid_atgrid.html">3.5.1. <code class="docutils literal"><span class="pre">horton.grid.atgrid</span></code> &#8211; Atomic grids</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_grid_base.html">3.5.2. <code class="docutils literal"><span class="pre">horton.grid.base</span></code> &#8211; Base classes for 3D integration grids</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_grid_cext.html">3.5.3. <code class="docutils literal"><span class="pre">horton.grid.cext</span></code> &#8211; C++ extensions</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_grid_int1d.html">3.5.4. <code class="docutils literal"><span class="pre">horton.grid.int1d</span></code> &#8211; 1D integration algorithms</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_grid_molgrid.html">3.5.5. <code class="docutils literal"><span class="pre">horton.grid.molgrid</span></code> &#8211; Molecular integration grids</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_grid_ode2.html">3.5.6. <code class="docutils literal"><span class="pre">horton.grid.ode2</span></code> &#8211; Finite-element second-order ODE solver</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_grid_poisson.html">3.5.7. <code class="docutils literal"><span class="pre">horton.grid.poisson</span></code> &#8211; Becke-style numerical Poisson solver</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_grid_radial.html">3.5.8. <code class="docutils literal"><span class="pre">horton.grid.radial</span></code> &#8211; 1D Radial integration grid</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_grid_utils.html">3.5.9. <code class="docutils literal"><span class="pre">horton.grid.utils</span></code> &#8211; Auxiliaries for numerical integrals</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_grid_visual.html">3.5.10. <code class="docutils literal"><span class="pre">horton.grid.visual</span></code> &#8211; Grids suitable for visualization</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_grid_becke_h.html">3.5.11. <code class="docutils literal"><span class="pre">horton/grid/becke.h</span></code> &#8211; Becke partitioning weight function</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_grid_cubic_spline_h.html">3.5.12. <code class="docutils literal"><span class="pre">horton/grid/cubic_spline.h</span></code> &#8211; One-dimensional cubic splines (on uniform grids)</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_grid_evaluate_h.html">3.5.13. <code class="docutils literal"><span class="pre">horton/grid/evaluate.h</span></code> &#8211; Evaluation of splines on grids</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_grid_lebedev_laikov_h.html">3.5.14. <code class="docutils literal"><span class="pre">horton/grid/lebedev_laikov.h</span></code> &#8211; Grids for quadrature on a sphere</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_grid_ode2_h.html">3.5.15. <code class="docutils literal"><span class="pre">horton/grid/ode2.h</span></code> &#8211; Second-order finite-element ODE solver using Hermite polynomials</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_grid_rtransform_h.html">3.5.16. <code class="docutils literal"><span class="pre">horton/grid/rtransform.h</span></code> &#8211; Transformation from uniform 1D to non-uniform 1D grids</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_grid_uniform_h.html">3.5.17. <code class="docutils literal"><span class="pre">horton/grid/uniform.h</span></code> &#8211; Uniform 3D grids</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_grid_utils_h.html">3.5.18. <code class="docutils literal"><span class="pre">horton/grid/utils.h</span></code> &#8211; Auxiliary functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="lib/pck_horton_io.html">3.6. <code class="docutils literal"><span class="pre">horton.io</span></code> &#8211; Input and output routines</a><ul>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_io_cif.html">3.6.1. <code class="docutils literal"><span class="pre">horton.io.cif</span></code> &#8211; Crystalographic Information File format</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_io_cp2k.html">3.6.2. <code class="docutils literal"><span class="pre">horton.io.cp2k</span></code> &#8211; CP2K atomic wavefunctions</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_io_cube.html">3.6.3. <code class="docutils literal"><span class="pre">horton.io.cube</span></code> &#8211; Gaussian cube file format</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_io_gaussian.html">3.6.4. <code class="docutils literal"><span class="pre">horton.io.gaussian</span></code> &#8211; Gaussian LOG and FCHK file fromats</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_io_internal.html">3.6.5. <code class="docutils literal"><span class="pre">horton.io.internal</span></code> &#8211; HORTON internal file format</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_io_iodata.html">3.6.6. <code class="docutils literal"><span class="pre">horton.io.iodata</span></code> &#8211; Input/output dispatcher for different file formats</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_io_lockedh5.html">3.6.7. <code class="docutils literal"><span class="pre">horton.io.lockedh5</span></code> &#8211; H5 file with lock</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_io_molden.html">3.6.8. <code class="docutils literal"><span class="pre">horton.io.molden</span></code> &#8211; Molden wavefunction input file format</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_io_molekel.html">3.6.9. <code class="docutils literal"><span class="pre">horton.io.molekel</span></code> &#8211; Molekel wavefunction input file format</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_io_molpro.html">3.6.10. <code class="docutils literal"><span class="pre">horton.io.molpro</span></code> &#8211; Molpro 2012 FCIDUMP format.</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_io_vasp.html">3.6.11. <code class="docutils literal"><span class="pre">horton.io.vasp</span></code> &#8211; VASP POSCAR, CHGCAR and POTCAR file formats</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_io_wfn.html">3.6.12. <code class="docutils literal"><span class="pre">horton.io.wfn</span></code> &#8211; WFN File format (Gaussian and GAMESS)</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_io_xyz.html">3.6.13. <code class="docutils literal"><span class="pre">horton.io.xyz</span></code> &#8211; XYZ file format</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="lib/pck_horton_localization.html">3.7. <code class="docutils literal"><span class="pre">horton.localization</span></code> &#8211; Methods for orbital localization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_localization_localization.html">3.7.1. <code class="docutils literal"><span class="pre">horton.localization.localization</span></code> &#8211; Orbital localization procedures</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="lib/pck_horton_matrix.html">3.8. <code class="docutils literal"><span class="pre">horton.matrix</span></code> &#8211; One-, two-, three- and four-dimensional matrix implementations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_matrix_base.html">3.8.1. <code class="docutils literal"><span class="pre">horton.matrix.base</span></code> &#8211; Base classes</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_matrix_cext.html">3.8.2. <code class="docutils literal"><span class="pre">horton.matrix.cext</span></code> &#8211; C++ extensions for matrix package</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_matrix_cholesky.html">3.8.3. <code class="docutils literal"><span class="pre">horton.matrix.cholesky</span></code> &#8211; Cholesky decomposition of four-index objects</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_matrix_dense.html">3.8.4. <code class="docutils literal"><span class="pre">horton.matrix.dense</span></code> &#8211; Dense matrix implementations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="lib/mod_horton_matrix_dense.html#naming-scheme-for-the-contract-slice-or-expand-methods">3.8.4.1. Naming scheme for the contract, slice or expand methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="lib/mod_horton_matrix_dense.html#handling-of-index-symmetry">3.8.4.2. Handling of index symmetry</a></li>
<li class="toctree-l4"><a class="reference internal" href="lib/mod_horton_matrix_dense.html#dense-matrix-classes">3.8.4.3. Dense matrix classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_matrix_slicing_h.html">3.8.5. <code class="docutils literal"><span class="pre">horton/matrix/slicing.h</span></code> &#8211; Low-level routines for <code class="docutils literal"><span class="pre">CholeskyLinalgFactory</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="lib/pck_horton_meanfield.html">3.9. <code class="docutils literal"><span class="pre">horton.meanfield</span></code> &#8211; Mean-field electronic structure code</a><ul>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_meanfield_bond_order.html">3.9.1. <code class="docutils literal"><span class="pre">horton.meanfield.bond_order</span></code> &#8211; Generic implementation of bond orders for mean-field wavefunctions</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_meanfield_builtin.html">3.9.2. <code class="docutils literal"><span class="pre">horton.meanfield.builtin</span></code> &#8211; Built-in energy terms</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_meanfield_cext.html">3.9.3. <code class="docutils literal"><span class="pre">horton.meanfield.cext</span></code> &#8211; C++ extensions</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_meanfield_convergence.html">3.9.4. <code class="docutils literal"><span class="pre">horton.meanfield.convergence</span></code> &#8211; Evaluation of convergence criteria</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_meanfield_gridgroup.html">3.9.5. <code class="docutils literal"><span class="pre">horton.meanfield.gridgroup</span></code> &#8211; Container for observables involving numerical integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_meanfield_guess.html">3.9.6. <code class="docutils literal"><span class="pre">horton.meanfield.guess</span></code> &#8211; Initial guesses for wavefunctions</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_meanfield_hamiltonian.html">3.9.7. <code class="docutils literal"><span class="pre">horton.meanfield.hamiltonian</span></code> &#8211; Mean-field DFT/HF Hamiltonian data structures</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_meanfield_libxc.html">3.9.8. <code class="docutils literal"><span class="pre">horton.meanfield.libxc</span></code> &#8211; Interface to LDA, GGA and hybrid functionals from LibXC</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_meanfield_observable.html">3.9.9. <code class="docutils literal"><span class="pre">horton.meanfield.observable</span></code> &#8211; Base classes for energy terms and other observables of the wavefunction</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_meanfield_occ.html">3.9.10. <code class="docutils literal"><span class="pre">horton.meanfield.occ</span></code> &#8211; Occupation number models</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_meanfield_project.html">3.9.11. <code class="docutils literal"><span class="pre">horton.meanfield.project</span></code> &#8211; Projection of 1-electron orbitals to a new basis set</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_meanfield_response.html">3.9.12. <code class="docutils literal"><span class="pre">horton.meanfield.response</span></code> &#8211; Evaluation of response functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_meanfield_rotate.html">3.9.13. <code class="docutils literal"><span class="pre">horton.meanfield.rotate</span></code> &#8211; Rotation of orbitals</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_meanfield_scf.html">3.9.14. <code class="docutils literal"><span class="pre">horton.meanfield.scf</span></code> &#8211; Basic Self-Consistent Field (SCF) algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_meanfield_scf_cdiis.html">3.9.15. <code class="docutils literal"><span class="pre">horton.meanfield.scf_cdiis</span></code> &#8211; Commutator DIIS SCF algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_meanfield_scf_diis.html">3.9.16. <code class="docutils literal"><span class="pre">horton.meanfield.scf_diis</span></code> &#8211; Abstract DIIS code used by the different DIIS implementations</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_meanfield_scf_ediis.html">3.9.17. <code class="docutils literal"><span class="pre">horton.meanfield.scf_ediis</span></code> &#8211; Energy DIIS SCF algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_meanfield_scf_ediis2.html">3.9.18. <code class="docutils literal"><span class="pre">horton.meanfield.scf_ediis2</span></code> &#8211; EDIIS+DIIS SCF algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_meanfield_scf_oda.html">3.9.19. <code class="docutils literal"><span class="pre">horton.meanfield.scf_oda</span></code> &#8211; Optimal Damping SCF algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_meanfield_utils.html">3.9.20. <code class="docutils literal"><span class="pre">horton.meanfield.utils</span></code> &#8211; Utility functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="lib/pck_horton_modelhamiltonians.html">3.10. <code class="docutils literal"><span class="pre">horton.modelhamiltonians</span></code> &#8211; Model Hamiltonians</a><ul>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_modelhamiltonians_physmodham.html">3.10.1. <code class="docutils literal"><span class="pre">horton.modelhamiltonians.physmodham</span></code> &#8211; Physical Model Hamiltonian</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="lib/pck_horton_orbital_entanglement.html">3.11. <code class="docutils literal"><span class="pre">horton.orbital_entanglement</span></code> &#8211; Methods for measuring orbital entanglement</a><ul>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_orbital_entanglement_orbital_entanglement.html">3.11.1. <code class="docutils literal"><span class="pre">horton.orbital_entanglement.orbital_entanglement</span></code> &#8211; One- and two-orbital entanglement measures</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="lib/pck_horton_part.html">3.12. <code class="docutils literal"><span class="pre">horton.part</span></code> &#8211; Density-based partitioning (fuzzy atoms-in-molecules) package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_part_base.html">3.12.1. <code class="docutils literal"><span class="pre">horton.part.base</span></code> &#8211; Base classes for (atoms-in-molecules) partitioning algorithms</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_part_becke.html">3.12.2. <code class="docutils literal"><span class="pre">horton.part.becke</span></code> &#8211; Becke partitioning</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_part_hirshfeld.html">3.12.3. <code class="docutils literal"><span class="pre">horton.part.hirshfeld</span></code> &#8211; Hirshfeld partitioning</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_part_hirshfeld_e.html">3.12.4. <code class="docutils literal"><span class="pre">horton.part.hirshfeld_e</span></code> &#8211; Extended Hirshfeld (HE) partitioning</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_part_hirshfeld_i.html">3.12.5. <code class="docutils literal"><span class="pre">horton.part.hirshfeld_i</span></code> &#8211; Iterative Hirshfeld (HI) partitioning</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_part_iterstock.html">3.12.6. <code class="docutils literal"><span class="pre">horton.part.iterstock</span></code> &#8211; Iterative Stockholder Analysis (ISA) partitioning</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_part_mbis.html">3.12.7. <code class="docutils literal"><span class="pre">horton.part.mbis</span></code> &#8211; Minimal Basis Iterative Stockholder (MBIS) partitioning</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_part_mulliken.html">3.12.8. <code class="docutils literal"><span class="pre">horton.part.mulliken</span></code> &#8211; Mulliken partitioning</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_part_proatomdb.html">3.12.9. <code class="docutils literal"><span class="pre">horton.part.proatomdb</span></code> &#8211; Pro-atom databases</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_part_stockholder.html">3.12.10. <code class="docutils literal"><span class="pre">horton.part.stockholder</span></code> &#8211; Base classes for all stockholder partitioning schemes</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_part_symmetry.html">3.12.11. <code class="docutils literal"><span class="pre">horton.part.symmetry</span></code> &#8211; Symmetry analysis of atoms-in-molecules results</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="lib/pck_horton_scripts.html">3.13. <code class="docutils literal"><span class="pre">horton.scripts</span></code> &#8211; Code (solely) used by HORTON&#8217;s command line scripts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_scripts_atomdb.html">3.13.1. <code class="docutils literal"><span class="pre">horton.scripts.atomdb</span></code> &#8211; Code used by <code class="docutils literal"><span class="pre">horton-atomdb.py</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_scripts_common.html">3.13.2. <code class="docutils literal"><span class="pre">horton.scripts.common</span></code> &#8211; Code shared by several scripts</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_scripts_cpart.html">3.13.3. <code class="docutils literal"><span class="pre">horton.scripts.cpart</span></code> &#8211; Utility functions for the <code class="docutils literal"><span class="pre">horton-cpart.py</span></code> script</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_scripts_espfit.html">3.13.4. <code class="docutils literal"><span class="pre">horton.scripts.espfit</span></code> &#8211; Code used by ESP fitting scripts</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_scripts_hdf2csv.html">3.13.5. <code class="docutils literal"><span class="pre">horton.scripts.hdf2csv</span></code> &#8211; Code used by <code class="docutils literal"><span class="pre">horton-hdf2csv.py</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_scripts_wpart.html">3.13.6. <code class="docutils literal"><span class="pre">horton.scripts.wpart</span></code> &#8211; Utility functions for the <code class="docutils literal"><span class="pre">horton-wpart.py</span></code> script</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">HORTON</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
          <li><a href="user_estruct.html">4. Electronic Structure Methods</a> &raquo;</li>
      
    <li>4.1. How to use HORTON as a Hartree-Fock/DFT program</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/user_estruct_hf_dft.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="how-to-use-horton-as-a-hartree-fock-dft-program">
<span id="user-hf-dft"></span><h1>4.1. How to use HORTON as a Hartree-Fock/DFT program<a class="headerlink" href="#how-to-use-horton-as-a-hartree-fock-dft-program" title="Permalink to this headline"></a></h1>
<p>This section explains how the relevant Hartree-Fock and DFT features in HORTON
are used with Python scripts. This is different from most regular quantum
chemistry codes, where you just prepare an input file with a molecular geometry
and some control options. Such an input-file interface for HORTON is under
construction. The script interface, explained here, is more expressive and
laborsome than a regular input file, because you basically have to write the
main program. However, it has the advantage of flexibility, since you can tinker
more with the individual steps in the calculation.</p>
<p>HORTON can do restricted and unrestricted HF/DFT SCF calculations in various
different ways. The following sections cover the typical steps of a calculation:</p>
<ol class="arabic simple">
<li><a class="reference internal" href="#user-hf-dft-setup-hamiltonian"><span>Setting up the (molecular electronic) Hamiltonian</span></a></li>
<li><a class="reference internal" href="#user-hf-dft-initial-guess"><span>Generating an initial guess of the wavefunction</span></a></li>
<li><a class="reference internal" href="#user-hf-dft-effective-ham"><span>Defining the effective Hamiltonian</span></a></li>
<li><a class="reference internal" href="#user-hf-dft-occupation"><span>Choose an orbital occupation scheme</span></a></li>
<li><a class="reference internal" href="#user-hf-dft-scf"><span>Optimize the wavefunction with a self-consistent field algorithm</span></a></li>
<li>Optional (if needed for 7 or 8): <a class="reference internal" href="#user-hf-dft-get-orbitals"><span>Conversion of density and Fock matrix to orbitals</span></a></li>
<li>Optional: <a class="reference internal" href="#user-hf-dft-to-file"><span>Writing SCF results to a file</span></a></li>
<li>Optional: <a class="reference internal" href="#user-hf-dft-preparing-posthf"><span>Preparing for a Post-Hartree-Fock calculation</span></a></li>
</ol>
<p>The last section contains an overview of <a class="reference internal" href="#hf-dft-complete-examples"><span>Complete examples</span></a>
that are shipped (and tested) with HORTON. These may be convenient as a starting
point when preparing your own scripts. You may also just dive straight
into these examples and consult the first five sections to better understand how
each example works.</p>
<p>The code snippets below use the following conventions for variable names. The
following are defined by setting up the Hamiltonian:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">olp</span></code>: two-index object with the overlap integrals.</li>
<li><code class="docutils literal"><span class="pre">kin</span></code>: two-index object with the kinetic energy integrals.</li>
<li><code class="docutils literal"><span class="pre">na</span></code>: two-index object with the nuclear attraction integrals.</li>
<li><code class="docutils literal"><span class="pre">er</span></code>: four-index object with the electron repulsion integrals.</li>
</ul>
<p>The following names are also used systematically:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">exp_alpha</span></code>, <code class="docutils literal"><span class="pre">exp_beta</span></code>: the expansion coefficient of the alpha and beta
orbitals in a (local) basis.</li>
</ul>
<div class="section" id="setting-up-the-molecular-electronic-hamiltonian">
<span id="user-hf-dft-setup-hamiltonian"></span><h2>4.1.1. Setting up the (molecular electronic) Hamiltonian<a class="headerlink" href="#setting-up-the-molecular-electronic-hamiltonian" title="Permalink to this headline"></a></h2>
<p>See <a class="reference internal" href="user_hamiltonian.html#user-hamiltonian"><span>Hamiltonians</span></a>.</p>
<p>You first have to compute/load the two- and four-index objects for the one- and
two-body terms in the Hamiltonian. Some DFT implementations in HORTON do not
require pre-computed four-center integrals.</p>
</div>
<div class="section" id="generating-an-initial-guess-of-the-wavefunction">
<span id="user-hf-dft-initial-guess"></span><h2>4.1.2. Generating an initial guess of the wavefunction<a class="headerlink" href="#generating-an-initial-guess-of-the-wavefunction" title="Permalink to this headline"></a></h2>
<div class="section" id="core-hamiltonian-guess">
<span id="user-hf-dft-core-guess"></span><h3>4.1.2.1. Core Hamiltonian guess<a class="headerlink" href="#core-hamiltonian-guess" title="Permalink to this headline"></a></h3>
<p>This guess involves only the one-body terms of the electronic Hamiltonian and
completely neglects electron-electron interactions. The orbitals for such a
one-body Hamiltonian can be computed without any prior guess.</p>
<p>The function <a class="reference internal" href="lib/mod_horton_meanfield_guess.html#horton.meanfield.guess.guess_core_hamiltonian" title="horton.meanfield.guess.guess_core_hamiltonian"><code class="xref py py-func docutils literal"><span class="pre">guess_core_hamiltonian()</span></code></a> can be
used to compute the core hamiltonian guess. This type of guess does only relies on a
simple one-body Hamiltonian, usually consisting of the kinetic energy and the
interaction with the external field. In case of an unrestricted calculation,
this means that the same initial orbital guess is made for the alpha and beta
spins.</p>
<p>The guess for a restricted wavefunction is done as follows:</p>
<div class="literal-block-wrapper container" id="data-examples-hf-dft-rhf-water-dense-py-lines-31-35">
<div class="code-block-caption"><span class="caption-text">data/examples/hf_dft/rhf_water_dense.py, lines 31&#8211;35</span><a class="headerlink" href="#data-examples-hf-dft-rhf-water-dense-py-lines-31-35" title="Permalink to this code"></a></div>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Create alpha orbitals</span>
<span class="n">exp_alpha</span> <span class="o">=</span> <span class="n">lf</span><span class="o">.</span><span class="n">create_expansion</span><span class="p">()</span>

<span class="c"># Initial guess</span>
<span class="n">guess_core_hamiltonian</span><span class="p">(</span><span class="n">olp</span><span class="p">,</span> <span class="n">kin</span><span class="p">,</span> <span class="n">na</span><span class="p">,</span> <span class="n">exp_alpha</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>For an unrestricted wavefunction, the procedure is very similar:</p>
<div class="literal-block-wrapper container" id="data-examples-hf-dft-uhf-methyl-dense-py-lines-27-32">
<div class="code-block-caption"><span class="caption-text">data/examples/hf_dft/uhf_methyl_dense.py, lines 27&#8211;32</span><a class="headerlink" href="#data-examples-hf-dft-uhf-methyl-dense-py-lines-27-32" title="Permalink to this code"></a></div>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Create alpha orbitals</span>
<span class="n">exp_alpha</span> <span class="o">=</span> <span class="n">lf</span><span class="o">.</span><span class="n">create_expansion</span><span class="p">()</span>
<span class="n">exp_beta</span> <span class="o">=</span> <span class="n">lf</span><span class="o">.</span><span class="n">create_expansion</span><span class="p">()</span>

<span class="c"># Initial guess</span>
<span class="n">guess_core_hamiltonian</span><span class="p">(</span><span class="n">olp</span><span class="p">,</span> <span class="n">kin</span><span class="p">,</span> <span class="n">na</span><span class="p">,</span> <span class="n">exp_alpha</span><span class="p">,</span> <span class="n">exp_beta</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The arguments <code class="docutils literal"><span class="pre">exp_alpha</span></code> and <code class="docutils literal"><span class="pre">exp_beta</span></code> are treated as output arguments.
Instead of <code class="docutils literal"><span class="pre">kin</span></code> and <code class="docutils literal"><span class="pre">na</span></code>, you may provide just any set of one-body
operators to construct different types of guesses.</p>
</div>
<div class="section" id="randomizing-an-initial-guess">
<h3>4.1.2.2. Randomizing an initial guess<a class="headerlink" href="#randomizing-an-initial-guess" title="Permalink to this headline"></a></h3>
<p>The method <a class="reference internal" href="lib/mod_horton_matrix_dense.html#horton.matrix.dense.DenseExpansion.rotate_random" title="horton.matrix.dense.DenseExpansion.rotate_random"><code class="xref py py-meth docutils literal"><span class="pre">rotate_random()</span></code></a> can be
used to apply a random unitary rotation to all the orbitals (occupied and virtual).
The orbital energies and occupation numbers are not affected. For example, after
constructing a <a class="reference internal" href="#user-hf-dft-core-guess"><span>Core Hamiltonian guess</span></a>, the following line randomizes the
orbitals:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># randomly rotate the orbitals (irrespective of occupied or virtual)</span>
<span class="n">exp_alpha</span><span class="o">.</span><span class="n">rotate_random</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="modifying-the-initial-guess">
<h3>4.1.2.3. Modifying the initial guess<a class="headerlink" href="#modifying-the-initial-guess" title="Permalink to this headline"></a></h3>
<p>If needed, you may fine-tune the initial guess by making fine-grained
modifications to the orbitals. (These may also be useful for fixing the orbitals
that come out of a failed SCF.)</p>
<ul>
<li><p class="first">The method <a class="reference internal" href="lib/mod_horton_matrix_dense.html#horton.matrix.dense.DenseExpansion.rotate_2orbitals" title="horton.matrix.dense.DenseExpansion.rotate_2orbitals"><code class="xref py py-meth docutils literal"><span class="pre">rotate_2orbitals()</span></code></a>
allows you to mix two orbitals. By default, it rotates the HOMO and LUMO
orbitals by 45 degrees:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Mix HOMO and LUMO orbitals</span>
<span class="n">exp_alpha</span><span class="o">.</span><span class="n">rotate_2orbitals</span><span class="p">()</span>

<span class="c"># Rotate 1st and 6th orbital by 30 deg</span>
<span class="n">exp</span><span class="o">.</span><span class="n">_alpha</span><span class="o">.</span><span class="n">rotate_2orbitals</span><span class="p">(</span><span class="mi">30</span><span class="o">*</span><span class="n">deg</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that HORTON uses radians as unit for angles, i.e. <code class="docutils literal"><span class="pre">30*deg</span> <span class="pre">==</span> <span class="pre">np.pi/6</span></code>.
Also, HORTON uses zero-based indices, so the arguments <code class="docutils literal"><span class="pre">0,</span> <span class="pre">5</span></code>
refer to the first and the sixth orbital.</p>
</li>
<li><p class="first">The method <a class="reference internal" href="lib/mod_horton_matrix_dense.html#horton.matrix.dense.DenseExpansion.swap_orbitals" title="horton.matrix.dense.DenseExpansion.swap_orbitals"><code class="xref py py-meth docutils literal"><span class="pre">swap_orbitals()</span></code></a> allows
you to swap several orbitals. It takes as an argument an array where each row
is a pair of orbitals to swap. For example, the following swaps 1st and 3rd,
followed by a swap of 2nd and 4th:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Swap some orbitals</span>
<span class="n">swaps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>
<span class="n">exp_alpha</span><span class="o">.</span><span class="n">swap_orbitals</span><span class="p">(</span><span class="n">swaps</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="reading-a-guess-from-a-file">
<h3>4.1.2.4. Reading a guess from a file<a class="headerlink" href="#reading-a-guess-from-a-file" title="Permalink to this headline"></a></h3>
<p>You may also load orbitals from an external file. The file formats <code class="docutils literal"><span class="pre">.mkl</span></code>,
<code class="docutils literal"><span class="pre">.molden</span></code>, <code class="docutils literal"><span class="pre">.fchk</span></code>, or HORTON&#8217;s internal <code class="docutils literal"><span class="pre">.h5</span></code> are all viable
sources of orbitals. For example, the orbitals from a Gaussian formatted
checkpoint file, <code class="docutils literal"><span class="pre">*.fchk</span></code>, may be loaded as follows:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Load fchk file</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">IOData</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s">&#39;water.fchk&#39;</span><span class="p">)</span>

<span class="c"># Print the number of alpha orbitals (occupied and virtual)</span>
<span class="k">print</span> <span class="n">mol</span><span class="o">.</span><span class="n">exp_alpha</span><span class="o">.</span><span class="n">nfn</span>
</pre></div>
</div>
<p>Obviously, if you would like to use these orbitals without projecting them onto
a new basis set (as explained in <a class="reference internal" href="#user-hf-dft-project-basis"><span>Projecting orbitals from a smaller basis onto a larger one</span></a>), you are
forced to continue working in the same basis set, which can be accessed
in this example as <code class="docutils literal"><span class="pre">mol.obasis</span></code>. See <a class="reference internal" href="user_hamiltonian_molecular.html#user-molecularham-geom-and-basis"><span>Loading geometry and basis set info from one file</span></a>
for more details.</p>
</div>
<div class="section" id="projecting-orbitals-from-a-smaller-basis-onto-a-larger-one">
<span id="user-hf-dft-project-basis"></span><h3>4.1.2.5. Projecting orbitals from a smaller basis onto a larger one<a class="headerlink" href="#projecting-orbitals-from-a-smaller-basis-onto-a-larger-one" title="Permalink to this headline"></a></h3>
<p>Assuming you have obtained (converged) orbitals in a smaller basis set, you can
try to use these as initial guess after projecting the orbitals onto the
larger basis set. This is exactly what the function
<a class="reference internal" href="lib/mod_horton_meanfield_project.html#horton.meanfield.project.project_orbitals_mgs" title="horton.meanfield.project.project_orbitals_mgs"><code class="xref py py-func docutils literal"><span class="pre">project_orbitals_mgs()</span></code></a> does. The following
snippet assumes that the <code class="docutils literal"><span class="pre">obasis0</span></code> and <code class="docutils literal"><span class="pre">exp_alpha0</span></code> are the small basis set
and a set of orbitals in that basis for the <code class="docutils literal"><span class="pre">IOData</span></code> instance <code class="docutils literal"><span class="pre">mol</span></code>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Definition of the bigger basis set</span>
<span class="n">obasis1</span> <span class="o">=</span> <span class="n">get_gobasis</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">coordinates</span><span class="p">,</span> <span class="n">mol</span><span class="o">.</span><span class="n">numbers</span><span class="p">,</span> <span class="s">&#39;aug-cc-pvtz&#39;</span><span class="p">):</span>

<span class="c"># Linalg factory for the bigger basis set</span>
<span class="n">lf1</span> <span class="o">=</span> <span class="n">DenseLinalgFactory</span><span class="p">(</span><span class="n">obasis1</span><span class="o">.</span><span class="n">nbasis</span><span class="p">)</span>

<span class="c"># Create a expansion object for the alpha orbitals in the large basis</span>
<span class="n">exp_alpha1</span> <span class="o">=</span> <span class="n">lf1</span><span class="o">.</span><span class="n">create_expansion</span><span class="p">()</span>

<span class="c"># The actual projection</span>
<span class="n">project_orbitals_msg</span><span class="p">(</span><span class="n">obasis0</span><span class="p">,</span> <span class="n">obasis1</span><span class="p">,</span> <span class="n">exp_alpha0</span><span class="p">,</span> <span class="n">exp_alpha1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="defining-the-effective-hamiltonian">
<span id="user-hf-dft-effective-ham"></span><h2>4.1.3. Defining the effective Hamiltonian<a class="headerlink" href="#defining-the-effective-hamiltonian" title="Permalink to this headline"></a></h2>
<p>HORTON implements spin-restricted and spin-unrestricted effective Hamiltonians.
Mathematically speaking, these are models for the energy as function of a set of
density matrices. The implementation also provides an API to compute the
corresponding Fock matrix for every density matrix, i.e. the derivative of the
energy toward the density matrix elements.</p>
<ul>
<li><p class="first">For the restricted case, the alpha and beta density matrices are assumed
to be identical. Hence the energy is only a function of the alpha density
matrix. When constructing the Fock matrix, the derivative is divided by two
to obtain such that the Fock matrix has the conventional orbital energies as
eigenvalues.</p>
<div class="math">
\[\begin{split}D^\alpha &amp;\rightarrow E(D^\alpha) \\
         &amp;\rightarrow F^\alpha_{\mu\nu} = \frac{1}{2}\frac{\partial E}{\partial D^\alpha_{\nu\mu}}\end{split}\]</div>
</li>
<li><p class="first">For the unrestricted case, the alpha and beta density matrices are allowed to
be different. Hence, there are also alpha and beta Fock matrices.</p>
<div class="math">
\[\begin{split}D^\alpha, D^\beta &amp;\rightarrow E(D^\alpha, D^\beta) \\
                  &amp;\rightarrow F^\alpha_{\mu\nu} = \frac{\partial E}{\partial D^\alpha_{\nu\mu}} \\
                  &amp;\rightarrow F^\beta_{\mu\nu} = \frac{\partial E}{\partial D^\beta_{\nu\mu}}\end{split}\]</div>
</li>
</ul>
<p>A generic <a class="reference external" href="http://en.wikipedia.org/wiki/Application_programming_interface">API</a> for such
density matrix functionals is implemented in the classes
<a class="reference internal" href="lib/mod_horton_meanfield_hamiltonian.html#horton.meanfield.hamiltonian.REffHam" title="horton.meanfield.hamiltonian.REffHam"><code class="xref py py-class docutils literal"><span class="pre">REffHam</span></code></a> and
<a class="reference internal" href="lib/mod_horton_meanfield_hamiltonian.html#horton.meanfield.hamiltonian.UEffHam" title="horton.meanfield.hamiltonian.UEffHam"><code class="xref py py-class docutils literal"><span class="pre">UEffHam</span></code></a>. The prefixes <code class="docutils literal"><span class="pre">R</span></code> and <code class="docutils literal"><span class="pre">U</span></code>
are used (also below) to differentiate between restricted and unrestricted
implementations. A Hartree-Fock or DFT effective Hamiltonian is defined by
constructing an instance of the <code class="docutils literal"><span class="pre">REffHam</span></code> or <code class="docutils literal"><span class="pre">UEffHam</span></code> classes and providing
the necessary energy terms to the constructor.</p>
<div class="section" id="supported-energy-terms-for-the-effective-hamiltonians">
<h3>4.1.3.1. Supported energy terms for the effective Hamiltonians<a class="headerlink" href="#supported-energy-terms-for-the-effective-hamiltonians" title="Permalink to this headline"></a></h3>
<p>All classes below take a <code class="docutils literal"><span class="pre">label</span></code> argument to give each term in the Hamiltonian
a name, e.g. used for storing/displaying results. For each class listed below,
follow the hyperlinks to the corresponding documentation for a description of
the constructor arguments.</p>
<ul>
<li><p class="first">Simple one-body terms are specified with
<a class="reference internal" href="lib/mod_horton_meanfield_observable.html#horton.meanfield.observable.RTwoIndexTerm" title="horton.meanfield.observable.RTwoIndexTerm"><code class="xref py py-class docutils literal"><span class="pre">RTwoIndexTerm</span></code></a>, or
<a class="reference internal" href="lib/mod_horton_meanfield_observable.html#horton.meanfield.observable.UTwoIndexTerm" title="horton.meanfield.observable.UTwoIndexTerm"><code class="xref py py-class docutils literal"><span class="pre">UTwoIndexTerm</span></code></a>.</p>
</li>
<li><p class="first">The direct term of a two-body interaction is specified with
<a class="reference internal" href="lib/mod_horton_meanfield_observable.html#horton.meanfield.observable.RDirectTerm" title="horton.meanfield.observable.RDirectTerm"><code class="xref py py-class docutils literal"><span class="pre">RDirectTerm</span></code></a>, or
<a class="reference internal" href="lib/mod_horton_meanfield_observable.html#horton.meanfield.observable.UDirectTerm" title="horton.meanfield.observable.UDirectTerm"><code class="xref py py-class docutils literal"><span class="pre">UDirectTerm</span></code></a>.</p>
</li>
<li><p class="first">The exchange term of a two-body interaction is specified with
<a class="reference internal" href="lib/mod_horton_meanfield_observable.html#horton.meanfield.observable.RExchangeTerm" title="horton.meanfield.observable.RExchangeTerm"><code class="xref py py-class docutils literal"><span class="pre">RExchangeTerm</span></code></a>, or
<a class="reference internal" href="lib/mod_horton_meanfield_observable.html#horton.meanfield.observable.UExchangeTerm" title="horton.meanfield.observable.UExchangeTerm"><code class="xref py py-class docutils literal"><span class="pre">UExchangeTerm</span></code></a>.</p>
</li>
<li><p class="first">Functionals of the density (or its derivatives) that require numerical
integration are all grouped into on term using
<a class="reference internal" href="lib/mod_horton_meanfield_gridgroup.html#horton.meanfield.gridgroup.RGridGroup" title="horton.meanfield.gridgroup.RGridGroup"><code class="xref py py-class docutils literal"><span class="pre">RGridGroup</span></code></a>, or
<a class="reference internal" href="lib/mod_horton_meanfield_gridgroup.html#horton.meanfield.gridgroup.UGridGroup" title="horton.meanfield.gridgroup.UGridGroup"><code class="xref py py-class docutils literal"><span class="pre">UGridGroup</span></code></a>. This makes it possible
to compute at every SCF iteration the density (and its gradients) only once
for all terms that depend on the density. This also allows for a similar gain
in efficiency when building the Fock matrices. The constructor of a
<code class="docutils literal"><span class="pre">GridGroup</span></code> class takes a numerical integration grid and a list of instances
of the following classes as arguments:</p>
<blockquote>
<div><ul class="simple">
<li>An LDA functional from LibXC can be specified with
<a class="reference internal" href="lib/mod_horton_meanfield_libxc.html#horton.meanfield.libxc.RLibXCLDA" title="horton.meanfield.libxc.RLibXCLDA"><code class="xref py py-class docutils literal"><span class="pre">RLibXCLDA</span></code></a> or
<a class="reference internal" href="lib/mod_horton_meanfield_libxc.html#horton.meanfield.libxc.ULibXCLDA" title="horton.meanfield.libxc.ULibXCLDA"><code class="xref py py-class docutils literal"><span class="pre">ULibXCLDA</span></code></a>.</li>
<li>A GGA functional from LibXC can be specified with
<a class="reference internal" href="lib/mod_horton_meanfield_libxc.html#horton.meanfield.libxc.RLibXCGGA" title="horton.meanfield.libxc.RLibXCGGA"><code class="xref py py-class docutils literal"><span class="pre">RLibXCGGA</span></code></a> or
<a class="reference internal" href="lib/mod_horton_meanfield_libxc.html#horton.meanfield.libxc.ULibXCGGA" title="horton.meanfield.libxc.ULibXCGGA"><code class="xref py py-class docutils literal"><span class="pre">ULibXCGGA</span></code></a>.</li>
<li>A Hybrid GGA functional from LibXC can be specified with
<a class="reference internal" href="lib/mod_horton_meanfield_libxc.html#horton.meanfield.libxc.RLibXCHybridGGA" title="horton.meanfield.libxc.RLibXCHybridGGA"><code class="xref py py-class docutils literal"><span class="pre">RLibXCHybridGGA</span></code></a> or
<a class="reference internal" href="lib/mod_horton_meanfield_libxc.html#horton.meanfield.libxc.ULibXCHybridGGA" title="horton.meanfield.libxc.ULibXCHybridGGA"><code class="xref py py-class docutils literal"><span class="pre">ULibXCHybridGGA</span></code></a>.</li>
<li>A numerical implementation of the Hartree term (using an improved version
of Becke&#8217;s Poisson solver) can be used instead of the <code class="docutils literal"><span class="pre">RDirectTerm</span></code> or
<code class="docutils literal"><span class="pre">UDirectTerm</span></code> classes, which require four-center integrals. The relevant
classes are
<a class="reference internal" href="lib/mod_horton_meanfield_builtin.html#horton.meanfield.builtin.RBeckeHartree" title="horton.meanfield.builtin.RBeckeHartree"><code class="xref py py-class docutils literal"><span class="pre">RBeckeHartree</span></code></a> or
<a class="reference internal" href="lib/mod_horton_meanfield_builtin.html#horton.meanfield.builtin.UBeckeHartree" title="horton.meanfield.builtin.UBeckeHartree"><code class="xref py py-class docutils literal"><span class="pre">UBeckeHartree</span></code></a>.</li>
</ul>
</div></blockquote>
<p>Integration grids are discussed in more detail in the section
<a class="reference internal" href="user_other_numerical_integration.html#user-other-numerical-integration-specify"><span>Building an integration grid</span></a>. A list of the supported LibXC functionals can
be found in <a class="reference internal" href="tech_ref_functionals.html#ref-functionals"><span>LibXC Functionals</span></a>. Note that HORTON does not support
meta-GGAs (MGGAs) yet.</p>
</li>
</ul>
<p>Using these classes, you can construct the Hartree-Fock or a DFT effective
Hamiltonian.</p>
</div>
<div class="section" id="a-few-typical-examples">
<h3>4.1.3.2. A few typical examples<a class="headerlink" href="#a-few-typical-examples" title="Permalink to this headline"></a></h3>
<p>The examples below assume that some or all of the following variables are
already defined:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">obasis</span></code>: An orbital basis set.</li>
<li><code class="docutils literal"><span class="pre">olp</span></code>: two-index object with the overlap integrals.</li>
<li><code class="docutils literal"><span class="pre">kin</span></code>: two-index object with the kinetic energy integrals.</li>
<li><code class="docutils literal"><span class="pre">na</span></code>: two-index object with the nuclear attraction integrals.</li>
<li><code class="docutils literal"><span class="pre">er</span></code>: four-index object with the electron repulsion integrals.</li>
<li><code class="docutils literal"><span class="pre">grid</span></code>: a numerical integration grid.</li>
</ul>
<p>If you are unfamiliar with any of these, please read the sections
<a class="reference internal" href="user_hamiltonian.html#user-hamiltonian"><span>Hamiltonians</span></a> and <a class="reference internal" href="user_other_numerical_integration.html#user-other-numerical-integration"><span>How to use HORTON for numerical integration?</span></a>. The examples below
also make use of the external argument of
<a class="reference internal" href="lib/mod_horton_meanfield_hamiltonian.html#horton.meanfield.hamiltonian.REffHam" title="horton.meanfield.hamiltonian.REffHam"><code class="xref py py-class docutils literal"><span class="pre">REffHam</span></code></a> or
<a class="reference internal" href="lib/mod_horton_meanfield_hamiltonian.html#horton.meanfield.hamiltonian.UEffHam" title="horton.meanfield.hamiltonian.UEffHam"><code class="xref py py-class docutils literal"><span class="pre">UEffHam</span></code></a> to add the nuclear-nuclear
repulsion energy to the total energy reported by the effective Hamiltonian.</p>
<ul>
<li><p class="first">Restricted Hartree-Fock:</p>
<div class="literal-block-wrapper container" id="data-examples-hf-dft-rhf-water-dense-py-lines-37-45">
<div class="code-block-caption"><span class="caption-text">data/examples/hf_dft/rhf_water_dense.py, lines 37&#8211;45</span><a class="headerlink" href="#data-examples-hf-dft-rhf-water-dense-py-lines-37-45" title="Permalink to this code"></a></div>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Construct the restricted HF effective Hamiltonian</span>
<span class="n">external</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;nn&#39;</span><span class="p">:</span> <span class="n">compute_nucnuc</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">coordinates</span><span class="p">,</span> <span class="n">mol</span><span class="o">.</span><span class="n">pseudo_numbers</span><span class="p">)}</span>
<span class="n">terms</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">RTwoIndexTerm</span><span class="p">(</span><span class="n">kin</span><span class="p">,</span> <span class="s">&#39;kin&#39;</span><span class="p">),</span>
    <span class="n">RDirectTerm</span><span class="p">(</span><span class="n">er</span><span class="p">,</span> <span class="s">&#39;hartree&#39;</span><span class="p">),</span>
    <span class="n">RExchangeTerm</span><span class="p">(</span><span class="n">er</span><span class="p">,</span> <span class="s">&#39;x_hf&#39;</span><span class="p">),</span>
    <span class="n">RTwoIndexTerm</span><span class="p">(</span><span class="n">na</span><span class="p">,</span> <span class="s">&#39;ne&#39;</span><span class="p">),</span>
<span class="p">]</span>
<span class="n">ham</span> <span class="o">=</span> <span class="n">REffHam</span><span class="p">(</span><span class="n">terms</span><span class="p">,</span> <span class="n">external</span><span class="p">)</span>
</pre></div>
</div>
</div>
</li>
<li><p class="first">Unrestricted Hartree-Fock:</p>
<div class="literal-block-wrapper container" id="data-examples-hf-dft-uhf-methyl-dense-py-lines-35-42">
<div class="code-block-caption"><span class="caption-text">data/examples/hf_dft/uhf_methyl_dense.py, lines 35&#8211;42</span><a class="headerlink" href="#data-examples-hf-dft-uhf-methyl-dense-py-lines-35-42" title="Permalink to this code"></a></div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">external</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;nn&#39;</span><span class="p">:</span> <span class="n">compute_nucnuc</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">coordinates</span><span class="p">,</span> <span class="n">mol</span><span class="o">.</span><span class="n">pseudo_numbers</span><span class="p">)}</span>
<span class="n">terms</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">UTwoIndexTerm</span><span class="p">(</span><span class="n">kin</span><span class="p">,</span> <span class="s">&#39;kin&#39;</span><span class="p">),</span>
    <span class="n">UDirectTerm</span><span class="p">(</span><span class="n">er</span><span class="p">,</span> <span class="s">&#39;hartree&#39;</span><span class="p">),</span>
    <span class="n">UExchangeTerm</span><span class="p">(</span><span class="n">er</span><span class="p">,</span> <span class="s">&#39;x_hf&#39;</span><span class="p">),</span>
    <span class="n">UTwoIndexTerm</span><span class="p">(</span><span class="n">na</span><span class="p">,</span> <span class="s">&#39;ne&#39;</span><span class="p">),</span>
<span class="p">]</span>
<span class="n">ham</span> <span class="o">=</span> <span class="n">UEffHam</span><span class="p">(</span><span class="n">terms</span><span class="p">,</span> <span class="n">external</span><span class="p">)</span>
</pre></div>
</div>
</div>
</li>
<li><p class="first">Restricted Kohn-Sham DFT with the Dirac exchange and the VWN correlation
functionals:</p>
<div class="literal-block-wrapper container" id="data-examples-hf-dft-rks-water-lda-py-lines-37-47">
<div class="code-block-caption"><span class="caption-text">data/examples/hf_dft/rks_water_lda.py, lines 37&#8211;47</span><a class="headerlink" href="#data-examples-hf-dft-rks-water-lda-py-lines-37-47" title="Permalink to this code"></a></div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">external</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;nn&#39;</span><span class="p">:</span> <span class="n">compute_nucnuc</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">coordinates</span><span class="p">,</span> <span class="n">mol</span><span class="o">.</span><span class="n">pseudo_numbers</span><span class="p">)}</span>
<span class="n">terms</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">RTwoIndexTerm</span><span class="p">(</span><span class="n">kin</span><span class="p">,</span> <span class="s">&#39;kin&#39;</span><span class="p">),</span>
    <span class="n">RDirectTerm</span><span class="p">(</span><span class="n">er</span><span class="p">,</span> <span class="s">&#39;hartree&#39;</span><span class="p">),</span>
    <span class="n">RGridGroup</span><span class="p">(</span><span class="n">obasis</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="p">[</span>
        <span class="n">RLibXCLDA</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">),</span>
        <span class="n">RLibXCLDA</span><span class="p">(</span><span class="s">&#39;c_vwn&#39;</span><span class="p">),</span>
    <span class="p">]),</span>
    <span class="n">RTwoIndexTerm</span><span class="p">(</span><span class="n">na</span><span class="p">,</span> <span class="s">&#39;ne&#39;</span><span class="p">),</span>
<span class="p">]</span>
<span class="n">ham</span> <span class="o">=</span> <span class="n">REffHam</span><span class="p">(</span><span class="n">terms</span><span class="p">,</span> <span class="n">external</span><span class="p">)</span>
</pre></div>
</div>
</div>
</li>
<li><p class="first">Unrestricted Kohn-Sham DFT with the PBE GGA exchange and correlation
functionals:</p>
<div class="literal-block-wrapper container" id="data-examples-hf-dft-uks-methyl-gga-py-lines-38-48">
<div class="code-block-caption"><span class="caption-text">data/examples/hf_dft/uks_methyl_gga.py, lines 38&#8211;48</span><a class="headerlink" href="#data-examples-hf-dft-uks-methyl-gga-py-lines-38-48" title="Permalink to this code"></a></div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">external</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;nn&#39;</span><span class="p">:</span> <span class="n">compute_nucnuc</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">coordinates</span><span class="p">,</span> <span class="n">mol</span><span class="o">.</span><span class="n">pseudo_numbers</span><span class="p">)}</span>
<span class="n">terms</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">UTwoIndexTerm</span><span class="p">(</span><span class="n">kin</span><span class="p">,</span> <span class="s">&#39;kin&#39;</span><span class="p">),</span>
    <span class="n">UDirectTerm</span><span class="p">(</span><span class="n">er</span><span class="p">,</span> <span class="s">&#39;hartree&#39;</span><span class="p">),</span>
    <span class="n">UGridGroup</span><span class="p">(</span><span class="n">obasis</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="p">[</span>
        <span class="n">ULibXCGGA</span><span class="p">(</span><span class="s">&#39;x_pbe&#39;</span><span class="p">),</span>
        <span class="n">ULibXCGGA</span><span class="p">(</span><span class="s">&#39;c_pbe&#39;</span><span class="p">),</span>
    <span class="p">]),</span>
    <span class="n">UTwoIndexTerm</span><span class="p">(</span><span class="n">na</span><span class="p">,</span> <span class="s">&#39;ne&#39;</span><span class="p">),</span>
<span class="p">]</span>
<span class="n">ham</span> <span class="o">=</span> <span class="n">UEffHam</span><span class="p">(</span><span class="n">terms</span><span class="p">,</span> <span class="n">external</span><span class="p">)</span>
</pre></div>
</div>
</div>
</li>
<li><p class="first">Restricted Kohn-Sham DFT with the Hybrid GGA functional B3LYP:</p>
<div class="literal-block-wrapper container" id="data-examples-hf-dft-rks-water-hybgga-py-lines-37-46">
<div class="code-block-caption"><span class="caption-text">data/examples/hf_dft/rks_water_hybgga.py, lines 37&#8211;46</span><a class="headerlink" href="#data-examples-hf-dft-rks-water-hybgga-py-lines-37-46" title="Permalink to this code"></a></div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">external</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;nn&#39;</span><span class="p">:</span> <span class="n">compute_nucnuc</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">coordinates</span><span class="p">,</span> <span class="n">mol</span><span class="o">.</span><span class="n">pseudo_numbers</span><span class="p">)}</span>
<span class="n">libxc_term</span> <span class="o">=</span> <span class="n">RLibXCHybridGGA</span><span class="p">(</span><span class="s">&#39;xc_b3lyp&#39;</span><span class="p">)</span>
<span class="n">terms</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">RTwoIndexTerm</span><span class="p">(</span><span class="n">kin</span><span class="p">,</span> <span class="s">&#39;kin&#39;</span><span class="p">),</span>
    <span class="n">RDirectTerm</span><span class="p">(</span><span class="n">er</span><span class="p">,</span> <span class="s">&#39;hartree&#39;</span><span class="p">),</span>
    <span class="n">RGridGroup</span><span class="p">(</span><span class="n">obasis</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="p">[</span><span class="n">libxc_term</span><span class="p">]),</span>
    <span class="n">RExchangeTerm</span><span class="p">(</span><span class="n">er</span><span class="p">,</span> <span class="s">&#39;x_hf&#39;</span><span class="p">,</span> <span class="n">libxc_term</span><span class="o">.</span><span class="n">get_exx_fraction</span><span class="p">()),</span>
    <span class="n">RTwoIndexTerm</span><span class="p">(</span><span class="n">na</span><span class="p">,</span> <span class="s">&#39;ne&#39;</span><span class="p">),</span>
<span class="p">]</span>
<span class="n">ham</span> <span class="o">=</span> <span class="n">REffHam</span><span class="p">(</span><span class="n">terms</span><span class="p">,</span> <span class="n">external</span><span class="p">)</span>
</pre></div>
</div>
</div>
</li>
<li><p class="first">Unrestricted Kohn-Sham DFT with LDA exchange and correlation
functionals and with a numerical integration of the Hartree term:</p>
<div class="literal-block-wrapper container" id="data-examples-hf-dft-uks-methyl-numlda-py-lines-38-48">
<div class="code-block-caption"><span class="caption-text">data/examples/hf_dft/uks_methyl_numlda.py, lines 38&#8211;48</span><a class="headerlink" href="#data-examples-hf-dft-uks-methyl-numlda-py-lines-38-48" title="Permalink to this code"></a></div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">external</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;nn&#39;</span><span class="p">:</span> <span class="n">compute_nucnuc</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">coordinates</span><span class="p">,</span> <span class="n">mol</span><span class="o">.</span><span class="n">pseudo_numbers</span><span class="p">)}</span>
<span class="n">terms</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">UTwoIndexTerm</span><span class="p">(</span><span class="n">kin</span><span class="p">,</span> <span class="s">&#39;kin&#39;</span><span class="p">),</span>
    <span class="n">UGridGroup</span><span class="p">(</span><span class="n">obasis</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="p">[</span>
        <span class="n">UBeckeHartree</span><span class="p">(</span><span class="n">lmax</span><span class="o">=</span><span class="mi">8</span><span class="p">),</span>
        <span class="n">ULibXCLDA</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">),</span>
        <span class="n">ULibXCLDA</span><span class="p">(</span><span class="s">&#39;c_vwn&#39;</span><span class="p">),</span>
    <span class="p">]),</span>
    <span class="n">UTwoIndexTerm</span><span class="p">(</span><span class="n">na</span><span class="p">,</span> <span class="s">&#39;ne&#39;</span><span class="p">),</span>
<span class="p">]</span>
<span class="n">ham</span> <span class="o">=</span> <span class="n">UEffHam</span><span class="p">(</span><span class="n">terms</span><span class="p">,</span> <span class="n">external</span><span class="p">)</span>
</pre></div>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="section" id="choose-an-orbital-occupation-scheme">
<span id="user-hf-dft-occupation"></span><h2>4.1.4. Choose an orbital occupation scheme<a class="headerlink" href="#choose-an-orbital-occupation-scheme" title="Permalink to this headline"></a></h2>
<p>Before calling an SCF solver, you have to select a scheme to set the orbital
occupations after each SCF iteration, even when the occuption numbers are to
remain fixed throughout the calculation. You can use any of the following
three options:</p>
<ul>
<li><p class="first"><a class="reference internal" href="lib/mod_horton_meanfield_occ.html#horton.meanfield.occ.FixedOccModel" title="horton.meanfield.occ.FixedOccModel"><code class="xref py py-class docutils literal"><span class="pre">FixedOccModel</span></code></a>. Keep all occupation numbers
fixed at preset values. For example,</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Restricted case</span>
<span class="n">occ_model</span> <span class="o">=</span> <span class="n">FixedOccModel</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]))</span>
<span class="c"># Unrestricted case</span>
<span class="n">occ_model</span> <span class="o">=</span> <span class="n">FixedOccModel</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">]))</span>
</pre></div>
</div>
</li>
<li><p class="first"><a class="reference internal" href="lib/mod_horton_meanfield_occ.html#horton.meanfield.occ.AufbauOccModel" title="horton.meanfield.occ.AufbauOccModel"><code class="xref py py-class docutils literal"><span class="pre">AufbauOccModel</span></code></a>. Fill all orbitals according
to the <a class="reference external" href="http://en.wikipedia.org/wiki/Aufbau_principle">Aufbau principle</a>.
For example,</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Restricted case (three alpha and three beta electrons)</span>
<span class="n">occ_model</span> <span class="o">=</span> <span class="n">AufbauOccModel</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>
<span class="c"># Unrestricted case (two alpha and three beta electrons)</span>
<span class="n">occ_model</span> <span class="o">=</span> <span class="n">AufbauOccModel</span><span class="p">(</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p class="first"><a class="reference internal" href="lib/mod_horton_meanfield_occ.html#horton.meanfield.occ.FermiOccModel" title="horton.meanfield.occ.FermiOccModel"><code class="xref py py-class docutils literal"><span class="pre">FermiOccModel</span></code></a>. Use the Fermi-smearing method
to fill up the orbitals. <a class="reference internal" href="tech_ref_literature.html#rabuck1999" id="id1">[rabuck1999]</a> Only part of the methodology presented
Rabuck is implemented. See <a class="reference internal" href="lib/mod_horton_meanfield_occ.html#horton.meanfield.occ.FermiOccModel" title="horton.meanfield.occ.FermiOccModel"><code class="xref py py-class docutils literal"><span class="pre">FermiOccModel</span></code></a> for
details. For example,</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Restricted case (three alpha and three beta electrons, 300K)</span>
<span class="n">occ_model</span> <span class="o">=</span> <span class="n">FermiOccModel</span><span class="p">(</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="c"># Unrestricted case (two alpha and three beta electrons, 500K)</span>
<span class="n">occ_model</span> <span class="o">=</span> <span class="n">AufbauOccModel</span><span class="p">(</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="optimize-the-wavefunction-with-a-self-consistent-field-algorithm">
<span id="user-hf-dft-scf"></span><h2>4.1.5. Optimize the wavefunction with a self-consistent field algorithm<a class="headerlink" href="#optimize-the-wavefunction-with-a-self-consistent-field-algorithm" title="Permalink to this headline"></a></h2>
<p>HORTON supports the following SCF algorithms:</p>
<ul class="simple">
<li><a class="reference internal" href="lib/mod_horton_meanfield_scf.html#horton.meanfield.scf.PlainSCFSolver" title="horton.meanfield.scf.PlainSCFSolver"><code class="xref py py-class docutils literal"><span class="pre">PlainSCFSolver</span></code></a>: the ordinary SCF solver.
This method just builds and diagonalizes the Fock matrices at every iteration.</li>
<li><a class="reference internal" href="lib/mod_horton_meanfield_scf_oda.html#horton.meanfield.scf_oda.ODASCFSolver" title="horton.meanfield.scf_oda.ODASCFSolver"><code class="xref py py-class docutils literal"><span class="pre">ODASCFSolver</span></code></a>: the optimal damping SCF
solver. <a class="reference internal" href="tech_ref_literature.html#cances2001" id="id2">[cances2001]</a> It uses a cubic interpolation to estimate the optimal
mixing between the old and the new density matrices. This is relatively robust
but slow.</li>
<li><a class="reference internal" href="lib/mod_horton_meanfield_scf_cdiis.html#horton.meanfield.scf_cdiis.CDIISSCFSolver" title="horton.meanfield.scf_cdiis.CDIISSCFSolver"><code class="xref py py-class docutils literal"><span class="pre">CDIISSCFSolver</span></code></a>: the (traditional)
commutator direct inversion of the iterative subspace (CDIIS) algorithm, also
know as Pulay mixing. <a class="reference internal" href="tech_ref_literature.html#pulay1980" id="id3">[pulay1980]</a> This is usually very efficient but
sensitive to the initial guess.</li>
<li><a class="reference internal" href="lib/mod_horton_meanfield_scf_ediis.html#horton.meanfield.scf_ediis.EDIISSCFSolver" title="horton.meanfield.scf_ediis.EDIISSCFSolver"><code class="xref py py-class docutils literal"><span class="pre">EDIISSCFSolver</span></code></a>: the energy direct
inversion of the iterative subspace (EDIIS) method. <a class="reference internal" href="tech_ref_literature.html#kudin2002" id="id4">[kudin2002]</a> This method
works well for the initial iterations but becomes numerically unstable close
to the solution. It typically works better with a relativey poor initial
guess.</li>
<li><a class="reference internal" href="lib/mod_horton_meanfield_scf_ediis2.html#horton.meanfield.scf_ediis2.EDIIS2SCFSolver" title="horton.meanfield.scf_ediis2.EDIIS2SCFSolver"><code class="xref py py-class docutils literal"><span class="pre">EDIIS2SCFSolver</span></code></a>: a combination of
CDIIS and EDIIS. <a class="reference internal" href="tech_ref_literature.html#kudin2002" id="id5">[kudin2002]</a> This method tries to combine the benefits of
both approaches.</li>
</ul>
<p>The plain SCF solver starts from an initial guess of the orbitals and updates
these in-place.</p>
<ul>
<li><p class="first">Usage in the restricted case:</p>
<div class="literal-block-wrapper container" id="data-examples-hf-dft-rhf-water-dense-py-lines-50-52">
<div class="code-block-caption"><span class="caption-text">data/examples/hf_dft/rhf_water_dense.py, lines 50&#8211;52</span><a class="headerlink" href="#data-examples-hf-dft-rhf-water-dense-py-lines-50-52" title="Permalink to this code"></a></div>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Converge WFN with plain SCF</span>
<span class="n">scf_solver</span> <span class="o">=</span> <span class="n">PlainSCFSolver</span><span class="p">(</span><span class="mf">1e-6</span><span class="p">)</span>
<span class="n">scf_solver</span><span class="p">(</span><span class="n">ham</span><span class="p">,</span> <span class="n">lf</span><span class="p">,</span> <span class="n">olp</span><span class="p">,</span> <span class="n">occ_model</span><span class="p">,</span> <span class="n">exp_alpha</span><span class="p">)</span>
</pre></div>
</div>
</div>
</li>
<li><p class="first">Usage in the unrestricted case:</p>
<div class="literal-block-wrapper container" id="data-examples-hf-dft-uhf-methyl-dense-py-lines-47-49">
<div class="code-block-caption"><span class="caption-text">data/examples/hf_dft/uhf_methyl_dense.py, lines 47&#8211;49</span><a class="headerlink" href="#data-examples-hf-dft-uhf-methyl-dense-py-lines-47-49" title="Permalink to this code"></a></div>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Converge WFN with plain SCF</span>
<span class="n">scf_solver</span> <span class="o">=</span> <span class="n">PlainSCFSolver</span><span class="p">(</span><span class="mf">1e-6</span><span class="p">)</span>
<span class="n">scf_solver</span><span class="p">(</span><span class="n">ham</span><span class="p">,</span> <span class="n">lf</span><span class="p">,</span> <span class="n">olp</span><span class="p">,</span> <span class="n">occ_model</span><span class="p">,</span> <span class="n">exp_alpha</span><span class="p">,</span> <span class="n">exp_beta</span><span class="p">)</span>
</pre></div>
</div>
</div>
</li>
</ul>
<p>All other solvers start from an initial guess of the density matrix and update
that quantity in-place. The usage pattern is as follow:</p>
<ul>
<li><p class="first">Usage in the restricted case:</p>
<div class="literal-block-wrapper container" id="data-examples-hf-dft-rks-water-lda-py-lines-52-58">
<div class="code-block-caption"><span class="caption-text">data/examples/hf_dft/rks_water_lda.py, lines 52&#8211;58</span><a class="headerlink" href="#data-examples-hf-dft-rks-water-lda-py-lines-52-58" title="Permalink to this code"></a></div>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Converge WFN with Optimal damping algorithm (ODA) SCF</span>
<span class="c"># - Construct the initial density matrix (needed for ODA).</span>
<span class="n">occ_model</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">exp_alpha</span><span class="p">)</span>
<span class="n">dm_alpha</span> <span class="o">=</span> <span class="n">exp_alpha</span><span class="o">.</span><span class="n">to_dm</span><span class="p">()</span>
<span class="c"># - SCF solver</span>
<span class="n">scf_solver</span> <span class="o">=</span> <span class="n">ODASCFSolver</span><span class="p">(</span><span class="mf">1e-6</span><span class="p">)</span>
<span class="n">scf_solver</span><span class="p">(</span><span class="n">ham</span><span class="p">,</span> <span class="n">lf</span><span class="p">,</span> <span class="n">olp</span><span class="p">,</span> <span class="n">occ_model</span><span class="p">,</span> <span class="n">dm_alpha</span><span class="p">)</span>
</pre></div>
</div>
</div>
</li>
<li><p class="first">Usage in the unrestricted case:</p>
<div class="literal-block-wrapper container" id="data-examples-hf-dft-uks-methyl-lda-py-lines-53-60">
<div class="code-block-caption"><span class="caption-text">data/examples/hf_dft/uks_methyl_lda.py, lines 53&#8211;60</span><a class="headerlink" href="#data-examples-hf-dft-uks-methyl-lda-py-lines-53-60" title="Permalink to this code"></a></div>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Converge WFN with Optimal damping algorithm (ODA) SCF</span>
<span class="c"># - Construct the initial density matrix (needed for ODA).</span>
<span class="n">occ_model</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">exp_alpha</span><span class="p">,</span> <span class="n">exp_beta</span><span class="p">)</span>
<span class="n">dm_alpha</span> <span class="o">=</span> <span class="n">exp_alpha</span><span class="o">.</span><span class="n">to_dm</span><span class="p">()</span>
<span class="n">dm_beta</span> <span class="o">=</span> <span class="n">exp_beta</span><span class="o">.</span><span class="n">to_dm</span><span class="p">()</span>
<span class="c"># - SCF solver</span>
<span class="n">scf_solver</span> <span class="o">=</span> <span class="n">ODASCFSolver</span><span class="p">(</span><span class="mf">1e-6</span><span class="p">)</span>
<span class="n">scf_solver</span><span class="p">(</span><span class="n">ham</span><span class="p">,</span> <span class="n">lf</span><span class="p">,</span> <span class="n">olp</span><span class="p">,</span> <span class="n">occ_model</span><span class="p">,</span> <span class="n">dm_alpha</span><span class="p">,</span> <span class="n">dm_beta</span><span class="p">)</span>
</pre></div>
</div>
</div>
</li>
</ul>
<p>All SCF solvers support the following two options:</p>
<blockquote>
<div><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">threshold:</th><td class="field-body">The convergence threshold for the SCF solver. The exact meaning
of this threshold is algorithm-dependent. In case of the
<code class="docutils literal"><span class="pre">PlainSCFSolver</span></code>, convergence is tested with the RSMD error on
the Roothaan equations. In all other cases, the square root of
the commutator of the density and the Fock matrix is tested.</td>
</tr>
<tr class="field-even field"><th class="field-name">maxiter:</th><td class="field-body">The maximum allowed number of SCF iterations. If convergence is not
reached within this number of iterations, a <code class="docutils literal"><span class="pre">NoSCFConvergence</span></code>
error is raised.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Click on the links of the SCF solver classes above for more optional arguments
and their default values.</p>
</div>
<div class="section" id="conversion-of-density-and-fock-matrix-to-orbitals">
<span id="user-hf-dft-get-orbitals"></span><h2>4.1.6. Conversion of density and Fock matrix to orbitals<a class="headerlink" href="#conversion-of-density-and-fock-matrix-to-orbitals" title="Permalink to this headline"></a></h2>
<p>The <a class="reference internal" href="lib/mod_horton_meanfield_scf.html#horton.meanfield.scf.PlainSCFSolver" title="horton.meanfield.scf.PlainSCFSolver"><code class="xref py py-class docutils literal"><span class="pre">PlainSCFSolver</span></code></a> iteratively updates the
orbitals. Hence, for this SCF solver, there is no need to reconstruct the orbitals
after SCF convergence. For all other SCF algorithms, however, you need to iteratively
update the density matrix and explicitly reconstruct the orbitals after SCF
convergence.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">SCF algorithms that update the density matrix may produce a converged
density matrix with fractional occupations for degenerate orbitals at the
Fermi level. The code snippets below properly handle such cases as well. For
more details, refer to
<a class="reference internal" href="lib/mod_horton_matrix_dense.html#horton.matrix.dense.DenseExpansion.from_fock_and_dm" title="horton.matrix.dense.DenseExpansion.from_fock_and_dm"><code class="xref py py-meth docutils literal"><span class="pre">from_fock_and_dm()</span></code></a>.</p>
</div>
<ul>
<li><p class="first">Usage in the restricted case:</p>
<div class="literal-block-wrapper container" id="data-examples-hf-dft-rks-water-lda-py-lines-60-67">
<div class="code-block-caption"><span class="caption-text">data/examples/hf_dft/rks_water_lda.py, lines 60&#8211;67</span><a class="headerlink" href="#data-examples-hf-dft-rks-water-lda-py-lines-60-67" title="Permalink to this code"></a></div>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Derive orbitals (coeffs, energies and occupations) from the Fock and density</span>
<span class="c"># matrices. The energy is also computed to store it in the output file below.</span>
<span class="n">fock_alpha</span> <span class="o">=</span> <span class="n">lf</span><span class="o">.</span><span class="n">create_two_index</span><span class="p">()</span>
<span class="n">ham</span><span class="o">.</span><span class="n">reset</span><span class="p">(</span><span class="n">dm_alpha</span><span class="p">)</span>
<span class="n">ham</span><span class="o">.</span><span class="n">compute_energy</span><span class="p">()</span>
<span class="n">ham</span><span class="o">.</span><span class="n">compute_fock</span><span class="p">(</span><span class="n">fock_alpha</span><span class="p">)</span>
<span class="n">exp_alpha</span><span class="o">.</span><span class="n">from_fock_and_dm</span><span class="p">(</span><span class="n">fock_alpha</span><span class="p">,</span> <span class="n">dm_alpha</span><span class="p">,</span> <span class="n">olp</span><span class="p">)</span>
</pre></div>
</div>
</div>
</li>
<li><p class="first">Usage in the unrestricted case:</p>
<div class="literal-block-wrapper container" id="data-examples-hf-dft-uks-methyl-lda-py-lines-62-71">
<div class="code-block-caption"><span class="caption-text">data/examples/hf_dft/uks_methyl_lda.py, lines 62&#8211;71</span><a class="headerlink" href="#data-examples-hf-dft-uks-methyl-lda-py-lines-62-71" title="Permalink to this code"></a></div>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Derive orbitals (coeffs, energies and occupations) from the Fock and density</span>
<span class="c"># matrices. The energy is also computed to store it in the output file below.</span>
<span class="n">fock_alpha</span> <span class="o">=</span> <span class="n">lf</span><span class="o">.</span><span class="n">create_two_index</span><span class="p">()</span>
<span class="n">fock_beta</span> <span class="o">=</span> <span class="n">lf</span><span class="o">.</span><span class="n">create_two_index</span><span class="p">()</span>
<span class="n">ham</span><span class="o">.</span><span class="n">reset</span><span class="p">(</span><span class="n">dm_alpha</span><span class="p">,</span> <span class="n">dm_beta</span><span class="p">)</span>
<span class="n">ham</span><span class="o">.</span><span class="n">compute_energy</span><span class="p">()</span>
<span class="n">ham</span><span class="o">.</span><span class="n">compute_fock</span><span class="p">(</span><span class="n">fock_alpha</span><span class="p">,</span> <span class="n">fock_beta</span><span class="p">)</span>
<span class="n">exp_alpha</span><span class="o">.</span><span class="n">from_fock_and_dm</span><span class="p">(</span><span class="n">fock_alpha</span><span class="p">,</span> <span class="n">dm_alpha</span><span class="p">,</span> <span class="n">olp</span><span class="p">)</span>
<span class="n">exp_beta</span><span class="o">.</span><span class="n">from_fock_and_dm</span><span class="p">(</span><span class="n">fock_beta</span><span class="p">,</span> <span class="n">dm_beta</span><span class="p">,</span> <span class="n">olp</span><span class="p">)</span>
</pre></div>
</div>
</div>
</li>
</ul>
</div>
<div class="section" id="writing-scf-results-to-a-file">
<span id="user-hf-dft-to-file"></span><h2>4.1.7. Writing SCF results to a file<a class="headerlink" href="#writing-scf-results-to-a-file" title="Permalink to this headline"></a></h2>
<p>Once you have obtained a converged set of molecular orbitals, they can be stored
in a file. Two file formats can be used: (i) HORTON&#8217;s internal format based on
HDF5 and (ii) the Molden format. The internal format has the advantage that all
data is stored in full precision and that you can include as much additional
information as you like. The Molden format is useful for visualization purposes
or when you would like to use the orbitals in another quantum chemistry code.
Both formats can be used to store the wavefunction and to use it as an initial
guess afterwards. For more background information on data formats in HORTON,
refer to <a class="reference internal" href="tech_ref_file_formats.html#ref-file-formats"><span>Data file formats (input and output)</span></a>.</p>
<p>The two code snippets below show how a wavefunction can be written to a file.
In both examples, the object <code class="docutils literal"><span class="pre">mol</span></code> is an instance of <code class="docutils literal"><span class="pre">IOData</span></code> that was
created earlier in the script by loading an <code class="docutils literal"><span class="pre">.xyz</span></code> file as follows:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">mol</span> <span class="o">=</span> <span class="n">IOData</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s">&#39;some_molecule.xyz&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>When the <code class="docutils literal"><span class="pre">.xyz</span></code> file is loaded, the attributes <code class="docutils literal"><span class="pre">numbers</span></code> and <code class="docutils literal"><span class="pre">coordinates</span></code>
of the object <code class="docutils literal"><span class="pre">mol</span></code> are already set as required for the <code class="docutils literal"><span class="pre">.molden</span></code> format.</p>
<ul>
<li><p class="first">Usage in the restricted case:</p>
<div class="literal-block-wrapper container" id="data-examples-hf-dft-rks-water-lda-py-lines-68-80">
<div class="code-block-caption"><span class="caption-text">data/examples/hf_dft/rks_water_lda.py, lines 68&#8211;80</span><a class="headerlink" href="#data-examples-hf-dft-rks-water-lda-py-lines-68-80" title="Permalink to this code"></a></div>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Assign results to the molecule object and write it to a file, e.g. for</span>
<span class="c"># later analysis. Note that the ODA algorithm can only really construct an</span>
<span class="c"># optimized density matrix and no orbitals.</span>
<span class="n">mol</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s">&#39;RKS computation on water&#39;</span>
<span class="n">mol</span><span class="o">.</span><span class="n">energy</span> <span class="o">=</span> <span class="n">ham</span><span class="o">.</span><span class="n">cache</span><span class="p">[</span><span class="s">&#39;energy&#39;</span><span class="p">]</span>
<span class="n">mol</span><span class="o">.</span><span class="n">obasis</span> <span class="o">=</span> <span class="n">obasis</span>
<span class="n">mol</span><span class="o">.</span><span class="n">exp_alpha</span> <span class="o">=</span> <span class="n">exp_alpha</span>
<span class="n">mol</span><span class="o">.</span><span class="n">dm_alpha</span> <span class="o">=</span> <span class="n">dm_alpha</span>

<span class="c"># useful for visualization:</span>
<span class="n">mol</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="s">&#39;water.molden&#39;</span><span class="p">)</span>
<span class="c"># useful for post-processing (results stored in double precision):</span>
<span class="n">mol</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="s">&#39;water.h5&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</li>
<li><p class="first">Usage in the unrestricted case:</p>
<div class="literal-block-wrapper container" id="data-examples-hf-dft-uks-methyl-lda-py-lines-72-86">
<div class="code-block-caption"><span class="caption-text">data/examples/hf_dft/uks_methyl_lda.py, lines 72&#8211;86</span><a class="headerlink" href="#data-examples-hf-dft-uks-methyl-lda-py-lines-72-86" title="Permalink to this code"></a></div>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Assign results to the molecule object and write it to a file, e.g. for</span>
<span class="c"># later analysis. Note that the ODA algorithm can only really construct an</span>
<span class="c"># optimized density matrix and no orbitals.</span>
<span class="n">mol</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s">&#39;UKS computation on methyl&#39;</span>
<span class="n">mol</span><span class="o">.</span><span class="n">energy</span> <span class="o">=</span> <span class="n">ham</span><span class="o">.</span><span class="n">cache</span><span class="p">[</span><span class="s">&#39;energy&#39;</span><span class="p">]</span>
<span class="n">mol</span><span class="o">.</span><span class="n">obasis</span> <span class="o">=</span> <span class="n">obasis</span>
<span class="n">mol</span><span class="o">.</span><span class="n">exp_alpha</span> <span class="o">=</span> <span class="n">exp_alpha</span>
<span class="n">mol</span><span class="o">.</span><span class="n">exp_beta</span> <span class="o">=</span> <span class="n">exp_beta</span>
<span class="n">mol</span><span class="o">.</span><span class="n">dm_alpha</span> <span class="o">=</span> <span class="n">dm_alpha</span>
<span class="n">mol</span><span class="o">.</span><span class="n">dm_beta</span> <span class="o">=</span> <span class="n">dm_beta</span>

<span class="c"># useful for visualization:</span>
<span class="n">mol</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="s">&#39;methyl.molden&#39;</span><span class="p">)</span>
<span class="c"># useful for post-processing (results stored in double precision):</span>
<span class="n">mol</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="s">&#39;methyl.h5&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</li>
</ul>
</div>
<div class="section" id="preparing-for-a-post-hartree-fock-calculation">
<span id="user-hf-dft-preparing-posthf"></span><h2>4.1.8. Preparing for a Post-Hartree-Fock calculation<a class="headerlink" href="#preparing-for-a-post-hartree-fock-calculation" title="Permalink to this headline"></a></h2>
<p>Once the SCF has converged and you have obtained a set of orbitals, you can use
these orbitals to convert the integrals from the atomic-orbital (AO) basis to
the molecular-orbital (MO) basis. Two implementations are available in HORTON:
(i) using all molecular orbitals or (ii) by specifing a frozen core and active
set of orbitals. A full example, <code class="docutils literal"><span class="pre">rhf_n2_dense.py</span></code>, which covers both options
and which includes dumping the transformed integrals to a file, is given in the
section <a class="reference internal" href="#hf-dft-complete-examples"><span>Complete examples</span></a> below.</p>
<p>The conversion to an MO basis is useful for post-HF calculations. For such
purposes, it is also of interest to sum all one-body operators into a single
term:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">lf</span> <span class="o">=</span> <span class="n">DenseLinalgFactory</span><span class="p">(</span><span class="n">obasis</span><span class="o">.</span><span class="n">nbasis</span><span class="p">)</span>
<span class="n">kin</span> <span class="o">=</span> <span class="n">obasis</span><span class="o">.</span><span class="n">compute_kinetic</span><span class="p">(</span><span class="n">lf</span><span class="p">)</span>
<span class="n">na</span> <span class="o">=</span> <span class="n">obasis</span><span class="o">.</span><span class="n">compute_nuclear_attraction</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">coordinates</span><span class="p">,</span> <span class="n">mol</span><span class="o">.</span><span class="n">pseudo_numbers</span><span class="p">,</span> <span class="n">lf</span><span class="p">)</span>
<span class="n">one</span> <span class="o">=</span> <span class="n">kin</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">one</span><span class="o">.</span><span class="n">iadd</span><span class="p">(</span><span class="n">na</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="transforming-the-hamiltonian-to-the-molecular-orbital-mo-basis">
<h3>4.1.8.1. Transforming the Hamiltonian to the molecular-orbital (MO) basis<a class="headerlink" href="#transforming-the-hamiltonian-to-the-molecular-orbital-mo-basis" title="Permalink to this headline"></a></h3>
<p>The function <a class="reference internal" href="lib/mod_horton_orbital_utils.html#horton.orbital_utils.transform_integrals" title="horton.orbital_utils.transform_integrals"><code class="xref py py-func docutils literal"><span class="pre">transform_integrals()</span></code></a> can be used for
this purpose. It works differently for restricted and unrestricted orbitals:</p>
<ol class="arabic">
<li><p class="first">In the case of restricted (Hartree-Fock) orbitals, there is just one
transformed one-body and one transformed two-body operator:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">(</span><span class="n">one_mo</span><span class="p">,),</span> <span class="p">(</span><span class="n">two_mo</span><span class="p">,)</span> <span class="o">=</span> <span class="n">transform_integrals</span><span class="p">(</span><span class="n">one</span><span class="p">,</span> <span class="n">er</span><span class="p">,</span> <span class="s">&#39;tensordot&#39;</span><span class="p">,</span> <span class="n">exp_alpha</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p class="first">In the case of unrestricted (Hartree-Fock) orbitals, there are two
transformed one-body and three transformed two-body operators:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">one_mo_ops</span><span class="p">,</span> <span class="n">two_mo_ops</span> <span class="o">=</span> <span class="n">transform_integrals</span><span class="p">(</span><span class="n">one</span><span class="p">,</span> <span class="n">er</span><span class="p">,</span> <span class="s">&#39;tensordot&#39;</span><span class="p">,</span> <span class="n">exp_alpha</span><span class="p">,</span> <span class="n">exp_beta</span><span class="p">)</span>
<span class="n">one_mo_alpha</span><span class="p">,</span> <span class="n">one_mo_beta</span> <span class="o">=</span> <span class="n">one_mo_ops</span>
<span class="n">two_mo_alpha_alpha</span><span class="p">,</span> <span class="n">two_mo_alpha_beta</span><span class="p">,</span> <span class="n">two_mo_beta_beta</span> <span class="o">=</span> <span class="n">two_mo_ops</span>
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="reducing-the-hamiltonian-to-an-active-space">
<h3>4.1.8.2. Reducing the Hamiltonian to an active space<a class="headerlink" href="#reducing-the-hamiltonian-to-an-active-space" title="Permalink to this headline"></a></h3>
<p>The active-space feature only works for restricted orbitals. The new
one-electron integrals <span class="math">\(\tilde{t}_{pq}\)</span> become</p>
<div class="math">
\[\tilde{t}_{pq} = t_{pq} + \sum_{i \in \textrm{ncore}} ( 2 \langle pi \vert qi \rangle - \langle pi \vert iq \rangle),\]</div>
<p>where <span class="math">\(t_{pq}\)</span> is the element <span class="math">\(pq\)</span> of the old one-electron integrals
and <span class="math">\(\langle pi \vert qi \rangle\)</span> is the appropriate two-electron integral
in physicist&#8217;s notation. The core energy of the active space is calculated as</p>
<div class="math">
\[e_\text{core} = e_\text{nn} + 2\sum_{i \in \textrm{ncore}} t_{ii} + \sum_{i, j \in \textrm{ncore}} (2 \langle ij \vert ij \rangle - \langle ij \vert ji \rangle)\]</div>
<p>where the two-electron integrals <span class="math">\(\langle pq \vert rs \rangle\)</span> contain only
the elements with active orbital indices <span class="math">\(p,q,r,s\)</span>. This type of conversion
is implemented in the function <a class="reference internal" href="lib/mod_horton_orbital_utils.html#horton.orbital_utils.split_core_active" title="horton.orbital_utils.split_core_active"><code class="xref py py-func docutils literal"><span class="pre">split_core_active()</span></code></a>.
It is used as follows:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">one_small</span><span class="p">,</span> <span class="n">two_small</span><span class="p">,</span> <span class="n">core_energy</span> <span class="o">=</span> <span class="n">split_core_active</span><span class="p">(</span><span class="n">one</span><span class="p">,</span> <span class="n">er</span><span class="p">,</span>
   <span class="n">external</span><span class="p">[</span><span class="s">&#39;nn&#39;</span><span class="p">],</span> <span class="n">exp_alpha</span><span class="p">,</span> <span class="n">ncore</span><span class="p">,</span> <span class="n">nactive</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="complete-examples">
<span id="hf-dft-complete-examples"></span><h2>4.1.9. Complete examples<a class="headerlink" href="#complete-examples" title="Permalink to this headline"></a></h2>
<p>The following is a basic example of a restricted Hartree-Fock calculation of
water. It contains all the steps discussed in the previous sections.</p>
<div class="literal-block-wrapper container" id="data-examples-hf-dft-rhf-n2-dense-py">
<div class="code-block-caption"><span class="caption-text">data/examples/hf_dft/rhf_n2_dense.py</span><a class="headerlink" href="#data-examples-hf-dft-rhf-n2-dense-py" title="Permalink to this code"></a></div>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">horton</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>


<span class="c"># Hartree-Fock calculation</span>
<span class="c"># ------------------------</span>

<span class="c"># Construct a molecule from scratch</span>
<span class="n">bond_length</span> <span class="o">=</span> <span class="mf">1.098</span><span class="o">*</span><span class="n">angstrom</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">IOData</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">&#39;dinitrogen&#39;</span><span class="p">)</span>
<span class="n">mol</span><span class="o">.</span><span class="n">coordinates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">bond_length</span><span class="p">]])</span>
<span class="n">mol</span><span class="o">.</span><span class="n">numbers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>

<span class="c"># Create a Gaussian basis set</span>
<span class="n">obasis</span> <span class="o">=</span> <span class="n">get_gobasis</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">coordinates</span><span class="p">,</span> <span class="n">mol</span><span class="o">.</span><span class="n">numbers</span><span class="p">,</span> <span class="s">&#39;cc-pvdz&#39;</span><span class="p">)</span>

<span class="c"># Create a linalg factory</span>
<span class="n">lf</span> <span class="o">=</span> <span class="n">DenseLinalgFactory</span><span class="p">(</span><span class="n">obasis</span><span class="o">.</span><span class="n">nbasis</span><span class="p">)</span>

<span class="c"># Compute Gaussian integrals</span>
<span class="n">olp</span> <span class="o">=</span> <span class="n">obasis</span><span class="o">.</span><span class="n">compute_overlap</span><span class="p">(</span><span class="n">lf</span><span class="p">)</span>
<span class="n">kin</span> <span class="o">=</span> <span class="n">obasis</span><span class="o">.</span><span class="n">compute_kinetic</span><span class="p">(</span><span class="n">lf</span><span class="p">)</span>
<span class="n">na</span> <span class="o">=</span> <span class="n">obasis</span><span class="o">.</span><span class="n">compute_nuclear_attraction</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">coordinates</span><span class="p">,</span> <span class="n">mol</span><span class="o">.</span><span class="n">pseudo_numbers</span><span class="p">,</span> <span class="n">lf</span><span class="p">)</span>
<span class="n">er</span> <span class="o">=</span> <span class="n">obasis</span><span class="o">.</span><span class="n">compute_electron_repulsion</span><span class="p">(</span><span class="n">lf</span><span class="p">)</span>

<span class="c"># Create alpha orbitals</span>
<span class="n">exp_alpha</span> <span class="o">=</span> <span class="n">lf</span><span class="o">.</span><span class="n">create_expansion</span><span class="p">()</span>

<span class="c"># Initial guess</span>
<span class="n">guess_core_hamiltonian</span><span class="p">(</span><span class="n">olp</span><span class="p">,</span> <span class="n">kin</span><span class="p">,</span> <span class="n">na</span><span class="p">,</span> <span class="n">exp_alpha</span><span class="p">)</span>

<span class="c"># Construct the restricted HF effective Hamiltonian</span>
<span class="n">external</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;nn&#39;</span><span class="p">:</span> <span class="n">compute_nucnuc</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">coordinates</span><span class="p">,</span> <span class="n">mol</span><span class="o">.</span><span class="n">pseudo_numbers</span><span class="p">)}</span>
<span class="n">terms</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">RTwoIndexTerm</span><span class="p">(</span><span class="n">kin</span><span class="p">,</span> <span class="s">&#39;kin&#39;</span><span class="p">),</span>
    <span class="n">RDirectTerm</span><span class="p">(</span><span class="n">er</span><span class="p">,</span> <span class="s">&#39;hartree&#39;</span><span class="p">),</span>
    <span class="n">RExchangeTerm</span><span class="p">(</span><span class="n">er</span><span class="p">,</span> <span class="s">&#39;x_hf&#39;</span><span class="p">),</span>
    <span class="n">RTwoIndexTerm</span><span class="p">(</span><span class="n">na</span><span class="p">,</span> <span class="s">&#39;ne&#39;</span><span class="p">),</span>
<span class="p">]</span>
<span class="n">ham</span> <span class="o">=</span> <span class="n">REffHam</span><span class="p">(</span><span class="n">terms</span><span class="p">,</span> <span class="n">external</span><span class="p">)</span>

<span class="c"># Decide how to occupy the orbitals (7 alpha electrons)</span>
<span class="n">occ_model</span> <span class="o">=</span> <span class="n">AufbauOccModel</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>

<span class="c"># Converge WFN with plain SCF</span>
<span class="n">scf_solver</span> <span class="o">=</span> <span class="n">PlainSCFSolver</span><span class="p">(</span><span class="mf">1e-6</span><span class="p">)</span>
<span class="n">scf_solver</span><span class="p">(</span><span class="n">ham</span><span class="p">,</span> <span class="n">lf</span><span class="p">,</span> <span class="n">olp</span><span class="p">,</span> <span class="n">occ_model</span><span class="p">,</span> <span class="n">exp_alpha</span><span class="p">)</span>


<span class="c"># Write SCF results to a file</span>
<span class="c"># ---------------------------</span>

<span class="c"># Assign results to the molecule object and write it to a file, e.g. for</span>
<span class="c"># later analysis</span>
<span class="n">mol</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s">&#39;RHF computation on dinitrogen&#39;</span>
<span class="n">mol</span><span class="o">.</span><span class="n">energy</span> <span class="o">=</span> <span class="n">ham</span><span class="o">.</span><span class="n">cache</span><span class="p">[</span><span class="s">&#39;energy&#39;</span><span class="p">]</span>
<span class="n">mol</span><span class="o">.</span><span class="n">obasis</span> <span class="o">=</span> <span class="n">obasis</span>
<span class="n">mol</span><span class="o">.</span><span class="n">exp_alpha</span> <span class="o">=</span> <span class="n">exp_alpha</span>

<span class="c"># useful for visualization:</span>
<span class="n">mol</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="s">&#39;n2-scf.molden&#39;</span><span class="p">)</span>
<span class="c"># useful for post-processing (results stored in double precision)</span>
<span class="n">mol</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="s">&#39;n2-scf.h5&#39;</span><span class="p">)</span>


<span class="c"># Export Hamiltonian in Hartree-Fock molecular orbital basis (all orbitals active)</span>
<span class="c"># --------------------------------------------------------------------------------</span>

<span class="c"># Transform orbitals</span>
<span class="n">one</span> <span class="o">=</span> <span class="n">kin</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">one</span><span class="o">.</span><span class="n">iadd</span><span class="p">(</span><span class="n">na</span><span class="p">)</span>
<span class="n">two</span> <span class="o">=</span> <span class="n">er</span>
<span class="p">(</span><span class="n">one_mo</span><span class="p">,),</span> <span class="p">(</span><span class="n">two_mo</span><span class="p">,)</span> <span class="o">=</span> <span class="n">transform_integrals</span><span class="p">(</span><span class="n">one</span><span class="p">,</span> <span class="n">two</span><span class="p">,</span> <span class="s">&#39;tensordot&#39;</span><span class="p">,</span> <span class="n">mol</span><span class="o">.</span><span class="n">exp_alpha</span><span class="p">)</span>

<span class="c"># Write files</span>
<span class="n">mol_all_active</span> <span class="o">=</span> <span class="n">IOData</span><span class="p">(</span><span class="n">core_energy</span><span class="o">=</span><span class="n">external</span><span class="p">[</span><span class="s">&#39;nn&#39;</span><span class="p">],</span> <span class="n">one_mo</span><span class="o">=</span><span class="n">one_mo</span><span class="p">,</span> <span class="n">two_mo</span><span class="o">=</span><span class="n">two_mo</span><span class="p">)</span>
<span class="c"># useful for exchange with other codes</span>
<span class="n">mol_all_active</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="s">&#39;n2.FCIDUMP&#39;</span><span class="p">)</span>
<span class="c"># useful for exchange with other HORTON scripts</span>
<span class="n">mol_all_active</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="s">&#39;n2-hamiltonian.h5&#39;</span><span class="p">)</span>


<span class="c"># Export Hamiltonian in Hartree-Fock molecular orbital basis for CAS(8,8)</span>
<span class="c"># -----------------------------------------------------------------------</span>

<span class="c"># Transform orbitals</span>
<span class="n">one_small</span><span class="p">,</span> <span class="n">two_small</span><span class="p">,</span> <span class="n">core_energy</span> <span class="o">=</span> <span class="n">split_core_active</span><span class="p">(</span><span class="n">one</span><span class="p">,</span> <span class="n">er</span><span class="p">,</span>
    <span class="n">external</span><span class="p">[</span><span class="s">&#39;nn&#39;</span><span class="p">],</span> <span class="n">exp_alpha</span><span class="p">,</span> <span class="n">ncore</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nactive</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

<span class="c"># Write files</span>
<span class="n">mol_cas88</span> <span class="o">=</span> <span class="n">IOData</span><span class="p">(</span><span class="n">core_energy</span><span class="o">=</span><span class="n">core_energy</span><span class="p">,</span> <span class="n">one_mo</span><span class="o">=</span><span class="n">one_mo</span><span class="p">,</span> <span class="n">two_mo</span><span class="o">=</span><span class="n">two_mo</span><span class="p">,</span> <span class="n">nelec</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">ms2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">lf</span><span class="o">=</span><span class="n">lf</span><span class="p">)</span>
<span class="c"># useful for exchange with other codes</span>
<span class="n">mol_cas88</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="s">&#39;n2-cas8-8.FCIDUMP&#39;</span><span class="p">)</span>
<span class="c"># useful for exchange with other HORTON scripts</span>
<span class="n">mol_cas88</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="s">&#39;n2-hamiltonian-cas8-8.h5&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The directory <code class="docutils literal"><span class="pre">data/examples/hf_dft</span></code> contains many more examples that use the
different options discussed above. The following table shows which features are
used in which example.</p>
<table border="1" class="docutils">
<colgroup>
<col width="18%" />
<col width="10%" />
<col width="13%" />
<col width="59%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">File name</th>
<th class="head">LOT</th>
<th class="head">SCF</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>rhf_h2_cholesky.py</td>
<td>RHF/6-31G</td>
<td>PlainSCFSolver</td>
<td>Basic RHF example with Cholesky matrices, includes export of Hamiltonian</td>
</tr>
<tr class="row-odd"><td>rhf_n2_dense.py</td>
<td>RHF/cc-pvtz</td>
<td>PlainSCFSolver</td>
<td>Basic RHF example with dense matrices, includes export of Hamiltonian</td>
</tr>
<tr class="row-even"><td>rhf_water_dense.py</td>
<td>RHF/3-21G</td>
<td>PlainSCFSolver</td>
<td>Basic RHF example with dense matrices</td>
</tr>
<tr class="row-odd"><td>uhf_methyl_dense.py</td>
<td>UHF/3-21G</td>
<td>PlainSCFSolver</td>
<td>Basic UHF example with dense matrices</td>
</tr>
<tr class="row-even"><td>rhf_water_cholesky.py</td>
<td>RHF/cc-pVDZ</td>
<td>PlainSCFSolver</td>
<td>Basic RHF example with Cholesky decomposition of the ERI</td>
</tr>
<tr class="row-odd"><td>uhf_methyl_cholesky.py</td>
<td>UHF/cc-pVDZ</td>
<td>PlainSCFSolver</td>
<td>Basic UHF example with Cholesky decomposition of the ERI</td>
</tr>
<tr class="row-even"><td>rks_water_lda.py</td>
<td>RKS/6-31G*</td>
<td>ODASCFSolver</td>
<td>Basic RKS DFT example with LDA exhange-correlation functional (Dirac+VWN)</td>
</tr>
<tr class="row-odd"><td>uks_methyl_lda.py</td>
<td>UKS/6-31G*</td>
<td>ODASCFSolver</td>
<td>Basic UKS DFT example with LDA exhange-correlation functional (Dirac+VWN)</td>
</tr>
<tr class="row-even"><td>rks_water_gga.py</td>
<td>RKS/6-31G*</td>
<td>CDIISSCFSolver</td>
<td>Basic RKS DFT example with GGA exhange-correlation functional (PBE)</td>
</tr>
<tr class="row-odd"><td>uks_methyl_gga.py</td>
<td>UKS/6-31G*</td>
<td>CDIISSCFSolver</td>
<td>Basic UKS DFT example with GGA exhange-correlation functional (PBE)</td>
</tr>
<tr class="row-even"><td>rks_water_hybgga.py</td>
<td>RKS/6-31G*</td>
<td>EDIIS2SCFSolver</td>
<td>Basic RKS DFT example with hyrbid GGA exhange-correlation functional (B3LYP)</td>
</tr>
<tr class="row-odd"><td>uks_methyl_hybgga.py</td>
<td>UKS/6-31G*</td>
<td>EDIIS2SCFSolver</td>
<td>Basic UKS DFT example with hyrbid GGA exhange-correlation functional (B3LYP)</td>
</tr>
<tr class="row-even"><td>rks_water_numlda.py</td>
<td>RKS/6-31G*</td>
<td>CDIISSCFSolver</td>
<td>RKS DFT example with LDA and numerical Hartree</td>
</tr>
<tr class="row-odd"><td>uks_methyl_numlda.py</td>
<td>UKS/6-31G*</td>
<td>CDIISSCFSolver</td>
<td>UKS DFT example with LDA and numerical Hartree</td>
</tr>
<tr class="row-even"><td>rks_water_numgga.py</td>
<td>RKS/6-31G*</td>
<td>CDIISSCFSolver</td>
<td>RKS DFT example with GGA and numerical Hartree</td>
</tr>
<tr class="row-odd"><td>uks_methyl_numgga.py</td>
<td>UKS/6-31G*</td>
<td>CDIISSCFSolver</td>
<td>UKS DFT example with GGA and numerical Hartree</td>
</tr>
</tbody>
</table>
<p>A more elaborate example can be found in <code class="docutils literal"><span class="pre">data/examples/hf_compare</span></code>. It
contains a script that systemtically computes all elements in the periodic table
(for different charges and multiplicities), and compares the results with
outputs obtained with Gaussian. See the <code class="docutils literal"><span class="pre">README</span></code> file for instructions how to
run this example.</p>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="user_estruct_ap1rog.html" class="btn btn-neutral float-right" title="4.2. The AP1roG module" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="user_estruct.html" class="btn btn-neutral" title="4. Electronic Structure Methods" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div>Documentation for HORTON 2.0.0 built from release 2.0.0. </div>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2011-2015, The HORTON Development Team.
      Last updated on Jun 11, 2015.
    </p>
  </div>

  <div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  </div>
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'2.0.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>