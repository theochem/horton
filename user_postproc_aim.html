

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>5.1. Atoms-in-Molecules (AIM) analysis &mdash; HORTON 2.0.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
    <link rel="top" title="HORTON 2.0.0 documentation" href="index.html"/>
        <link rel="up" title="5. Post-processing" href="user_postproc.html"/>
        <link rel="next" title="5.2. Electrostatic potential fitting" href="user_postproc_espfit.html"/>
        <link rel="prev" title="5. Post-processing" href="user_postproc.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="index.html">
        

        
          
          <img src="_static/horton.png" class="logo" />
        
        </a>

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul>
<li class="toctree-l1"><a class="reference internal" href="intro_horton_overview.html">1. HORTON Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="intro_horton_overview.html#our-manifesto">1.1. Our Manifesto</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro_horton_overview.html#main-features">1.2. Main Features</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="intro_citing_horton.html">2. Citing HORTON</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro_license_information.html">3. License Information</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro_contact_information.html">4. Contact Information</a></li>
</ul>
<p class="caption"><span class="caption-text">User documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="user_download_and_install.html">1. Download and Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="user_download_and_install_linux.html">1.1. Download and installation on Linux (Fedora and Ubuntu)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="user_download_and_install_linux.html#disclaimer">1.1.1. Disclaimer</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_download_and_install_linux.html#download-the-code">1.1.2. Download the code</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_download_and_install_linux.html#dependencies-for-building-installing-and-testing-horton">1.1.3. Dependencies for building, installing and testing HORTON</a><ul>
<li class="toctree-l4"><a class="reference internal" href="user_download_and_install_linux.html#installing-dependencies-with-a-package-manager">1.1.3.1. Installing dependencies with a package manager</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_download_and_install_linux.html#installing-dependencies-manually">1.1.3.2. Installing dependencies manually</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="user_download_and_install_linux.html#compilation-and-installation">1.1.4. Compilation and installation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="user_download_and_install_linux.html#build-and-install">1.1.4.1. Build and install</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_download_and_install_linux.html#overriding-default-compiler-linker-settings-for-libxc-libint2-and-blas">1.1.4.2. Overriding default compiler/linker settings for LibXC, LibInt2 and BLAS</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_download_and_install_linux.html#runtime-configuration">1.1.4.3. Runtime configuration</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="user_download_and_install_linux.html#running-the-tests">1.1.5. Running the tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_download_and_install_linux.html#building-the-documentation">1.1.6. Building the documentation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="user_download_and_install_linux.html#dependencies">1.1.6.1. Dependencies</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_download_and_install_linux.html#installing-the-dependencies-with-a-package-manager-and-pip">1.1.6.2. Installing the dependencies with a package manager and PIP</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_download_and_install_linux.html#actual-build">1.1.6.3. Actual build</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="user_download_and_install_mac.html">1.2. Download and installation on Mac OS X (10.8&#8211;10.10)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="user_download_and_install_mac.html#disclaimer">1.2.1. Disclaimer</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_download_and_install_mac.html#macports">1.2.2. MacPorts</a><ul>
<li class="toctree-l4"><a class="reference internal" href="user_download_and_install_mac.html#quick-tour-of-macports">1.2.2.1. Quick tour of MacPorts</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="user_download_and_install_mac.html#download-the-code">1.2.3. Download the code</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_download_and_install_mac.html#dependencies-for-building-installing-and-testing-horton">1.2.4. Dependencies for building, installing and testing HORTON</a><ul>
<li class="toctree-l4"><a class="reference internal" href="user_download_and_install_mac.html#installing-the-dependencies-with-macports">1.2.4.1. Installing the dependencies with MacPorts</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_download_and_install_mac.html#installing-dependencies-manually">1.2.4.2. Installing dependencies manually</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="user_download_and_install_mac.html#compilation-and-installation">1.2.5. Compilation and installation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="user_download_and_install_mac.html#build-and-install">1.2.5.1. Build and install</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_download_and_install_mac.html#overriding-default-compiler-linker-settings-for-libxc-libint2-and-blas">1.2.5.2. Overriding default compiler/linker settings for LibXC, LibInt2 and BLAS</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_download_and_install_mac.html#runtime-configuration">1.2.5.3. Runtime configuration</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="user_download_and_install_mac.html#running-the-tests">1.2.6. Running the tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_download_and_install_mac.html#building-the-documentation">1.2.7. Building the documentation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="user_download_and_install_mac.html#dependencies">1.2.7.1. Dependencies</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_download_and_install_mac.html#installing-the-dependencies-with-macports-and-pip">1.2.7.2. Installing the dependencies with MacPorts and PIP</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_download_and_install_mac.html#actual-build">1.2.7.3. Actual build</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="user_download_and_install_setup_cfg.html">1.3. Controlling dynamic/static linking against LibXC, LibInt2 and BLAS</a><ul>
<li class="toctree-l3"><a class="reference internal" href="user_download_and_install_setup_cfg.html#introduction">1.3.1. Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_download_and_install_setup_cfg.html#setup-cfg-and-environment-variables">1.3.2. <code class="docutils literal"><span class="pre">setup.cfg</span></code> and environment variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_download_and_install_setup_cfg.html#other-ways-of-controlling-compilation-and-linker-flags">1.3.3. Other ways of controlling compilation and linker flags</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="user_download_and_install_troubleshooting.html">1.4. Troubleshooting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="user_download_and_install_troubleshooting.html#introduction">1.4.1. Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_download_and_install_troubleshooting.html#python-modules">1.4.2. Python modules</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_download_and_install_troubleshooting.html#excecutables">1.4.3. Excecutables</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_download_and_install_troubleshooting.html#libraries">1.4.4. Libraries</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="user_getting_started.html">2. Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="user_getting_started.html#how-to-use-horton">2.1. How to use HORTON?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="user_getting_started.html#running-horton-as-a-python-library">2.1.1. Running HORTON as a Python library</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_getting_started.html#running-horton-as-horton-py-scripts">2.1.2. Running HORTON as <code class="docutils literal"><span class="pre">horton-*.py</span></code> scripts</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="user_getting_started.html#writing-a-basic-horton-python-script">2.2. Writing a basic HORTON Python script</a><ul>
<li class="toctree-l3"><a class="reference internal" href="user_getting_started.html#atomic-units">2.2.1. Atomic Units</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_getting_started.html#array-indexing">2.2.2. Array Indexing</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_getting_started.html#loading-dumping-data-from-to-a-file">2.2.3. Loading/Dumping Data from/to a File</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_getting_started.html#periodic-table">2.2.4. Periodic Table</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_getting_started.html#a-complete-example">2.2.5. A Complete Example</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="user_hamiltonian.html">3. Hamiltonians</a><ul>
<li class="toctree-l2"><a class="reference internal" href="user_hamiltonian_molecular.html">3.1. Molecular Hamiltonians</a><ul>
<li class="toctree-l3"><a class="reference internal" href="user_hamiltonian_molecular.html#specifying-the-molecular-geometry">3.1.1. Specifying the molecular geometry</a><ul>
<li class="toctree-l4"><a class="reference internal" href="user_hamiltonian_molecular.html#reading-the-molecular-geometry-from-file">3.1.1.1. Reading the molecular geometry from file</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_hamiltonian_molecular.html#constructing-a-molecular-geometry-from-scratch">3.1.1.2. Constructing a molecular geometry from scratch</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="user_hamiltonian_molecular.html#specifying-the-basis-set">3.1.2. Specifying the basis set</a><ul>
<li class="toctree-l4"><a class="reference internal" href="user_hamiltonian_molecular.html#unique-basis-set-for-all-atoms">3.1.2.1. Unique basis set for all atoms</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_hamiltonian_molecular.html#specifying-different-basis-sets-for-different-atoms">3.1.2.2. Specifying different basis sets for different atoms</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_hamiltonian_molecular.html#loading-custom-basis-sets-from-file">3.1.2.3. Loading custom basis sets from file</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_hamiltonian_molecular.html#defining-basis-sets-with-python-code">3.1.2.4. Defining basis sets with Python code</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_hamiltonian_molecular.html#loading-geometry-and-basis-set-info-from-one-file">3.1.2.5. Loading geometry and basis set info from one file</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="user_hamiltonian_molecular.html#computing-hamiltonian-matrix-elements">3.1.3. Computing (Hamiltonian) matrix elements</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="user_hamiltonian_model.html">3.2. Defining a model Hamiltonian</a><ul>
<li class="toctree-l3"><a class="reference internal" href="user_hamiltonian_model.html#supported-features">3.2.1. Supported features</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_hamiltonian_model.html#the-hubbard-model-hamiltonian">3.2.2. The Hubbard model Hamiltonian</a><ul>
<li class="toctree-l4"><a class="reference internal" href="user_hamiltonian_model.html#preliminaries">3.2.2.1. Preliminaries</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_hamiltonian_model.html#defining-the-hamiltonian-and-boundary-conditions-open-or-periodic">3.2.2.2. Defining the Hamiltonian and boundary conditions (open or periodic)</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_hamiltonian_model.html#filling-the-lattice">3.2.2.3. Filling the lattice</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_hamiltonian_model.html#generate-initial-guess-orbitals-and-overlap-matrix">3.2.2.4. Generate initial guess orbitals and overlap matrix</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="user_hamiltonian_model.html#example-python-script">3.2.3. Example Python script</a><ul>
<li class="toctree-l4"><a class="reference internal" href="user_hamiltonian_model.html#restricted-hartree-fock-calculations-using-the-1-dim-hubbard-model-hamiltonian-with-pbc">3.2.3.1. Restricted Hartree-Fock calculations using the 1-dim Hubbard model Hamiltonian with PBC</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="user_hamiltonian_io.html">3.3. Dumping/Loading a Hamiltonian to/from a file</a><ul>
<li class="toctree-l3"><a class="reference internal" href="user_hamiltonian_io.html#horton-s-internal-format">3.3.1. HORTON&#8217;s internal format</a><ul>
<li class="toctree-l4"><a class="reference internal" href="user_hamiltonian_io.html#dumping">3.3.1.1. Dumping</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_hamiltonian_io.html#loading">3.3.1.2. Loading</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="user_hamiltonian_io.html#fcidump-format">3.3.2. FCIDUMP format</a><ul>
<li class="toctree-l4"><a class="reference internal" href="user_hamiltonian_io.html#id1">3.3.2.1. Dumping</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_hamiltonian_io.html#id2">3.3.2.2. Loading</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="user_estruct.html">4. Electronic Structure Methods</a><ul>
<li class="toctree-l2"><a class="reference internal" href="user_estruct_hf_dft.html">4.1. How to use HORTON as a Hartree-Fock/DFT program</a><ul>
<li class="toctree-l3"><a class="reference internal" href="user_estruct_hf_dft.html#setting-up-the-molecular-electronic-hamiltonian">4.1.1. Setting up the (molecular electronic) Hamiltonian</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_estruct_hf_dft.html#generating-an-initial-guess-of-the-wavefunction">4.1.2. Generating an initial guess of the wavefunction</a><ul>
<li class="toctree-l4"><a class="reference internal" href="user_estruct_hf_dft.html#core-hamiltonian-guess">4.1.2.1. Core Hamiltonian guess</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_estruct_hf_dft.html#randomizing-an-initial-guess">4.1.2.2. Randomizing an initial guess</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_estruct_hf_dft.html#modifying-the-initial-guess">4.1.2.3. Modifying the initial guess</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_estruct_hf_dft.html#reading-a-guess-from-a-file">4.1.2.4. Reading a guess from a file</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_estruct_hf_dft.html#projecting-orbitals-from-a-smaller-basis-onto-a-larger-one">4.1.2.5. Projecting orbitals from a smaller basis onto a larger one</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="user_estruct_hf_dft.html#defining-the-effective-hamiltonian">4.1.3. Defining the effective Hamiltonian</a><ul>
<li class="toctree-l4"><a class="reference internal" href="user_estruct_hf_dft.html#supported-energy-terms-for-the-effective-hamiltonians">4.1.3.1. Supported energy terms for the effective Hamiltonians</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_estruct_hf_dft.html#a-few-typical-examples">4.1.3.2. A few typical examples</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="user_estruct_hf_dft.html#choose-an-orbital-occupation-scheme">4.1.4. Choose an orbital occupation scheme</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_estruct_hf_dft.html#optimize-the-wavefunction-with-a-self-consistent-field-algorithm">4.1.5. Optimize the wavefunction with a self-consistent field algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_estruct_hf_dft.html#conversion-of-density-and-fock-matrix-to-orbitals">4.1.6. Conversion of density and Fock matrix to orbitals</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_estruct_hf_dft.html#writing-scf-results-to-a-file">4.1.7. Writing SCF results to a file</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_estruct_hf_dft.html#preparing-for-a-post-hartree-fock-calculation">4.1.8. Preparing for a Post-Hartree-Fock calculation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="user_estruct_hf_dft.html#transforming-the-hamiltonian-to-the-molecular-orbital-mo-basis">4.1.8.1. Transforming the Hamiltonian to the molecular-orbital (MO) basis</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_estruct_hf_dft.html#reducing-the-hamiltonian-to-an-active-space">4.1.8.2. Reducing the Hamiltonian to an active space</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="user_estruct_hf_dft.html#complete-examples">4.1.9. Complete examples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="user_estruct_ap1rog.html">4.2. The AP1roG module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="user_estruct_ap1rog.html#the-ap1rog-model">4.2.1. The AP1roG model</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_estruct_ap1rog.html#currently-supported-features">4.2.2. Currently supported features</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_estruct_ap1rog.html#input-structure">4.2.3. Input structure</a><ul>
<li class="toctree-l4"><a class="reference internal" href="user_estruct_ap1rog.html#getting-started">4.2.3.1. Getting started</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_estruct_ap1rog.html#ap1rog-with-orbital-optimization">4.2.3.2. AP1roG with orbital optimization</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_estruct_ap1rog.html#ap1rog-without-orbital-optimization">4.2.3.3. AP1roG without orbital optimization</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="user_estruct_ap1rog.html#troubleshooting-in-ap1rog-scf-calculations">4.2.4. Troubleshooting in AP1roG-SCF calculations</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_estruct_ap1rog.html#example-python-scripts">4.2.5. Example Python scripts</a><ul>
<li class="toctree-l4"><a class="reference internal" href="user_estruct_ap1rog.html#the-water-molecule-a-minimum-input-example">4.2.5.1. The water molecule (a minimum input example)</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_estruct_ap1rog.html#the-water-molecule-with-all-default-keyword-arguments">4.2.5.2. The water molecule (with all default keyword arguments)</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_estruct_ap1rog.html#ap1rog-with-external-integrals">4.2.5.3. AP1roG with external integrals</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_estruct_ap1rog.html#ap1rog-using-model-hamiltonians">4.2.5.4. AP1roG using model Hamiltonians</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="user_estruct_perturbation.html">4.3. The perturbation theory module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="user_estruct_perturbation.html#supported-features">4.3.1. Supported features</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_estruct_perturbation.html#moller-plesset-perturbation-theory-of-second-order">4.3.2. Moller-Plesset perturbation theory of second order</a><ul>
<li class="toctree-l4"><a class="reference internal" href="user_estruct_perturbation.html#getting-started">4.3.2.1. Getting started</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_estruct_perturbation.html#how-to-set-up-an-mp2-calculation">4.3.2.2. How to set-up an MP2 calculation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="user_estruct_perturbation.html#the-pta-module">4.3.3. The PTa module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="user_estruct_perturbation.html#getstartedpta">4.3.3.1. Getting started</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_estruct_perturbation.html#how-to-set-up-a-calculation">4.3.3.2. How to set-up a calculation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="user_estruct_perturbation.html#the-ptb-module">4.3.4. The PTb module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="user_estruct_perturbation.html#getstartedptb">4.3.4.1. Getting started</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_estruct_perturbation.html#id5">4.3.4.2. How to set-up a calculation</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_estruct_perturbation.html#summary-of-keyword-arguments">4.3.4.3. Summary of keyword arguments</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="user_estruct_perturbation.html#example-python-scripts">4.3.5. Example Python scripts</a><ul>
<li class="toctree-l4"><a class="reference internal" href="user_estruct_perturbation.html#mp2-calculation-on-the-water-molecule">4.3.5.1. MP2 calculation on the water molecule</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_estruct_perturbation.html#pta-calculation-on-the-water-molecule">4.3.5.2. PTa calculation on the water molecule</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_estruct_perturbation.html#ptb-calculation-on-the-water-molecule">4.3.5.3. PTb calculation on the water molecule</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="user_postproc.html">5. Post-processing</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="">5.1. Atoms-in-Molecules (AIM) analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#introduction">5.1.1. Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#horton-atomdb-py-build-a-pro-atom-database">5.1.2. <code class="docutils literal"><span class="pre">horton-atomdb.py</span></code> &#8211; Build a pro-atom database</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#template-files">5.1.2.1. Template files</a></li>
<li class="toctree-l4"><a class="reference internal" href="#basic-template-file-for-gaussian-03-09">5.1.2.2. Basic template file for Gaussian 03/09</a></li>
<li class="toctree-l4"><a class="reference internal" href="#advanced-template-file-for-gaussian-03-09">5.1.2.3. Advanced template file for Gaussian 03/09</a></li>
<li class="toctree-l4"><a class="reference internal" href="#simple-template-file-for-orca">5.1.2.4. Simple template file for ORCA</a></li>
<li class="toctree-l4"><a class="reference internal" href="#template-file-for-cp2k">5.1.2.5. Template file for CP2K</a></li>
<li class="toctree-l4"><a class="reference internal" href="#simple-template-file-for-psi4">5.1.2.6. Simple template file for PSI4</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#horton-wpart-py-aim-analysis-based-on-a-wavefunction-file">5.1.3. <code class="docutils literal"><span class="pre">horton-wpart.py</span></code> &#8211; AIM analysis based on a wavefunction file</a></li>
<li class="toctree-l3"><a class="reference internal" href="#horton-cpart-py-aim-analysis-based-on-a-cube-file">5.1.4. <code class="docutils literal"><span class="pre">horton-cpart.py</span></code> &#8211; AIM analysis based on a cube file</a></li>
<li class="toctree-l3"><a class="reference internal" href="#python-interface-to-the-partitioning-code">5.1.5. Python interface to the partitioning code</a></li>
<li class="toctree-l3"><a class="reference internal" href="#frequently-asked-questions">5.1.6. Frequently asked questions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="user_postproc_espfit.html">5.2. Electrostatic potential fitting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="user_postproc_espfit.html#introduction">5.2.1. Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_postproc_espfit.html#horton-esp-cost-py-set-up-an-esp-cost-function">5.2.2. <code class="docutils literal"><span class="pre">horton-esp-cost.py</span></code> &#8211; Set up an ESP cost function</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_postproc_espfit.html#horton-esp-fit-py-fit-atomic-charges-to-the-esp">5.2.3. <code class="docutils literal"><span class="pre">horton-esp-fit.py</span></code> &#8211; Fit atomic charges to the ESP</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_postproc_espfit.html#horton-esp-test-py-test-the-esp-quality-of-a-given-set-of-charges">5.2.4. <code class="docutils literal"><span class="pre">horton-esp-test.py</span></code> &#8211; Test the ESP quality of a given set of charges</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_postproc_espfit.html#making-nice-cube-files-with-gaussian">5.2.5. Making nice cube files with Gaussian</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_postproc_espfit.html#making-cube-files-with-cp2k">5.2.6. Making cube files with CP2K</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_postproc_espfit.html#python-interface-to-the-esp-fitting-code">5.2.7. Python interface to the ESP fitting code</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="user_postproc_localization.html">5.3. Localization of molecular orbitals</a><ul>
<li class="toctree-l3"><a class="reference internal" href="user_postproc_localization.html#pipek-mezey-localization">5.3.1. Pipek-Mezey localization</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_postproc_localization.html#example-python-scripts">5.3.2. Example Python scripts</a><ul>
<li class="toctree-l4"><a class="reference internal" href="user_postproc_localization.html#pipek-mezey-localization-of-restricted-hartree-fock-orbitals-for-the-water-molecule">5.3.2.1. Pipek-Mezey localization of restricted Hartree-Fock orbitals for the water molecule</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="user_postproc_orbital_entanglement.html">5.4. Orbital entanglement analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="user_postproc_orbital_entanglement.html#orbital-entanglement-and-orbital-correlation">5.4.1. Orbital entanglement and orbital correlation</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_postproc_orbital_entanglement.html#supported-features">5.4.2. Supported features</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_postproc_orbital_entanglement.html#orbital-entanglement-and-correlation-for-a-seniority-zero-wavefunction">5.4.3. Orbital entanglement and correlation for a seniority zero wavefunction</a><ul>
<li class="toctree-l4"><a class="reference internal" href="user_postproc_orbital_entanglement.html#how-to-set-up-a-calculation">5.4.3.1. How to set-up a calculation</a></li>
<li class="toctree-l4"><a class="reference internal" href="user_postproc_orbital_entanglement.html#how-to-generate-correlation-diagrams">5.4.3.2. How to generate correlation diagrams</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="user_postproc_orbital_entanglement.html#example-python-scripts">5.4.4. Example Python scripts</a><ul>
<li class="toctree-l4"><a class="reference internal" href="user_postproc_orbital_entanglement.html#orbital-entanglement-analysis-of-an-ap1rog-wavefunction">5.4.4.1. Orbital entanglement analysis of an AP1roG wavefunction</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="user_other.html">6. Other Topics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="user_other_numerical_integration.html">6.1. How to use HORTON for numerical integration?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="user_other_numerical_integration.html#building-an-integration-grid">6.1.1. Building an integration grid</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_other_numerical_integration.html#computing-an-integral-involving-the-electron-density">6.1.2. Computing an integral involving the electron density</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_other_numerical_integration.html#constructing-a-one-body-operator-from-a-real-space-potential">6.1.3. Constructing a one-body operator from a real-space potential</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="user_other_matrix.html">6.2. How to use HORTON&#8217;s <code class="docutils literal"><span class="pre">matrix</span></code> package?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="user_other_matrix.html#introduction">6.2.1. Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_other_matrix.html#using-the-matrix-package">6.2.2. Using the <code class="docutils literal"><span class="pre">matrix</span></code> package</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="user_other_conversion.html">6.3. How to use HORTON to convert between file formats?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="user_other_conversion.html#horton-convert-py-conversion-between-file-formats-supported-by-horton">6.3.1. <code class="docutils literal"><span class="pre">horton-convert.py</span></code> &#8211; Conversion between file formats supported by HORTON</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_other_conversion.html#horton-hdf2csv-py-conversion-of-hdf5-files-to-csv-format">6.3.2. <code class="docutils literal"><span class="pre">horton-hdf2csv.py</span></code> &#8211; Conversion of HDF5 files to CSV format</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Technical stuff</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tech_dev.html">1. Developer Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tech_dev_coding_guidelines.html">1.1. Coding guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="tech_dev_git.html">1.2. How to use Git</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tech_dev_git.html#installing-git">1.2.1. Installing Git</a></li>
<li class="toctree-l3"><a class="reference internal" href="tech_dev_git.html#git-configuration">1.2.2. Git configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="tech_dev_git.html#some-terminology">1.2.3. Some terminology</a></li>
<li class="toctree-l3"><a class="reference internal" href="tech_dev_git.html#cloning-the-horton-git-repository">1.2.4. Cloning the HORTON git repository</a></li>
<li class="toctree-l3"><a class="reference internal" href="tech_dev_git.html#additional-steps-required-to-build-the-development-version-of-horton">1.2.5. Additional steps required to build the development version of HORTON</a></li>
<li class="toctree-l3"><a class="reference internal" href="tech_dev_git.html#work-flow-for-adding-a-new-feature">1.2.6. Work flow for adding a new feature</a><ul>
<li class="toctree-l4"><a class="reference internal" href="tech_dev_git.html#develop-the-feature-in-a-separate-branch">1.2.6.1. Develop the feature in a separate branch</a></li>
<li class="toctree-l4"><a class="reference internal" href="tech_dev_git.html#make-your-branch-available-for-review">1.2.6.2. Make your branch available for review</a></li>
<li class="toctree-l4"><a class="reference internal" href="tech_dev_git.html#rebase-your-branch-on-top-of-the-master-branch">1.2.6.3. Rebase your branch on top of the <code class="docutils literal"><span class="pre">master</span></code> branch</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="tech_dev_git.html#common-issues">1.2.7. Common issues</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tech_dev_documentation.html">1.3. Writing documentation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tech_dev_documentation.html#introduction">1.3.1. Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="tech_dev_documentation.html#building-documentation">1.3.2. Building documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="tech_dev_documentation.html#common-issues">1.3.3. Common issues</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tech_dev_unit_tests.html">1.4. Writing unit tests</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tech_dev_unit_tests.html#running-the-tests">1.4.1. Running the tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="tech_dev_unit_tests.html#writing-new-tests">1.4.2. Writing new tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="tech_dev_unit_tests.html#writing-tests-that-need-a-temporary-directory">1.4.3. Writing tests that need a temporary directory</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tech_dev_examples.html">1.5. Writing examples scripts</a></li>
<li class="toctree-l2"><a class="reference internal" href="tech_dev_citing_papers.html">1.6. Citing scientific work</a></li>
<li class="toctree-l2"><a class="reference internal" href="tech_dev_cython.html">1.7. Accelerating HORTON code with Cython</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tech_dev_cython.html#before-you-begin">1.7.1. Before you begin</a></li>
<li class="toctree-l3"><a class="reference internal" href="tech_dev_cython.html#basic-example">1.7.2. Basic example</a><ul>
<li class="toctree-l4"><a class="reference internal" href="tech_dev_cython.html#background">1.7.2.1. Background</a></li>
<li class="toctree-l4"><a class="reference internal" href="tech_dev_cython.html#cythonizing-your-code">1.7.2.2. Cythonizing your code</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="tech_dev_cython.html#additional-notes">1.7.3. Additional notes</a></li>
<li class="toctree-l3"><a class="reference internal" href="tech_dev_cython.html#further-reading">1.7.4. Further reading</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tech_ref.html">2. Reference Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tech_ref_contributors.html">2.1. Contributors</a></li>
<li class="toctree-l2"><a class="reference internal" href="tech_ref_release_planning.html">2.2. Release planning</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tech_ref_release_planning.html#stable-api-and-beta-code">2.2.1. Stable API and beta code</a></li>
<li class="toctree-l3"><a class="reference internal" href="tech_ref_release_planning.html#unstable-code-in-horton-version">2.2.2. Unstable code in HORTON 2.0.0</a></li>
<li class="toctree-l3"><a class="reference internal" href="tech_ref_release_planning.html#features-in-development">2.2.3. Features in development</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tech_ref_release_history.html">2.3. Release history</a></li>
<li class="toctree-l2"><a class="reference internal" href="tech_ref_file_formats.html">2.4. Data file formats (input and output)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tech_ref_file_formats.html#molecular-geometry-file-formats">2.4.1. Molecular geometry file formats</a><ul>
<li class="toctree-l4"><a class="reference internal" href="tech_ref_file_formats.html#the-xyz-format">2.4.1.1. The <code class="docutils literal"><span class="pre">.xyz</span></code> format</a></li>
<li class="toctree-l4"><a class="reference internal" href="tech_ref_file_formats.html#the-poscar-format">2.4.1.2. The <code class="docutils literal"><span class="pre">POSCAR</span></code> format</a></li>
<li class="toctree-l4"><a class="reference internal" href="tech_ref_file_formats.html#the-cif-crystalographic-information-file-format">2.4.1.3. The <code class="docutils literal"><span class="pre">.cif</span></code> (Crystalographic Information File) format</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="tech_ref_file_formats.html#cube-file-formats">2.4.2. Cube file formats</a><ul>
<li class="toctree-l4"><a class="reference internal" href="tech_ref_file_formats.html#the-gaussian-cube-format">2.4.2.1. The Gaussian <code class="docutils literal"><span class="pre">.cube</span></code> format</a></li>
<li class="toctree-l4"><a class="reference internal" href="tech_ref_file_formats.html#the-vasp-chgcar-and-locpot-formats">2.4.2.2. The VASP <code class="docutils literal"><span class="pre">CHGCAR</span></code> and <code class="docutils literal"><span class="pre">LOCPOT</span></code> formats</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="tech_ref_file_formats.html#wavefunction-formats-using-a-gaussian-basis-set">2.4.3. Wavefunction formats (using a Gaussian basis set)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="tech_ref_file_formats.html#the-gaussian-fchk-format">2.4.3.1. The Gaussian <code class="docutils literal"><span class="pre">.fchk</span></code> format</a></li>
<li class="toctree-l4"><a class="reference internal" href="tech_ref_file_formats.html#the-molden-format">2.4.3.2. The <code class="docutils literal"><span class="pre">.molden</span></code> format</a></li>
<li class="toctree-l4"><a class="reference internal" href="tech_ref_file_formats.html#the-mkl-molekel-format">2.4.3.3. The <code class="docutils literal"><span class="pre">.mkl</span></code> (Molekel) format</a></li>
<li class="toctree-l4"><a class="reference internal" href="tech_ref_file_formats.html#the-wfn-format">2.4.3.4. The <code class="docutils literal"><span class="pre">.wfn</span></code> format</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="tech_ref_file_formats.html#hamiltonian-file-formats">2.4.4. Hamiltonian file formats</a><ul>
<li class="toctree-l4"><a class="reference internal" href="tech_ref_file_formats.html#the-molpro-2012-fcidump-format">2.4.4.1. The Molpro 2012 <code class="docutils literal"><span class="pre">FCIDUMP</span></code> format</a></li>
<li class="toctree-l4"><a class="reference internal" href="tech_ref_file_formats.html#the-gaussian-log-file">2.4.4.2. The Gaussian <code class="docutils literal"><span class="pre">.log</span></code> file</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="tech_ref_file_formats.html#horton-s-internal-file-format">2.4.5. HORTON&#8217;s internal file format</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tech_ref_grids.html">2.5. Atomic integration grids</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tech_ref_grids.html#built-in-grids">2.5.1. Built-in grids</a></li>
<li class="toctree-l3"><a class="reference internal" href="tech_ref_grids.html#the-grid-option">2.5.2. The <code class="docutils literal"><span class="pre">--grid</span></code> option</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tech_ref_gaussian_basis.html">2.6. Gaussian basis sets</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tech_ref_gaussian_basis.html#standard-basis-sets">2.6.1. Standard basis sets</a></li>
<li class="toctree-l3"><a class="reference internal" href="tech_ref_gaussian_basis.html#collected-notes-on-gaussian-basis-sets">2.6.2. Collected notes on Gaussian basis sets</a><ul>
<li class="toctree-l4"><a class="reference internal" href="tech_ref_gaussian_basis.html#introduction">2.6.2.1. Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="tech_ref_gaussian_basis.html#cartesian-basis-functions">2.6.2.2. Cartesian basis functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="tech_ref_gaussian_basis.html#pure-or-harmonic-basis-functions">2.6.2.3. Pure or harmonic basis functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="tech_ref_gaussian_basis.html#transformation-from-cartesian-to-pure-basis-functions">2.6.2.4. Transformation from Cartesian to pure basis functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="tech_ref_gaussian_basis.html#recursion-relations-for-real-regular-solid-harmonics">2.6.2.5. Recursion relations for real regular solid harmonics</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tech_ref_functionals.html">2.7. LibXC Functionals</a></li>
<li class="toctree-l2"><a class="reference internal" href="tech_ref_acronyms.html">2.8. Acronyms</a></li>
<li class="toctree-l2"><a class="reference internal" href="tech_ref_dictionary.html">2.9. HORTON dictionary of variables</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tech_ref_dictionary.html#rules">2.9.1. Rules</a></li>
<li class="toctree-l3"><a class="reference internal" href="tech_ref_dictionary.html#variable-names-and-prefixes">2.9.2. Variable names and prefixes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tech_ref_literature.html">2.10. Literature</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tech_api.html">3. API Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="lib/pck_horton.html">3.1. <code class="docutils literal"><span class="pre">horton</span></code> &#8211; The main HORTON Package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_cache.html">3.1.1. <code class="docutils literal"><span class="pre">horton.cache</span></code> &#8211; Avoid recomputation of earlier results and reallocation of existing arrays</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_cext.html">3.1.2. <code class="docutils literal"><span class="pre">horton.cext</span></code> &#8211; C++ extensions</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_constants.html">3.1.3. <code class="docutils literal"><span class="pre">horton.constants</span></code> &#8211; Physicochemical constants in atomic units</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_context.html">3.1.4. <code class="docutils literal"><span class="pre">horton.context</span></code> &#8211; The context in which HORTON is used</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_exceptions.html">3.1.5. <code class="docutils literal"><span class="pre">horton.exceptions</span></code> &#8211; Definition of all excpetions in HORTON</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_log.html">3.1.6. <code class="docutils literal"><span class="pre">horton.log</span></code> &#8211; Screen logging, timing and citation management</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_moments.html">3.1.7. <code class="docutils literal"><span class="pre">horton.moments</span></code> &#8211; Auxiliary routines related to multipole moments</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_orbital_utils.html">3.1.8. <code class="docutils literal"><span class="pre">horton.orbital_utils</span></code> &#8211; Utility functions for orbital modifications</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_periodic.html">3.1.9. <code class="docutils literal"><span class="pre">horton.periodic</span></code> &#8211; Periodic table of elements</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_quadprog.html">3.1.10. <code class="docutils literal"><span class="pre">horton.quadprog</span></code> &#8211; A light-weight quadratic programming solver</a><ul>
<li class="toctree-l4"><a class="reference internal" href="lib/mod_horton_quadprog.html#notation">3.1.10.1. Notation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_symmetry.html">3.1.11. <code class="docutils literal"><span class="pre">horton.symmetry</span></code> &#8211; Geometric symmetries</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_units.html">3.1.12. <code class="docutils literal"><span class="pre">horton.units</span></code> &#8211; Conversion from and to atomic units</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_utils.html">3.1.13. <code class="docutils literal"><span class="pre">horton.utils</span></code> &#8211; Utility functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_cell_h.html">3.1.14. <code class="docutils literal"><span class="pre">horton/cell.h</span></code> &#8211; Unit cell code to specify periodic boundary conditions</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_moments_h.html">3.1.15. <code class="docutils literal"><span class="pre">horton/moments.h</span></code> &#8211; Efficient evaluation of various of polynomials</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_nucpot_h.html">3.1.16. <code class="docutils literal"><span class="pre">horton/nucpot.h</span></code> &#8211; Low-level implementation of nuclear potential on a grid</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="lib/pck_horton_correlatedwfn.html">3.2. <code class="docutils literal"><span class="pre">horton.correlatedwfn</span></code> &#8211; Methods for correlated wavefunctions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_correlatedwfn_geminal.html">3.2.1. <code class="docutils literal"><span class="pre">horton.correlatedwfn.geminal</span></code> &#8211; Correlated wavefunction implementations</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_correlatedwfn_perturbation.html">3.2.2. <code class="docutils literal"><span class="pre">horton.correlatedwfn.perturbation</span></code> &#8211; Perturbation theory module</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_correlatedwfn_restricted_ap1rog.html">3.2.3. <code class="docutils literal"><span class="pre">horton.correlatedwfn.restricted_ap1rog</span></code> &#8211; Correlated wavefunction implementations</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_correlatedwfn_stepsearch.html">3.2.4. <code class="docutils literal"><span class="pre">horton.correlatedwfn.stepsearch</span></code> &#8211; Step search methods for orbital rotations</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_correlatedwfn_trustregionopt.html">3.2.5. <code class="docutils literal"><span class="pre">horton.correlatedwfn.trustregionopt</span></code> &#8211; Optimization of Newton step</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="lib/pck_horton_espfit.html">3.3. <code class="docutils literal"><span class="pre">horton.espfit</span></code> &#8211; Electrostatic potential fitting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_espfit_cext.html">3.3.1. <code class="docutils literal"><span class="pre">horton.espfit.cext</span></code> &#8211; C++ extensions</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_espfit_cost.html">3.3.2. <code class="docutils literal"><span class="pre">horton.espfit.cost</span></code> &#8211; ESP cost functions for estimating and testing charges</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_espfit_electrostatics_h.html">3.3.3. <code class="docutils literal"><span class="pre">horton/espfit/electrostatics.h</span></code> &#8211; Computation of ESP cost functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_espfit_mask_h.html">3.3.4. <code class="docutils literal"><span class="pre">horton/espfit/mask.h</span></code> &#8211; Computation of weights for ESP cost functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="lib/pck_horton_gbasis.html">3.4. <code class="docutils literal"><span class="pre">horton.gbasis</span></code> &#8211; Gaussian basis sets</a><ul>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_gbasis_cext.html">3.4.1. <code class="docutils literal"><span class="pre">horton.gbasis.cext</span></code> &#8211; C++ extensions</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_gbasis_gobasis.html">3.4.2. <code class="docutils literal"><span class="pre">horton.gbasis.gobasis</span></code> &#8211; Gaussian orbital basis set module.</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_gbasis_iobas.html">3.4.3. <code class="docutils literal"><span class="pre">horton.gbasis.iobas</span></code> &#8211; Input/Output routines for gaussian basis sets</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_gbasis_boys_h.html">3.4.4. <code class="docutils literal"><span class="pre">horton/gbasis/boys.h</span></code> &#8211; The Boys function</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_gbasis_calc_h.html">3.4.5. <code class="docutils literal"><span class="pre">horton/gbasis/calc.h</span></code> &#8211; Base class for any integral/evaluation of Gaussian functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_gbasis_cartpure_h.html">3.4.6. <code class="docutils literal"><span class="pre">horton/gbasis/cartpure.h</span></code> &#8211; Conversion of Cartesian to Pure Gaussian functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_gbasis_cholesky_h.html">3.4.7. <code class="docutils literal"><span class="pre">horton/gbasis/cholesky.h</span></code> &#8211; Cholesky decomposition of (any) four-center integrals</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_gbasis_common_h.html">3.4.8. <code class="docutils literal"><span class="pre">horton/gbasis/common.h</span></code> &#8211; Auxiliary functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_gbasis_fns_h.html">3.4.9. <code class="docutils literal"><span class="pre">horton/gbasis/fns.h</span></code> &#8211; Evaluation of functions expanded in a Gaussian basis</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_gbasis_gbasis_h.html">3.4.10. <code class="docutils literal"><span class="pre">horton/gbasis/gbasis.h</span></code> &#8211; Gaussian basis set classes</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_gbasis_gbw_h.html">3.4.11. <code class="docutils literal"><span class="pre">horton/gbasis/gbw.h</span></code> &#8211; A four-center integral wrapper for the Cholesky code</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_gbasis_ints_h.html">3.4.12. <code class="docutils literal"><span class="pre">horton/gbasis/ints.h</span></code> &#8211; Evaluation of integrals of Gaussian basis functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_gbasis_iter_gb_h.html">3.4.13. <code class="docutils literal"><span class="pre">horton/gbasis/iter_gb.h</span></code> &#8211; Iterators over Gaussian basis functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_gbasis_iter_pow_h.html">3.4.14. <code class="docutils literal"><span class="pre">horton/gbasis/iter_pow.h</span></code> &#8211; Iterators over Cartesian polynomials in one shell</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="lib/pck_horton_grid.html">3.5. <code class="docutils literal"><span class="pre">horton.grid</span></code> &#8211; Numerical integration grids</a><ul>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_grid_atgrid.html">3.5.1. <code class="docutils literal"><span class="pre">horton.grid.atgrid</span></code> &#8211; Atomic grids</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_grid_base.html">3.5.2. <code class="docutils literal"><span class="pre">horton.grid.base</span></code> &#8211; Base classes for 3D integration grids</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_grid_cext.html">3.5.3. <code class="docutils literal"><span class="pre">horton.grid.cext</span></code> &#8211; C++ extensions</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_grid_int1d.html">3.5.4. <code class="docutils literal"><span class="pre">horton.grid.int1d</span></code> &#8211; 1D integration algorithms</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_grid_molgrid.html">3.5.5. <code class="docutils literal"><span class="pre">horton.grid.molgrid</span></code> &#8211; Molecular integration grids</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_grid_ode2.html">3.5.6. <code class="docutils literal"><span class="pre">horton.grid.ode2</span></code> &#8211; Finite-element second-order ODE solver</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_grid_poisson.html">3.5.7. <code class="docutils literal"><span class="pre">horton.grid.poisson</span></code> &#8211; Becke-style numerical Poisson solver</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_grid_radial.html">3.5.8. <code class="docutils literal"><span class="pre">horton.grid.radial</span></code> &#8211; 1D Radial integration grid</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_grid_utils.html">3.5.9. <code class="docutils literal"><span class="pre">horton.grid.utils</span></code> &#8211; Auxiliaries for numerical integrals</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_grid_visual.html">3.5.10. <code class="docutils literal"><span class="pre">horton.grid.visual</span></code> &#8211; Grids suitable for visualization</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_grid_becke_h.html">3.5.11. <code class="docutils literal"><span class="pre">horton/grid/becke.h</span></code> &#8211; Becke partitioning weight function</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_grid_cubic_spline_h.html">3.5.12. <code class="docutils literal"><span class="pre">horton/grid/cubic_spline.h</span></code> &#8211; One-dimensional cubic splines (on uniform grids)</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_grid_evaluate_h.html">3.5.13. <code class="docutils literal"><span class="pre">horton/grid/evaluate.h</span></code> &#8211; Evaluation of splines on grids</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_grid_lebedev_laikov_h.html">3.5.14. <code class="docutils literal"><span class="pre">horton/grid/lebedev_laikov.h</span></code> &#8211; Grids for quadrature on a sphere</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_grid_ode2_h.html">3.5.15. <code class="docutils literal"><span class="pre">horton/grid/ode2.h</span></code> &#8211; Second-order finite-element ODE solver using Hermite polynomials</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_grid_rtransform_h.html">3.5.16. <code class="docutils literal"><span class="pre">horton/grid/rtransform.h</span></code> &#8211; Transformation from uniform 1D to non-uniform 1D grids</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_grid_uniform_h.html">3.5.17. <code class="docutils literal"><span class="pre">horton/grid/uniform.h</span></code> &#8211; Uniform 3D grids</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_grid_utils_h.html">3.5.18. <code class="docutils literal"><span class="pre">horton/grid/utils.h</span></code> &#8211; Auxiliary functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="lib/pck_horton_io.html">3.6. <code class="docutils literal"><span class="pre">horton.io</span></code> &#8211; Input and output routines</a><ul>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_io_cif.html">3.6.1. <code class="docutils literal"><span class="pre">horton.io.cif</span></code> &#8211; Crystalographic Information File format</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_io_cp2k.html">3.6.2. <code class="docutils literal"><span class="pre">horton.io.cp2k</span></code> &#8211; CP2K atomic wavefunctions</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_io_cube.html">3.6.3. <code class="docutils literal"><span class="pre">horton.io.cube</span></code> &#8211; Gaussian cube file format</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_io_gaussian.html">3.6.4. <code class="docutils literal"><span class="pre">horton.io.gaussian</span></code> &#8211; Gaussian LOG and FCHK file fromats</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_io_internal.html">3.6.5. <code class="docutils literal"><span class="pre">horton.io.internal</span></code> &#8211; HORTON internal file format</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_io_iodata.html">3.6.6. <code class="docutils literal"><span class="pre">horton.io.iodata</span></code> &#8211; Input/output dispatcher for different file formats</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_io_lockedh5.html">3.6.7. <code class="docutils literal"><span class="pre">horton.io.lockedh5</span></code> &#8211; H5 file with lock</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_io_molden.html">3.6.8. <code class="docutils literal"><span class="pre">horton.io.molden</span></code> &#8211; Molden wavefunction input file format</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_io_molekel.html">3.6.9. <code class="docutils literal"><span class="pre">horton.io.molekel</span></code> &#8211; Molekel wavefunction input file format</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_io_molpro.html">3.6.10. <code class="docutils literal"><span class="pre">horton.io.molpro</span></code> &#8211; Molpro 2012 FCIDUMP format.</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_io_vasp.html">3.6.11. <code class="docutils literal"><span class="pre">horton.io.vasp</span></code> &#8211; VASP POSCAR, CHGCAR and POTCAR file formats</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_io_wfn.html">3.6.12. <code class="docutils literal"><span class="pre">horton.io.wfn</span></code> &#8211; WFN File format (Gaussian and GAMESS)</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_io_xyz.html">3.6.13. <code class="docutils literal"><span class="pre">horton.io.xyz</span></code> &#8211; XYZ file format</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="lib/pck_horton_localization.html">3.7. <code class="docutils literal"><span class="pre">horton.localization</span></code> &#8211; Methods for orbital localization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_localization_localization.html">3.7.1. <code class="docutils literal"><span class="pre">horton.localization.localization</span></code> &#8211; Orbital localization procedures</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="lib/pck_horton_matrix.html">3.8. <code class="docutils literal"><span class="pre">horton.matrix</span></code> &#8211; One-, two-, three- and four-dimensional matrix implementations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_matrix_base.html">3.8.1. <code class="docutils literal"><span class="pre">horton.matrix.base</span></code> &#8211; Base classes</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_matrix_cext.html">3.8.2. <code class="docutils literal"><span class="pre">horton.matrix.cext</span></code> &#8211; C++ extensions for matrix package</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_matrix_cholesky.html">3.8.3. <code class="docutils literal"><span class="pre">horton.matrix.cholesky</span></code> &#8211; Cholesky decomposition of four-index objects</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_matrix_dense.html">3.8.4. <code class="docutils literal"><span class="pre">horton.matrix.dense</span></code> &#8211; Dense matrix implementations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="lib/mod_horton_matrix_dense.html#naming-scheme-for-the-contract-slice-or-expand-methods">3.8.4.1. Naming scheme for the contract, slice or expand methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="lib/mod_horton_matrix_dense.html#handling-of-index-symmetry">3.8.4.2. Handling of index symmetry</a></li>
<li class="toctree-l4"><a class="reference internal" href="lib/mod_horton_matrix_dense.html#dense-matrix-classes">3.8.4.3. Dense matrix classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_matrix_slicing_h.html">3.8.5. <code class="docutils literal"><span class="pre">horton/matrix/slicing.h</span></code> &#8211; Low-level routines for <code class="docutils literal"><span class="pre">CholeskyLinalgFactory</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="lib/pck_horton_meanfield.html">3.9. <code class="docutils literal"><span class="pre">horton.meanfield</span></code> &#8211; Mean-field electronic structure code</a><ul>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_meanfield_bond_order.html">3.9.1. <code class="docutils literal"><span class="pre">horton.meanfield.bond_order</span></code> &#8211; Generic implementation of bond orders for mean-field wavefunctions</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_meanfield_builtin.html">3.9.2. <code class="docutils literal"><span class="pre">horton.meanfield.builtin</span></code> &#8211; Built-in energy terms</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_meanfield_cext.html">3.9.3. <code class="docutils literal"><span class="pre">horton.meanfield.cext</span></code> &#8211; C++ extensions</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_meanfield_convergence.html">3.9.4. <code class="docutils literal"><span class="pre">horton.meanfield.convergence</span></code> &#8211; Evaluation of convergence criteria</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_meanfield_gridgroup.html">3.9.5. <code class="docutils literal"><span class="pre">horton.meanfield.gridgroup</span></code> &#8211; Container for observables involving numerical integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_meanfield_guess.html">3.9.6. <code class="docutils literal"><span class="pre">horton.meanfield.guess</span></code> &#8211; Initial guesses for wavefunctions</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_meanfield_hamiltonian.html">3.9.7. <code class="docutils literal"><span class="pre">horton.meanfield.hamiltonian</span></code> &#8211; Mean-field DFT/HF Hamiltonian data structures</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_meanfield_libxc.html">3.9.8. <code class="docutils literal"><span class="pre">horton.meanfield.libxc</span></code> &#8211; Interface to LDA, GGA and hybrid functionals from LibXC</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_meanfield_observable.html">3.9.9. <code class="docutils literal"><span class="pre">horton.meanfield.observable</span></code> &#8211; Base classes for energy terms and other observables of the wavefunction</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_meanfield_occ.html">3.9.10. <code class="docutils literal"><span class="pre">horton.meanfield.occ</span></code> &#8211; Occupation number models</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_meanfield_project.html">3.9.11. <code class="docutils literal"><span class="pre">horton.meanfield.project</span></code> &#8211; Projection of 1-electron orbitals to a new basis set</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_meanfield_response.html">3.9.12. <code class="docutils literal"><span class="pre">horton.meanfield.response</span></code> &#8211; Evaluation of response functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_meanfield_rotate.html">3.9.13. <code class="docutils literal"><span class="pre">horton.meanfield.rotate</span></code> &#8211; Rotation of orbitals</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_meanfield_scf.html">3.9.14. <code class="docutils literal"><span class="pre">horton.meanfield.scf</span></code> &#8211; Basic Self-Consistent Field (SCF) algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_meanfield_scf_cdiis.html">3.9.15. <code class="docutils literal"><span class="pre">horton.meanfield.scf_cdiis</span></code> &#8211; Commutator DIIS SCF algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_meanfield_scf_diis.html">3.9.16. <code class="docutils literal"><span class="pre">horton.meanfield.scf_diis</span></code> &#8211; Abstract DIIS code used by the different DIIS implementations</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_meanfield_scf_ediis.html">3.9.17. <code class="docutils literal"><span class="pre">horton.meanfield.scf_ediis</span></code> &#8211; Energy DIIS SCF algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_meanfield_scf_ediis2.html">3.9.18. <code class="docutils literal"><span class="pre">horton.meanfield.scf_ediis2</span></code> &#8211; EDIIS+DIIS SCF algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_meanfield_scf_oda.html">3.9.19. <code class="docutils literal"><span class="pre">horton.meanfield.scf_oda</span></code> &#8211; Optimal Damping SCF algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_meanfield_utils.html">3.9.20. <code class="docutils literal"><span class="pre">horton.meanfield.utils</span></code> &#8211; Utility functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="lib/pck_horton_modelhamiltonians.html">3.10. <code class="docutils literal"><span class="pre">horton.modelhamiltonians</span></code> &#8211; Model Hamiltonians</a><ul>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_modelhamiltonians_physmodham.html">3.10.1. <code class="docutils literal"><span class="pre">horton.modelhamiltonians.physmodham</span></code> &#8211; Physical Model Hamiltonian</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="lib/pck_horton_orbital_entanglement.html">3.11. <code class="docutils literal"><span class="pre">horton.orbital_entanglement</span></code> &#8211; Methods for measuring orbital entanglement</a><ul>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_orbital_entanglement_orbital_entanglement.html">3.11.1. <code class="docutils literal"><span class="pre">horton.orbital_entanglement.orbital_entanglement</span></code> &#8211; One- and two-orbital entanglement measures</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="lib/pck_horton_part.html">3.12. <code class="docutils literal"><span class="pre">horton.part</span></code> &#8211; Density-based partitioning (fuzzy atoms-in-molecules) package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_part_base.html">3.12.1. <code class="docutils literal"><span class="pre">horton.part.base</span></code> &#8211; Base classes for (atoms-in-molecules) partitioning algorithms</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_part_becke.html">3.12.2. <code class="docutils literal"><span class="pre">horton.part.becke</span></code> &#8211; Becke partitioning</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_part_hirshfeld.html">3.12.3. <code class="docutils literal"><span class="pre">horton.part.hirshfeld</span></code> &#8211; Hirshfeld partitioning</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_part_hirshfeld_e.html">3.12.4. <code class="docutils literal"><span class="pre">horton.part.hirshfeld_e</span></code> &#8211; Extended Hirshfeld (HE) partitioning</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_part_hirshfeld_i.html">3.12.5. <code class="docutils literal"><span class="pre">horton.part.hirshfeld_i</span></code> &#8211; Iterative Hirshfeld (HI) partitioning</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_part_iterstock.html">3.12.6. <code class="docutils literal"><span class="pre">horton.part.iterstock</span></code> &#8211; Iterative Stockholder Analysis (ISA) partitioning</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_part_mbis.html">3.12.7. <code class="docutils literal"><span class="pre">horton.part.mbis</span></code> &#8211; Minimal Basis Iterative Stockholder (MBIS) partitioning</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_part_mulliken.html">3.12.8. <code class="docutils literal"><span class="pre">horton.part.mulliken</span></code> &#8211; Mulliken partitioning</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_part_proatomdb.html">3.12.9. <code class="docutils literal"><span class="pre">horton.part.proatomdb</span></code> &#8211; Pro-atom databases</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_part_stockholder.html">3.12.10. <code class="docutils literal"><span class="pre">horton.part.stockholder</span></code> &#8211; Base classes for all stockholder partitioning schemes</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_part_symmetry.html">3.12.11. <code class="docutils literal"><span class="pre">horton.part.symmetry</span></code> &#8211; Symmetry analysis of atoms-in-molecules results</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="lib/pck_horton_scripts.html">3.13. <code class="docutils literal"><span class="pre">horton.scripts</span></code> &#8211; Code (solely) used by HORTON&#8217;s command line scripts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_scripts_atomdb.html">3.13.1. <code class="docutils literal"><span class="pre">horton.scripts.atomdb</span></code> &#8211; Code used by <code class="docutils literal"><span class="pre">horton-atomdb.py</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_scripts_common.html">3.13.2. <code class="docutils literal"><span class="pre">horton.scripts.common</span></code> &#8211; Code shared by several scripts</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_scripts_cpart.html">3.13.3. <code class="docutils literal"><span class="pre">horton.scripts.cpart</span></code> &#8211; Utility functions for the <code class="docutils literal"><span class="pre">horton-cpart.py</span></code> script</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_scripts_espfit.html">3.13.4. <code class="docutils literal"><span class="pre">horton.scripts.espfit</span></code> &#8211; Code used by ESP fitting scripts</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_scripts_hdf2csv.html">3.13.5. <code class="docutils literal"><span class="pre">horton.scripts.hdf2csv</span></code> &#8211; Code used by <code class="docutils literal"><span class="pre">horton-hdf2csv.py</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/mod_horton_scripts_wpart.html">3.13.6. <code class="docutils literal"><span class="pre">horton.scripts.wpart</span></code> &#8211; Utility functions for the <code class="docutils literal"><span class="pre">horton-wpart.py</span></code> script</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">HORTON</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
          <li><a href="user_postproc.html">5. Post-processing</a> &raquo;</li>
      
    <li>5.1. Atoms-in-Molecules (AIM) analysis</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/user_postproc_aim.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="atoms-in-molecules-aim-analysis">
<h1>5.1. Atoms-in-Molecules (AIM) analysis<a class="headerlink" href="#atoms-in-molecules-aim-analysis" title="Permalink to this headline"></a></h1>
<div class="section" id="introduction">
<h2>5.1.1. Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline"></a></h2>
<p>HORTON supports several real-space atoms-in-molecules (AIM) partitioning schemes. For this purpose, a
wavefunction or an electron density on a grid can be loaded from several file
formats. An overview of all supported file formats can be found here:
<a class="reference internal" href="tech_ref_file_formats.html#ref-file-formats"><span>Data file formats (input and output)</span></a>. For a given wavefunction or cube file, several AIM partitioning
schemes can be used to derive AIM observables, e.g. atomic charge, atomic
multipole expansion, etc.</p>
<p>HORTON supports two different approaches to perform the partitioning: WPart
(based on wavefunction files) and CPart (based on cube files). The WPart and
CPart implementations are built on the same algorithms but use different types of
grids for numerical integration. An overview of both implementations is given by
the following table:</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="26%" />
<col width="26%" />
<col width="24%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Feature</th>
<th class="head">WPart</th>
<th class="head">CPart</th>
<th class="head">References</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Command-line script</td>
<td><code class="docutils literal"><span class="pre">horton-wpart.py</span></code></td>
<td><code class="docutils literal"><span class="pre">horton-cpart.py</span></code></td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><strong>Boundary conditions</strong></td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>0D</td>
<td>X</td>
<td>X</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>1D</td>
<td>&nbsp;</td>
<td>X</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>2D</td>
<td>&nbsp;</td>
<td>X</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>3D</td>
<td>&nbsp;</td>
<td>X</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><strong>AIM schemes</strong></td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>Becke</td>
<td>X</td>
<td>&nbsp;</td>
<td><a class="reference internal" href="tech_ref_literature.html#becke1988-multicenter" id="id1">[becke1988_multicenter]</a></td>
</tr>
<tr class="row-even"><td>Hirshfeld</td>
<td>X</td>
<td>X</td>
<td><a class="reference internal" href="tech_ref_literature.html#hirshfeld1977" id="id2">[hirshfeld1977]</a></td>
</tr>
<tr class="row-odd"><td>Iterative Hirshfeld</td>
<td>X</td>
<td>X</td>
<td><a class="reference internal" href="tech_ref_literature.html#bultinck2007" id="id3">[bultinck2007]</a></td>
</tr>
<tr class="row-even"><td>Iterative Stockholder</td>
<td>X</td>
<td>&nbsp;</td>
<td><a class="reference internal" href="tech_ref_literature.html#lillestolen2008" id="id4">[lillestolen2008]</a></td>
</tr>
<tr class="row-odd"><td>Extended Hirshfeld</td>
<td>X</td>
<td>X</td>
<td><a class="reference internal" href="tech_ref_literature.html#verstraelen2013" id="id5">[verstraelen2013]</a></td>
</tr>
<tr class="row-even"><td><strong>AIM properties</strong></td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>Charges</td>
<td>X</td>
<td>X</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>Spin charges</td>
<td>X</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>Cartesian multipoles</td>
<td>X</td>
<td>X</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>Pure/harmonic multipoles</td>
<td>X</td>
<td>X</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>Radial moments</td>
<td>X</td>
<td>X</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>Dispersion coefficients</td>
<td>X</td>
<td>X</td>
<td><a class="reference internal" href="tech_ref_literature.html#tkatchenko2009" id="id6">[tkatchenko2009]</a></td>
</tr>
<tr class="row-odd"><td>Spherical decomposition</td>
<td>X</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>ESP due to each AIM</td>
<td>X</td>
<td>&nbsp;</td>
<td><a class="reference internal" href="tech_ref_literature.html#becke1988-poisson" id="id7">[becke1988_poisson]</a></td>
</tr>
<tr class="row-odd"><td>ESP due to pro-atom</td>
<td>X</td>
<td>X</td>
<td><a class="reference internal" href="tech_ref_literature.html#becke1988-poisson" id="id8">[becke1988_poisson]</a></td>
</tr>
<tr class="row-even"><td>Wiberg bond order</td>
<td>X</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>Kohn-Sham response</td>
<td>X</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><strong>Extra options</strong></td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>Symmetry analysis</td>
<td>&nbsp;</td>
<td>X</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
<p>Note that Gaussian cube files can be generated from other programs like CPMD,
ADF, Siesta, Crystal, etc. The output of all these programs should be compatible
with HORTON. Moreover, both all-electron and pseudo-potential
wavefunctions can be partitioned with HORTON. However, very fine grids are required for all-electron
partitioning with CPart.</p>
<p>For almost all the Hirshfeld variants, you must first set up a pro-atom database
densities, preferably at the same level of theory used for the molecular
computation. The <code class="docutils literal"><span class="pre">horton-atomdb.py</span></code> script facilitates setting up such a
database.</p>
<p>All of the outputs generated by HORTON are written to <a class="reference external" href="http://www.hdfgroup.org/HDF5/">HDF5</a> files (with extension <code class="docutils literal"><span class="pre">.h5</span></code>). These are
binary (compact) platform-independent files that can be post-processed easily
with Python scripts. The <code class="docutils literal"><span class="pre">horton-hdf2csv.py</span></code> script can be used to convert
(part of) an HDF5 file into the &#8220;comma-separated value&#8221; (CSV) format, which is
supported by most spreadsheet software.</p>
<p>The usage of the four scripts (<code class="docutils literal"><span class="pre">horton-atomdb.py</span></code>, <code class="docutils literal"><span class="pre">horton-wpart.py</span></code>,
<code class="docutils literal"><span class="pre">horton-cpart.py</span></code> and <code class="docutils literal"><span class="pre">horton-hdf2csv.py</span></code>) will be discussed in <a class="reference internal" href="#atomdb"><span>horton-atomdb.py &#8211; Build a pro-atom database</span></a>,
<a class="reference internal" href="#wpart"><span>horton-wpart.py &#8211; AIM analysis based on a wavefunction file</span></a>, <a class="reference internal" href="#cpart"><span>horton-cpart.py &#8211; AIM analysis based on a cube file</span></a>, and <a class="reference internal" href="user_other_conversion.html#hdf2csv"><span>horton-hdf2csv.py &#8211; Conversion of HDF5 files to CSV format</span></a>, respectively. All scripts have
a <code class="docutils literal"><span class="pre">--help</span></code> flag that prints out their complete list of command-line arguments. The penultimate
section, <a class="reference internal" href="#partition"><span>Python interface to the partitioning code</span></a>, shows how to use the partitioning code through the
Python interface. The last section, <a class="reference internal" href="#faq"><span>Frequently asked questions</span></a>, answers some frequently asked
questions regarding AIM partitioning with HORTON.</p>
</div>
<div class="section" id="horton-atomdb-py-build-a-pro-atom-database">
<span id="atomdb"></span><h2>5.1.2. <code class="docutils literal"><span class="pre">horton-atomdb.py</span></code> &#8211; Build a pro-atom database<a class="headerlink" href="#horton-atomdb-py-build-a-pro-atom-database" title="Permalink to this headline"></a></h2>
<p>The <code class="docutils literal"><span class="pre">horton-atomdb.py</span></code> script should be used in three steps to build a pro-atom database:</p>
<ol class="arabic">
<li><p class="first"><strong>Generate input files</strong> for isolated atom computations using one of the
following programs: Gaussian03/09, Orca, PSI4 or CP2K. The following example
generates Gaussian09 input files for hydrogen, carbon, nitrogen and oxygen:</p>
<div class="highlight-python"><div class="highlight"><pre>horton-atomdb.py input g09 1,6-8 template.com
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">template.com</span></code> file is used to generate the input files and will
be discussed in detail below. A series of directories is created with input
files for the atomic computations, like <code class="docutils literal"><span class="pre">001__h_001_q+00</span></code>, <code class="docutils literal"><span class="pre">001__h_002_q-01</span></code>,
<code class="docutils literal"><span class="pre">001__h_003_q-02</span></code>, etc. Optional arguments can be used to control the range
of cations and anions, the spin multiplicities, etc. Also a
<code class="docutils literal"><span class="pre">run_g09.sh</span></code> script is generated to take care of the next step.</p>
<p>Run the command below to obtain a complete list of all arguments:</p>
<div class="highlight-bash"><div class="highlight"><pre>horton-atomdb.py input --help
</pre></div>
</div>
</li>
<li><p class="first"><strong>Run the atomic computations</strong> by executing the <code class="docutils literal"><span class="pre">run_PROGRAM.sh</span></code> script.
In this case:</p>
<div class="highlight-python"><div class="highlight"><pre>./run_g09.sh
</pre></div>
</div>
<p>Note that the <code class="docutils literal"><span class="pre">run_PROGRAM.sh</span></code> scripts assume a default installation of
the corresponding software. In the case of non-standard installations or
when special calls or environment variables are needed, you must modify this
script first. (It will not be overwritten when <code class="docutils literal"><span class="pre">horton-atomdb.py</span> <span class="pre">input</span> <span class="pre">...</span></code>
is executed again.)</p>
</li>
<li><p class="first"><strong>Convert the output files</strong> of the external programs into a database of
spherically averaged pro-atom densities (<code class="docutils literal"><span class="pre">atoms.h5</span></code>). Just run:</p>
<div class="highlight-python"><div class="highlight"><pre>./horton-atomdb.py convert
</pre></div>
</div>
<p>This script also generates figures of the radial densities and Fukui
functions, if <code class="docutils literal"><span class="pre">matplotlib</span></code> is installed. In this step, you may use
<a class="reference internal" href="tech_ref_grids.html#ref-grid-option"><span>the &#8211; grid option</span></a>, although the default setting
should be fine for nearly all cases.</p>
</li>
</ol>
<p>If you remove some directories for atomic computations before or after
executing the <code class="docutils literal"><span class="pre">run_PROGRAM.sh</span></code> script, the corresponding atoms will not be
included in the database. Similarly, you may rerun <code class="docutils literal"><span class="pre">horton-atomdb.py</span> <span class="pre">input</span> <span class="pre">...</span></code>
to generate more input files. In that case <code class="docutils literal"><span class="pre">run_PROGRAM.sh</span></code> will only consider
the atomic computations that have not been completed yet. In some cases, the
<code class="docutils literal"><span class="pre">run_PROGRAM.sh</span></code> script needs to be customized, e.g. you may want to use
<code class="docutils literal"><span class="pre">mpirun</span></code> to run the atomic computations in parallel. When such modifications
are made, subsequent runs of <code class="docutils literal"><span class="pre">horton-atomdb.py</span> <span class="pre">input</span> <span class="pre">...</span></code> will not overwrite
the <code class="docutils literal"><span class="pre">run_PROGRAM.sh</span></code> script.</p>
<div class="section" id="template-files">
<h3>5.1.2.1. Template files<a class="headerlink" href="#template-files" title="Permalink to this headline"></a></h3>
<p>A template file is simply an input file for an atomic computation, where the
distinguishing parameters (element, charge, ...) are replaced with keys that are
recognized by the input generator of <code class="docutils literal"><span class="pre">horton-atomdb.py</span></code>. These keys are:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">${element}</span></code>: The element symbol of the atom.</li>
<li><code class="docutils literal"><span class="pre">${number}</span></code>: The atomic number of the atom.</li>
<li><code class="docutils literal"><span class="pre">${charge}</span></code>: The charge of the atom (or cation, or anion).</li>
<li><code class="docutils literal"><span class="pre">${mult}</span></code>: The spin multiplicity of the atom.</li>
</ul>
<p>For more advanced cases, you may include (parts of) other files with generic
keys, e.g. for basis sets that are different for every element:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">${file:filename}</span></code>: This is replaced by the contents of
<code class="docutils literal"><span class="pre">filename.NNN_PPP_MM</span></code>, where <code class="docutils literal"><span class="pre">NNN</span></code> is the atomic number, <code class="docutils literal"><span class="pre">PPP</span></code> is the
atomic population and <code class="docutils literal"><span class="pre">MM</span></code> is the spin multiplicity. These numbers are
left-padded with zeros to fix the the length. If a field in the filename is
zero, it is considered as a wild card. For example, you may use
<code class="docutils literal"><span class="pre">${file:basis}</span></code> in the template file and store a basis set specification for
oxygen in the file <code class="docutils literal"><span class="pre">basis.008_000_00</span></code>. The basis contained in this file will be
used for all cations, anions, and multiplicities of oxygen, because the
zeros in the file name act as a wildcard.</li>
<li><code class="docutils literal"><span class="pre">${line:filename}</span></code>: This is comparable to the previous key, except that all
replacements are stored in one file. Each (non-empty) line in this file that
starts with <code class="docutils literal"><span class="pre">NNN_PPP_MM</span></code> has a string that will be filled into the field of
the file that corresponds to the specified <code class="docutils literal"><span class="pre">NNN_PPP_MM</span></code>.</li>
</ul>
<p>None of the keys are mandatory, although <code class="docutils literal"><span class="pre">${element}</span></code> (or <code class="docutils literal"><span class="pre">${number}</span></code>),
<code class="docutils literal"><span class="pre">${charge}</span></code> and <code class="docutils literal"><span class="pre">${mult}</span></code> must be present to obtain sensible results.</p>
</div>
<div class="section" id="basic-template-file-for-gaussian-03-09">
<h3>5.1.2.2. Basic template file for Gaussian 03/09<a class="headerlink" href="#basic-template-file-for-gaussian-03-09" title="Permalink to this headline"></a></h3>
<p>This is a simple template file for atomic computations at the HF/3-21G level:</p>
<div class="highlight-python"><div class="highlight"><pre>%chk=atom.chk
#p HF/3-21G scf(xqc)

A random title line

${charge} ${mult}
${element} 0.0 0.0 0.0
</pre></div>
</div>
<p>Do not forget to include an empty line at the end. Otherwise, Gaussian will
complain. The first line <code class="docutils literal"><span class="pre">%chk=atom.chk</span></code> is required to write the atomic
wavefunction to a file that is needed in the <code class="docutils literal"><span class="pre">convert</span></code> step of
the <code class="docutils literal"><span class="pre">horton-atomdb.py</span></code> script.</p>
</div>
<div class="section" id="advanced-template-file-for-gaussian-03-09">
<h3>5.1.2.3. Advanced template file for Gaussian 03/09<a class="headerlink" href="#advanced-template-file-for-gaussian-03-09" title="Permalink to this headline"></a></h3>
<p>When custom basis sets are specified with the <code class="docutils literal"><span class="pre">Gen</span></code> keyword in Gaussian, you
have to use keys that include other files. For a database containing H, C and O, you
could use the following template:</p>
<ul>
<li><p class="first"><code class="docutils literal"><span class="pre">template.com</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre>%chk=atom.chk
#p PBE1PBE/Gen scf(xqc)

A random title line

${charge} ${mult}
${element} 0.0 0.0 0.0

${file:basis}
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">basis.001_000_00</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre>H 0
6-31G(d,p)
****
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">basis.006_000_00</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre>C 0
6-31G(d,p)
****
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">basis.008_000_00</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre>O     0
S   6   1.00
   8588.5000000              0.00189515
   1297.2300000              0.0143859
    299.2960000              0.0707320
     87.3771000              0.2400010
     25.6789000              0.5947970
      3.7400400              0.2808020
SP   3   1.00
     42.1175000              0.1138890              0.0365114
      9.6283700              0.9208110              0.2371530
      2.8533200             -0.00327447             0.8197020
SP   1   1.00
      0.9056610              1.0000000              1.0000000
SP   1   1.00
      0.2556110              1.0000000              1.0000000
SP   1   1.00
      0.0845000              1.0000000              1.0000000
D   1   1.00
      5.1600000              1.0000000
D   1   1.00
      1.2920000              1.0000000
D   1   1.00
      0.3225000              1.0000000
F   1   1.00
      1.4000000              1.0000000
****
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="simple-template-file-for-orca">
<h3>5.1.2.4. Simple template file for ORCA<a class="headerlink" href="#simple-template-file-for-orca" title="Permalink to this headline"></a></h3>
<p>The following template file uses the built-in <code class="docutils literal"><span class="pre">cc_pVQZ</span></code> basis set of ORCA:</p>
<div class="highlight-python"><div class="highlight"><pre>!HF TightSCF

%basis
  Basis cc_pVQZ
end

*xyz ${charge} ${mult}
${element} 0.0 0.0 0.0
*
</pre></div>
</div>
</div>
<div class="section" id="template-file-for-cp2k">
<h3>5.1.2.5. Template file for CP2K<a class="headerlink" href="#template-file-for-cp2k" title="Permalink to this headline"></a></h3>
<p>You must use <code class="docutils literal"><span class="pre">CP2K</span></code> version 2.4-r12857 (or newer). The computation of pro-atoms
with <code class="docutils literal"><span class="pre">CP2K</span></code> is more involved because you have to specify the occupation
of each subshell. The <code class="docutils literal"><span class="pre">ATOM</span></code> program of <code class="docutils literal"><span class="pre">CP2K</span></code> does not simply follow the
Aufbau rule to assign orbital occupations. At this moment, only the computation of
atomic densities with contracted basis sets and pseudopotentials are supported.</p>
<p>The following example can be used to generate a pro-atom database with the
elements, O, Na, Al and Si, using the GTH pseudopotential and the MolOpt basis
set.</p>
<ul>
<li><p class="first"><code class="docutils literal"><span class="pre">template.inp</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre>&amp;GLOBAL
  PROJECT ATOM
  PROGRAM_NAME ATOM
&amp;END GLOBAL
&amp;ATOM
  ATOMIC_NUMBER ${number}
  ELECTRON_CONFIGURATION (${mult}) CORE ${line:valence.inc}
  CORE none

  MAX_ANGULAR_MOMENTUM 1
  &amp;METHOD
     METHOD_TYPE UKS
     &amp;XC
       &amp;XC_FUNCTIONAL PBE
       &amp;END XC_FUNCTIONAL
     &amp;END XC
  &amp;END METHOD
  &amp;POTENTIAL
      PSEUDO_TYPE GTH
      POTENTIAL_FILE_NAME ../../PBE_PSEUDOPOTENTIALS
      POTENTIAL_NAME ${line:ppot.inc}
  &amp;END POTENTIAL
  &amp;PP_BASIS
      BASIS_SET_FILE_NAME ../../BASIS_MOLOPT
      BASIS_TYPE CONTRACTED_GTO
      BASIS_SET DZVP-MOLOPT-SR-GTH
  &amp;END PP_BASIS
  &amp;PRINT
    &amp;BASIS_SET ON
    &amp;END
    &amp;ORBITALS ON
    &amp;END
    &amp;POTENTIAL ON
    &amp;END
  &amp;END
&amp;END ATOM
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">ppot.inc</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre>008_000_00 GTH-PBE-q6
011_000_00 GTH-PBE-q9
013_000_00 GTH-PBE-q3
014_000_00 GTH-PBE-q4
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">valence.inc</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre>008_005_02 1s2 2p1
008_006_03 1s2 2p2
008_007_04 1s2 2p3
008_008_03 1s2 2p4
008_009_02 1s2 2p5
008_010_01 1s2 2p6

011_005_02 1s2 2p1
011_006_03 1s2 2p2
011_007_04 1s2 2p3
011_008_03 1s2 2p4
011_009_02 1s2 2p5
011_010_01 1s2 2p6
011_011_02 1s2 2p6 2s1
011_012_01 1s2 2p6 2s2
011_013_02 1s2 2p6 2s2 3p1

013_011_02 1s1
013_012_01 1s2
013_013_02 1s2 2p1
013_014_03 1s2 2p2

014_011_02 1s1
014_012_01 1s2
014_013_02 1s2 2p1
014_014_03 1s2 2p2
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="simple-template-file-for-psi4">
<h3>5.1.2.6. Simple template file for PSI4<a class="headerlink" href="#simple-template-file-for-psi4" title="Permalink to this headline"></a></h3>
<p>The following template file uses the BLYP functional and the built-in
<code class="docutils literal"><span class="pre">cc-pvdz</span></code> basis set of PSI4:</p>
<div class="highlight-python"><div class="highlight"><pre>molecule {
 ${charge} ${mult}
 ${element} 0.0 0.0 0.0
}

set {
 basis cc-pvdz
 scf_type df
 guess sad
 molden_write true
 reference uhf
}

energy(&#39;blyp&#39;)
</pre></div>
</div>
<p>Note that the flags <code class="docutils literal"><span class="pre">molden_write</span> <span class="pre">true</span></code> and <code class="docutils literal"><span class="pre">reference</span> <span class="pre">uhf</span></code> are required.
The former instructs the SCF program to write the orbitals, which HORTON picks
up to compute atomic densities. The latter is needed because, usually, most of the
atomic computations are on open-shell systems. Because PSI4 only writes Molden
files for SCF computations, it is not possible to prepare atomic densities with
other levels of theory with PSI4.</p>
</div>
</div>
<div class="section" id="horton-wpart-py-aim-analysis-based-on-a-wavefunction-file">
<span id="wpart"></span><h2>5.1.3. <code class="docutils literal"><span class="pre">horton-wpart.py</span></code> &#8211; AIM analysis based on a wavefunction file<a class="headerlink" href="#horton-wpart-py-aim-analysis-based-on-a-wavefunction-file" title="Permalink to this headline"></a></h2>
<p>The basic usage of <code class="docutils literal"><span class="pre">horton-wpart.py</span></code> is as follows:</p>
<div class="highlight-python"><div class="highlight"><pre>horton-wpart.py wfn output.h5[:group] {b,h,hi,is,he} [atoms.h5]
</pre></div>
</div>
<p>This script has four important arguments:</p>
<ol class="arabic">
<li><p class="first">The <code class="docutils literal"><span class="pre">wfn</span></code> argument is the wave-function file, like a Gaussian03 or 09 formatted checkpoint file, a
Molekel file or a Molden input file.</p>
</li>
<li><p class="first">The output file (HDF5 format) in which the partitioning results are written.
Usually, the output file has the
<code class="docutils literal"><span class="pre">.h5</span></code> extension. The output file is optionally followed by a colon and a group
suffix. This suffix can be used to specify a group in the HDF5 output file
where the output is to be stored.</p>
</li>
<li><p class="first">The third argument refers to the partitioning scheme:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">b</span></code>: Becke partitioning. <a class="reference internal" href="tech_ref_literature.html#becke1988-multicenter" id="id9">[becke1988_multicenter]</a></li>
<li><code class="docutils literal"><span class="pre">h</span></code>: Hirshfeld partitioning. <a class="reference internal" href="tech_ref_literature.html#hirshfeld1977" id="id10">[hirshfeld1977]</a></li>
<li><code class="docutils literal"><span class="pre">hi</span></code>: Iterative Hirshfeld partitioning. <a class="reference internal" href="tech_ref_literature.html#bultinck2007" id="id11">[bultinck2007]</a></li>
<li><code class="docutils literal"><span class="pre">is</span></code>: Iterative Stockholder partitioning. <a class="reference internal" href="tech_ref_literature.html#lillestolen2008" id="id12">[lillestolen2008]</a></li>
<li><code class="docutils literal"><span class="pre">he</span></code>: Extended Hirshfeld partitioning. <a class="reference internal" href="tech_ref_literature.html#verstraelen2013" id="id13">[verstraelen2013]</a></li>
</ul>
</div></blockquote>
</li>
<li><p class="first">The <code class="docutils literal"><span class="pre">atoms.h5</span></code> argument is only needed for the Hirshfeld variants, not for
<code class="docutils literal"><span class="pre">b</span></code> and <code class="docutils literal"><span class="pre">is</span></code>. The file <code class="docutils literal"><span class="pre">atoms.h5</span></code> contains a database of pro-atoms and
can be generated as explained in <a class="reference internal" href="#atomdb"><span>horton-atomdb.py &#8211; Build a pro-atom database</span></a>.</p>
</li>
</ol>
<p>This script computes atomic weight functions, and derives all AIM
observables that are implemented for that scheme. These results are stored in
the specified HDF5 output file.</p>
<p>An elaborate description of all command-line arguments can be obtained from:</p>
<div class="highlight-bash"><div class="highlight"><pre>horton-wpart.py --help
</pre></div>
</div>
<p>The integration grid can be tuned with <a class="reference internal" href="tech_ref_grids.html#ref-grid-option"><span>The &#8211;grid option</span></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When a post-Hartree-Fock (post-HF) level is used in Gaussian 03/09 (MP2, MP3, CC or
CI), you must add the keyword <code class="docutils literal"><span class="pre">Density=current</span></code> to the route section in the
Gaussian input file. This is needed to have the corresponding density matrix
in the formatted checkpoint file. When such a post-HF density matrix is
present, HORTON will load that density matrix instead of the SCF density
matrix. Also note that for some levels of theory, no 1RDM is constructed,
including MP4, MP5, ZINDO and QCISD(T).</p>
</div>
</div>
<div class="section" id="horton-cpart-py-aim-analysis-based-on-a-cube-file">
<span id="cpart"></span><h2>5.1.4. <code class="docutils literal"><span class="pre">horton-cpart.py</span></code> &#8211; AIM analysis based on a cube file<a class="headerlink" href="#horton-cpart-py-aim-analysis-based-on-a-cube-file" title="Permalink to this headline"></a></h2>
<p>The basic usage of <code class="docutils literal"><span class="pre">horton-cpart.py</span></code> is as follows:</p>
<div class="highlight-bash"><div class="highlight"><pre>horton-cpart.py cube output.h5:group <span class="o">{</span>h,hi,he<span class="o">}</span> atoms.h5
</pre></div>
</div>
<p>The script takes three arguments:</p>
<ol class="arabic">
<li><p class="first">The <code class="docutils literal"><span class="pre">cube</span></code> argument can be a Gaussian cube file (possibly generated with
another program, e.g. CP2K). Some information must be added to the cube file
about the effective core charges that were used. This information is needed
to compute the correct net charges. (This is not only relevant for the final
output, but also for constructing the proper pro-atoms. When these numbers
are not set correctly, you&#8217;ll get garbage output.)</p>
<p>For example, given an original cube file with the following header:</p>
<div class="highlight-python"><div class="highlight"><pre>-Quickstep-
 ELECTRON DENSITY
   18    0.000000    0.000000    0.000000
   54    0.183933    0.000000    0.000000
   75    0.000000    0.187713    0.000000
   81    0.000000    0.000000    0.190349
    8    0.000000    0.000000    3.677294    0.000000
    8    0.000000    4.966200   10.401166    0.000000
    8    0.000000    0.000000   10.401166    0.000000
    8    0.000000    4.966200    3.677294    0.000000
    8    0.000000    2.483100    0.000000    2.243351
    8    0.000000    7.449300    0.000000   13.174925
    8    0.000000    2.483100    4.554391    4.206115
    8    0.000000    2.483100    9.524087    4.206115
    8    0.000000    7.449300    9.524087   11.212180
    8    0.000000    7.449300    4.554391   11.212180
    8    0.000000    4.966200    7.039230    7.709138
    8    0.000000    0.000000    7.039230    7.709138
   14    0.000000    2.483100    2.971972    1.606588
   14    0.000000    2.483100   11.106506    1.606588
   14    0.000000    7.449300   11.106506   13.811687
   14    0.000000    7.449300    2.971972   13.811687
   14    0.000000    2.483100    7.039230    5.959157
   14    0.000000    7.449300    7.039230    9.459119
</pre></div>
</div>
<p>Now consider the case that 6 effective electrons were used for oxygen and 4
effective electrons for silicon. Then, the second column in the atom lines
has to be set to the effective core charge. (This number is not used in the
cube format.) In this case, you get:</p>
<div class="highlight-python"><div class="highlight"><pre>-Quickstep-
 ELECTRON DENSITY
   18    0.000000    0.000000    0.000000
   54    0.183933    0.000000    0.000000
   75    0.000000    0.187713    0.000000
   81    0.000000    0.000000    0.190349
    8    6.0         0.000000    3.677294    0.000000
    8    6.0         4.966200   10.401166    0.000000
    8    6.0         0.000000   10.401166    0.000000
    8    6.0         4.966200    3.677294    0.000000
    8    6.0         2.483100    0.000000    2.243351
    8    6.0         7.449300    0.000000   13.174925
    8    6.0         2.483100    4.554391    4.206115
    8    6.0         2.483100    9.524087    4.206115
    8    6.0         7.449300    9.524087   11.212180
    8    6.0         7.449300    4.554391   11.212180
    8    6.0         4.966200    7.039230    7.709138
    8    6.0         0.000000    7.039230    7.709138
   14    4.0         2.483100    2.971972    1.606588
   14    4.0         2.483100   11.106506    1.606588
   14    4.0         7.449300   11.106506   13.811687
   14    4.0         7.449300    2.971972   13.811687
   14    4.0         2.483100    7.039230    5.959157
   14    4.0         7.449300    7.039230    9.459119
</pre></div>
</div>
</li>
<li><p class="first">The output file (HDF5 format) in which the partitioning results are written.
Usually, the output file has the extension
<code class="docutils literal"><span class="pre">.h5</span></code>. The output file is optionally followed by a colon and a group
suffix. This suffix can be used to specify a group in the HDF5 output file
where the output is stored.</p>
</li>
<li><p class="first">The third argument refers to the partitioning scheme:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">h</span></code>: Hirshfeld partitioning. <a class="reference internal" href="tech_ref_literature.html#hirshfeld1977" id="id14">[hirshfeld1977]</a></li>
<li><code class="docutils literal"><span class="pre">hi</span></code>: Iterative Hirshfeld partitioning. <a class="reference internal" href="tech_ref_literature.html#bultinck2007" id="id15">[bultinck2007]</a></li>
<li><code class="docutils literal"><span class="pre">he</span></code>: Extended Hirshfeld partitioning. <a class="reference internal" href="tech_ref_literature.html#verstraelen2013" id="id16">[verstraelen2013]</a></li>
</ul>
</div></blockquote>
</li>
<li><p class="first">The fourth argument is the pro-atom database generated with <code class="docutils literal"><span class="pre">horton-atomdb.py</span></code> script.</p>
</li>
</ol>
<p>The <code class="docutils literal"><span class="pre">horton-cpart.py</span></code> script computes atomic weight functions, and then derives
all AIM observables that are implemented for that scheme. These results are
stored in the specifief HDF5 output file.</p>
<p>The <code class="docutils literal"><span class="pre">horton-cpart.py</span></code> script is somewhat experimental. Always make sure that the
numbers converge with an increase in the number of grid points. You may need the
following options to control the efficiency of the program:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">--compact</span> <span class="pre">COMPACT</span></code>. Automatically determine cutoff radii for the pro-atoms,
where <code class="docutils literal"><span class="pre">COMPACT</span></code> is the maximum number of electrons lost in the tail after
the cutoff radius. 0.001 is typically a reasonable value for <code class="docutils literal"><span class="pre">COMPACT</span></code>. The
pro-atoms are renormalized after setting the cutoff radii. One cutoff radius
is defined per element. This implies that the tail of the most diffuse anion
determines the cutoff radius when the <code class="docutils literal"><span class="pre">--compact</span></code> option is used.</li>
<li><code class="docutils literal"><span class="pre">--greedy</span></code>. This enables a more memory-hungry version of the Iterative and
Extended Hirshfeld algorithms that runs considerably faster. This becomes
unfeasible for systems with huge unit cells.</li>
<li><code class="docutils literal"><span class="pre">--stride</span> <span class="pre">STRIDE</span></code>. The <code class="docutils literal"><span class="pre">STRIDE</span></code> parameter controls the sub-sampling of the
cube file prior to the partitioning. It is <code class="docutils literal"><span class="pre">1</span></code> by default.</li>
</ul>
<p>To get a complete list of command-line options, run:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">horton</span><span class="o">-</span><span class="n">cpart</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">help</span>
</pre></div>
</div>
</div>
<div class="section" id="python-interface-to-the-partitioning-code">
<span id="partition"></span><h2>5.1.5. Python interface to the partitioning code<a class="headerlink" href="#python-interface-to-the-partitioning-code" title="Permalink to this headline"></a></h2>
<p>The <code class="docutils literal"><span class="pre">horton-wpart.py</span></code> and <code class="docutils literal"><span class="pre">horton-cpart.py</span></code> scripts have a rather intuitive
Python interface that allows you to run a more customized analysis. The script
<code class="docutils literal"><span class="pre">data/examples/wpart/becke.py</span></code> is a simple example that runs a Becke partitioning
to compute charges and that writes the charges into a simple text file.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#!/usr/bin/env python</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">horton</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c"># Load the Gaussian output from file</span>
<span class="n">fn_fchk</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">get_fn</span><span class="p">(</span><span class="s">&#39;test/water_sto3g_hf_g03.fchk&#39;</span><span class="p">)</span>
<span class="c"># Replace the previous line with any other fchk file, e.g. fn_fchk = &#39;yourfile.fchk&#39;.</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">IOData</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">fn_fchk</span><span class="p">)</span>

<span class="c"># Partition the density with the Becke scheme</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">BeckeMolGrid</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">coordinates</span><span class="p">,</span> <span class="n">mol</span><span class="o">.</span><span class="n">numbers</span><span class="p">,</span> <span class="n">mol</span><span class="o">.</span><span class="n">pseudo_numbers</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s">&#39;only&#39;</span><span class="p">)</span>
<span class="n">moldens</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">obasis</span><span class="o">.</span><span class="n">compute_grid_density_dm</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">get_dm_full</span><span class="p">(),</span> <span class="n">grid</span><span class="o">.</span><span class="n">points</span><span class="p">)</span>
<span class="n">wpart</span> <span class="o">=</span> <span class="n">BeckeWPart</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">coordinates</span><span class="p">,</span> <span class="n">mol</span><span class="o">.</span><span class="n">numbers</span><span class="p">,</span> <span class="n">mol</span><span class="o">.</span><span class="n">pseudo_numbers</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">moldens</span><span class="p">,</span> <span class="n">local</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">wpart</span><span class="o">.</span><span class="n">do_charges</span><span class="p">()</span>

<span class="c"># Write the result to a file</span>
<span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="s">&#39;charges.txt&#39;</span><span class="p">,</span> <span class="n">wpart</span><span class="p">[</span><span class="s">&#39;charges&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>The unit tests in the source code contain many small examples that can be used
as a starting point for similar scripts. These unit tests can be found in
<code class="docutils literal"><span class="pre">horton/part/test/test_wpart.py</span></code> and <code class="docutils literal"><span class="pre">horton/part/test/test_cpart.py</span></code>.</p>
</div>
<div class="section" id="frequently-asked-questions">
<span id="faq"></span><h2>5.1.6. Frequently asked questions<a class="headerlink" href="#frequently-asked-questions" title="Permalink to this headline"></a></h2>
<p><strong>Which atoms-in-molecules (AIM) partitioning scheme should I use?</strong></p>
<blockquote>
<div><p>There is no single partitioning scheme that is most suitable for any
application. Nevertheless, some people claim that only one AIM scheme should
be used above all others, especially in the QTAIM and electron density
communities. Try to stay away from such fanboyism, as it has little to do
with good science.</p>
<p>In practice, the choice depends on the purposes you have in mind. You should
try to select a scheme that shows some desirable behavior.
Typically, you would like to have a compromise between some of the following
features:</p>
<ul class="simple">
<li>Numerical stability</li>
<li>Robustness with respect to conformational changes</li>
<li>Uniqueness of the result</li>
<li>Computational efficiency</li>
<li>Mathematical elegance</li>
<li>Simplicity</li>
<li>Linearity in the density (matrix)</li>
<li>Chemical transferability</li>
<li>Applicable to a broad range of systems</li>
<li>Applicable to periodic/isolated systems</li>
<li>Applicable to a broad range of electronic structure methods/implementations</li>
<li>Accuracy of electrostatic interactions with a limited multipole expansion
of the atoms</li>
<li>Good (empirical) correlations between some AIM property with some experimental
observable</li>
<li>...</li>
</ul>
<p>It goes beyond the scope of this FAQ to describe how each partitioning scheme
(implemented in HORTON or not) performs for these features. Some of these
features are very difficult to assess and, therefore, are subject to intense
debate in the literature.</p>
<p>Regarding our own work, the following papers are directly related to this
question:</p>
<ul class="simple">
<li><a class="reference internal" href="tech_ref_literature.html#verstraelen2011a" id="id17">[verstraelen2011a]</a> &#8220;Assessment of Atomic Charge Models for Gas-Phase Computations on Polypeptides&#8221;</li>
<li><a class="reference internal" href="tech_ref_literature.html#verstraelen2012a" id="id18">[verstraelen2012a]</a> &#8220;The conformational sensitivity of iterative stockholder partitioning schemes&#8221;</li>
<li><a class="reference internal" href="tech_ref_literature.html#verstraelen2013" id="id19">[verstraelen2013]</a> &#8220;Hirshfeld-E Partitioning: AIM Charges with an Improved Trade-off between Robustness and Accurate Electrostatics&#8221;</li>
</ul>
<p>The following are also related to this question, but the list is far from
complete:</p>
<ul class="simple">
<li><a class="reference internal" href="tech_ref_literature.html#bultinck2007" id="id20">[bultinck2007]</a> &#8220;Critical analysis and extension of the Hirshfeld atoms in molecules&#8221;</li>
<li><a class="reference internal" href="tech_ref_literature.html#bultinck2007b" id="id21">[bultinck2007b]</a> &#8220;Uniqueness and basis set dependence of iterative Hirshfeld charges&#8221;</li>
</ul>
<p>If you have more suggestions, please drop me a note: <a class="reference external" href="mailto:Toon&#46;Verstraelen&#37;&#52;&#48;UGent&#46;be">Toon<span>&#46;</span>Verstraelen<span>&#64;</span>UGent<span>&#46;</span>be</a>.</p>
</div></blockquote>
<p><strong>What is the recommended level of theory for computing the pro-atom databses?</strong></p>
<blockquote>
<div><p>This question is relevant to the following methods implemented in HORTON:
Hirshfeld, Hirshfeld-I and Hirshfeld-E, which require a pro-atoms database. They are referred to in this answer
as Hirshfeld-like schemes.</p>
<p>In principle, you are free to choose any level of theory. In
practice, several papers tend to be consistent in the level of theory (and
basis set) that is used for the molecular and pro-atomic computations.
See for example: <a class="reference internal" href="tech_ref_literature.html#bultinck2007" id="id22">[bultinck2007]</a>, <a class="reference internal" href="tech_ref_literature.html#verstraelen2009" id="id23">[verstraelen2009]</a>, <a class="reference internal" href="tech_ref_literature.html#verstraelen2011a" id="id24">[verstraelen2011a]</a>,
<a class="reference internal" href="tech_ref_literature.html#verstraelen2011b" id="id25">[verstraelen2011b]</a>, <a class="reference internal" href="tech_ref_literature.html#vanduyfhuys2012" id="id26">[vanduyfhuys2012]</a>, <a class="reference internal" href="tech_ref_literature.html#verstraelen2012a" id="id27">[verstraelen2012a]</a>,
<a class="reference internal" href="tech_ref_literature.html#verstraelen2012b" id="id28">[verstraelen2012b]</a>, <a class="reference internal" href="tech_ref_literature.html#verstraelen2013" id="id29">[verstraelen2013]</a>.</p>
<p>One motivation for this consistency is that Hirshfeld-like partitioning
schemes yield atoms-in-molecules that are maximally similar to the
pro-atoms. <a class="reference internal" href="tech_ref_literature.html#nalewajski2000" id="id30">[nalewajski2000]</a> (Technically speaking, the sum
of the <a class="reference external" href="https://en.wikipedia.org/wiki/Kullback%E2%80%93Leibler_divergence">Kullback-Leibler divergence</a>
between the atomic and pro-atomic densities for all the atoms is minimized.)
This principle is (or should be) one of the reasons that Hirshfeld-like
charges are somewhat transferable between chemically similar atoms. You
could hope that the Kullback-Leibler divergence is easier to minimize when
the molecular and pro-atomic densities are computed as consistently as
possible. Thus, using the same level of theory and basis set is advised.</p>
<p>Another motivation is that such consistency may (to some degree) result in,
cancellation of errors, when comparing Hirshfeld-like charges computed at different
levels of theory. For example, it is found that Hirshfeld-I charges have
only a small basis set dependency based on <a class="reference internal" href="tech_ref_literature.html#bultinck2007b" id="id31">[bultinck2007b]</a>. In this work, the
molecular and pro-atomic densities were computed consistently.</p>
<p>At the end, it can also be argued that without consistency in the level of
theory, there are so many possible combinations that it becomes impossible
to make a well-motivated choice. Then again, this is a problem that
computational chemists usually embrace with open arms hoping that they
will find a unique combination of levels of theory that turns out to be
useful.</p>
</div></blockquote>
<p><strong>How can one generate Cube files with CP2K?</strong></p>
<blockquote>
<div>Electron density cube files can be generated with CP2K by adding the following section to the CP2K input file: <a class="reference external" href="http://manual.cp2k.org/trunk/CP2K_INPUT/FORCE_EVAL/DFT/PRINT/E_DENSITY_CUBE.html">E_DENSITY_CUBE</a>.</div></blockquote>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="user_postproc_espfit.html" class="btn btn-neutral float-right" title="5.2. Electrostatic potential fitting" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="user_postproc.html" class="btn btn-neutral" title="5. Post-processing" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div>Documentation for HORTON 2.0.0 built from release 2.0.0. </div>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2011-2015, The HORTON Development Team.
      Last updated on Jun 11, 2015.
    </p>
  </div>

  <div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  </div>
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'2.0.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>