import numpy as np

#
# Transformation matrices. Generated by horton/tools/harmonics.py
#

tf0 = np.array([
    [1.0],
])
# tf1 = np.array([
# [0, 0, 1.0],  # By convention, the p-shells are not permuted
# [1.0, 0, 0],
# [0, 1.0, 0],
# ])
tf1 = np.eye(3)
tf2 = np.array([
    [-0.5, 0, 0, -0.5, 0, 1.0],
    [0, 0, 1.0, 0, 0, 0],
    [0, 0, 0, 0, 1.0, 0],
    [0.86602540378443864676, 0, 0, -0.86602540378443864676, 0, 0],
    [0, 1.0, 0, 0, 0, 0],
])
tf3 = np.array([
    [0, 0, -0.67082039324993690892, 0, 0, 0, 0, -0.67082039324993690892, 0, 1.0],
    [-0.61237243569579452455, 0, 0, -0.27386127875258305673, 0, 1.0954451150103322269, 0, 0, 0, 0],
    [0, -0.27386127875258305673, 0, 0, 0, 0, -0.61237243569579452455, 0, 1.0954451150103322269, 0],
    [0, 0, 0.86602540378443864676, 0, 0, 0, 0, -0.86602540378443864676, 0, 0],
    [0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0],
    [0.790569415042094833, 0, 0, -1.0606601717798212866, 0, 0, 0, 0, 0, 0],
    [0, 1.0606601717798212866, 0, 0, 0, 0, -0.790569415042094833, 0, 0, 0],
])
tf4 = np.array([
    [0.375, 0, 0, 0.21957751641341996535, 0, -0.87831006565367986142, 0, 0, 0, 0, 0.375, 0,
     -0.87831006565367986142, 0, 1.0],
    [0, 0, -0.89642145700079522998, 0, 0, 0, 0, -0.40089186286863657703, 0, 1.19522860933439364, 0,
     0, 0, 0, 0],
    [0, 0, 0, 0, -0.40089186286863657703, 0, 0, 0, 0, 0, 0, -0.89642145700079522998, 0,
     1.19522860933439364, 0],
    [-0.5590169943749474241, 0, 0, 0, 0, 0.9819805060619657157, 0, 0, 0, 0, 0.5590169943749474241,
     0, -0.9819805060619657157, 0, 0],
    [0, -0.42257712736425828875, 0, 0, 0, 0, -0.42257712736425828875, 0, 1.1338934190276816816, 0,
     0, 0, 0, 0, 0],
    [0, 0, 0.790569415042094833, 0, 0, 0, 0, -1.0606601717798212866, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 1.0606601717798212866, 0, 0, 0, 0, 0, 0, -0.790569415042094833, 0, 0, 0],
    [0.73950997288745200532, 0, 0, -1.2990381056766579701, 0, 0, 0, 0, 0, 0, 0.73950997288745200532,
     0, 0, 0, 0],
    [0, 1.1180339887498948482, 0, 0, 0, 0, -1.1180339887498948482, 0, 0, 0, 0, 0, 0, 0, 0],
])
tf5 = np.array([
    [0, 0, 0.625, 0, 0, 0, 0, 0.36596252735569994226, 0, -1.0910894511799619063, 0, 0, 0, 0, 0, 0,
     0.625, 0, -1.0910894511799619063, 0, 1.0],
    [0.48412291827592711065, 0, 0, 0.21128856368212914438, 0, -1.2677313820927748663, 0, 0, 0, 0,
     0.16137430609197570355, 0, -0.56694670951384084082, 0, 1.2909944487358056284, 0, 0, 0, 0, 0,
     0],
    [0, 0.16137430609197570355, 0, 0, 0, 0, 0.21128856368212914438, 0, -0.56694670951384084082, 0,
     0, 0, 0, 0, 0, 0.48412291827592711065, 0, -1.2677313820927748663, 0, 1.2909944487358056284, 0],
    [0, 0, -0.85391256382996653193, 0, 0, 0, 0, 0, 0, 1.1180339887498948482, 0, 0, 0, 0, 0, 0,
     0.85391256382996653193, 0, -1.1180339887498948482, 0, 0],
    [0, 0, 0, 0, -0.6454972243679028142, 0, 0, 0, 0, 0, 0, -0.6454972243679028142, 0,
     1.2909944487358056284, 0, 0, 0, 0, 0, 0, 0],
    [-0.52291251658379721749, 0, 0, 0.22821773229381921394, 0, 0.91287092917527685576, 0, 0, 0, 0,
     0.52291251658379721749, 0, -1.2247448713915890491, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, -0.52291251658379721749, 0, 0, 0, 0, -0.22821773229381921394, 0, 1.2247448713915890491, 0,
     0, 0, 0, 0, 0, 0.52291251658379721749, 0, -0.91287092917527685576, 0, 0, 0],
    [0, 0, 0.73950997288745200532, 0, 0, 0, 0, -1.2990381056766579701, 0, 0, 0, 0, 0, 0, 0, 0,
     0.73950997288745200532, 0, 0, 0, 0],
    [0, 0, 0, 0, 1.1180339887498948482, 0, 0, 0, 0, 0, 0, -1.1180339887498948482, 0, 0, 0, 0, 0, 0,
     0, 0, 0],
    [0.7015607600201140098, 0, 0, -1.5309310892394863114, 0, 0, 0, 0, 0, 0, 1.169267933366856683, 0,
     0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 1.169267933366856683, 0, 0, 0, 0, -1.5309310892394863114, 0, 0, 0, 0, 0, 0, 0, 0,
     0.7015607600201140098, 0, 0, 0, 0, 0],
])
tf6 = np.array([
    [-0.3125, 0, 0, -0.16319780245846672329, 0, 0.97918681475080033975, 0, 0, 0, 0,
     -0.16319780245846672329, 0, 0.57335309036732873772, 0, -1.3055824196677337863, 0, 0, 0, 0, 0,
     0, -0.3125, 0, 0.97918681475080033975, 0, -1.3055824196677337863, 0, 1.0],
    [0, 0, 0.86356159963469679725, 0, 0, 0, 0, 0.37688918072220452831, 0, -1.6854996561581052156, 0,
     0, 0, 0, 0, 0, 0.28785386654489893242, 0, -0.75377836144440905662, 0, 1.3816985594155148756, 0,
     0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0.28785386654489893242, 0, 0, 0, 0, 0, 0, 0.37688918072220452831, 0,
     -0.75377836144440905662, 0, 0, 0, 0, 0, 0, 0, 0, 0.86356159963469679725, 0,
     -1.6854996561581052156, 0, 1.3816985594155148756, 0],
    [0.45285552331841995543, 0, 0, 0.078832027985861408788, 0, -1.2613124477737825406, 0, 0, 0, 0,
     -0.078832027985861408788, 0, 0, 0, 1.2613124477737825406, 0, 0, 0, 0, 0, 0,
     -0.45285552331841995543, 0, 1.2613124477737825406, 0, -1.2613124477737825406, 0, 0],
    [0, 0.27308215547040717681, 0, 0, 0, 0, 0.26650089544451304287, 0, -0.95346258924559231545, 0,
     0, 0, 0, 0, 0, 0.27308215547040717681, 0, -0.95346258924559231545, 0, 1.4564381625088382763, 0,
     0, 0, 0, 0, 0, 0, 0],
    [0, 0, -0.81924646641122153043, 0, 0, 0, 0, 0.35754847096709711829, 0, 1.0660035817780521715, 0,
     0, 0, 0, 0, 0, 0.81924646641122153043, 0, -1.4301938838683884732, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, -0.81924646641122153043, 0, 0, 0, 0, 0, 0, -0.35754847096709711829, 0,
     1.4301938838683884732, 0, 0, 0, 0, 0, 0, 0, 0, 0.81924646641122153043, 0,
     -1.0660035817780521715, 0, 0, 0],
    [-0.49607837082461073572, 0, 0, 0.43178079981734839863, 0, 0.86356159963469679725, 0, 0, 0, 0,
     0.43178079981734839863, 0, -1.5169496905422946941, 0, 0, 0, 0, 0, 0, 0, 0,
     -0.49607837082461073572, 0, 0.86356159963469679725, 0, 0, 0, 0],
    [0, -0.59829302641309923139, 0, 0, 0, 0, 0, 0, 1.3055824196677337863, 0, 0, 0, 0, 0, 0,
     0.59829302641309923139, 0, -1.3055824196677337863, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0.7015607600201140098, 0, 0, 0, 0, -1.5309310892394863114, 0, 0, 0, 0, 0, 0, 0, 0,
     1.169267933366856683, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 1.169267933366856683, 0, 0, 0, 0, 0, 0, -1.5309310892394863114, 0, 0, 0, 0, 0, 0,
     0, 0, 0, 0, 0.7015607600201140098, 0, 0, 0, 0, 0],
    [0.67169328938139615748, 0, 0, -1.7539019000502850245, 0, 0, 0, 0, 0, 0, 1.7539019000502850245,
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -0.67169328938139615748, 0, 0, 0, 0, 0, 0],
    [0, 1.2151388809514737933, 0, 0, 0, 0, -1.9764235376052370825, 0, 0, 0, 0, 0, 0, 0, 0,
     1.2151388809514737933, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
])
tf7 = np.array([
    [0, 0, -0.60670333962134435221, 0, 0, 0, 0, -0.31684048566533184861, 0, 1.4169537279434593918,
     0, 0, 0, 0, 0, 0, -0.31684048566533184861, 0, 0.82968314787883083417, 0,
     -1.5208343311935928733, 0, 0, 0, 0, 0, 0, 0, 0, -0.60670333962134435221, 0,
     1.4169537279434593918, 0, -1.5208343311935928733, 0, 1.0],
    [-0.41339864235384227977, 0, 0, -0.17963167078872714852, 0, 1.4370533663098171882, 0, 0, 0, 0,
     -0.13388954226515238921, 0, 0.62718150750531807803, 0, -2.1422326762424382273, 0, 0, 0, 0, 0,
     0, -0.1146561540164598136, 0, 0.47901778876993906273, 0, -0.95803557753987812546, 0,
     1.4675987714106856141, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, -0.1146561540164598136, 0, 0, 0, 0, -0.13388954226515238921, 0, 0.47901778876993906273, 0,
     0, 0, 0, 0, 0, -0.17963167078872714852, 0, 0.62718150750531807803, 0, -0.95803557753987812546,
     0, 0, 0, 0, 0, 0, 0, 0, -0.41339864235384227977, 0, 1.4370533663098171882, 0,
     -2.1422326762424382273, 0, 1.4675987714106856141, 0],
    [0, 0, 0.84254721963085980365, 0, 0, 0, 0, 0.14666864502533059662, 0, -1.7491256557036030854, 0,
     0, 0, 0, 0, 0, -0.14666864502533059662, 0, 0, 0, 1.4080189922431737275, 0, 0, 0, 0, 0, 0, 0, 0,
     -0.84254721963085980365, 0, 1.7491256557036030854, 0, -1.4080189922431737275, 0, 0],
    [0, 0, 0, 0, 0.50807509012231371428, 0, 0, 0, 0, 0, 0, 0.49583051751369852316, 0,
     -1.3222147133698627284, 0, 0, 0, 0, 0, 0, 0, 0, 0.50807509012231371428, 0,
     -1.3222147133698627284, 0, 1.6258402883914038857, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0.42961647140211000062, 0, 0, -0.062226236090912312563, 0, -1.2445247218182462513, 0, 0, 0, 0,
     -0.23190348980538452414, 0, 0.54315511828342602619, 0, 1.2368186122953841287, 0, 0, 0, 0, 0, 0,
     -0.35746251148251142922, 0, 1.2445247218182462513, 0, -1.6593662957576616683, 0, 0, 0, 0, 0, 0,
     0, 0, 0, 0],
    [0, 0.35746251148251142922, 0, 0, 0, 0, 0.23190348980538452414, 0, -1.2445247218182462513, 0, 0,
     0, 0, 0, 0, 0.062226236090912312563, 0, -0.54315511828342602619, 0, 1.6593662957576616683, 0,
     0, 0, 0, 0, 0, 0, 0, -0.42961647140211000062, 0, 1.2445247218182462513, 0,
     -1.2368186122953841287, 0, 0, 0],
    [0, 0, -0.79037935147039945351, 0, 0, 0, 0, 0.6879369240987588816, 0, 1.025515817677958738, 0,
     0, 0, 0, 0, 0, 0.6879369240987588816, 0, -1.8014417303072302517, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
     -0.79037935147039945351, 0, 1.025515817677958738, 0, 0, 0, 0],
    [0, 0, 0, 0, -0.95323336395336381126, 0, 0, 0, 0, 0, 0, 0, 0, 1.5504341823651057024, 0, 0, 0, 0,
     0, 0, 0, 0, 0.95323336395336381126, 0, -1.5504341823651057024, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
     0],
    [-0.47495887979908323849, 0, 0, 0.61914323168888299344, 0, 0.82552430891851065792, 0, 0, 0, 0,
     0.25637895441948968451, 0, -1.8014417303072302517, 0, 0, 0, 0, 0, 0, 0, 0,
     -0.65864945955866621126, 0, 1.3758738481975177632, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, -0.65864945955866621126, 0, 0, 0, 0, 0.25637895441948968451, 0, 1.3758738481975177632, 0, 0,
     0, 0, 0, 0, 0.61914323168888299344, 0, -1.8014417303072302517, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
     -0.47495887979908323849, 0, 0.82552430891851065792, 0, 0, 0, 0, 0],
    [0, 0, 0.67169328938139615748, 0, 0, 0, 0, -1.7539019000502850245, 0, 0, 0, 0, 0, 0, 0, 0,
     1.7539019000502850245, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -0.67169328938139615748, 0, 0, 0, 0,
     0, 0],
    [0, 0, 0, 0, 1.2151388809514737933, 0, 0, 0, 0, 0, 0, -1.9764235376052370825, 0, 0, 0, 0, 0, 0,
     0, 0, 0, 0, 1.2151388809514737933, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0.64725984928774934788, 0, 0, -1.96875, 0, 0, 0, 0, 0, 0, 2.4456993503903949804, 0, 0, 0, 0, 0,
     0, 0, 0, 0, 0, -1.2566230789301937693, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 1.2566230789301937693, 0, 0, 0, 0, -2.4456993503903949804, 0, 0, 0, 0, 0, 0, 0, 0, 1.96875,
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -0.64725984928774934788, 0, 0, 0, 0, 0, 0, 0],
])

tfs = [tf0, tf1, tf2, tf3, tf4, tf5, tf6, tf7]

#
# Cartesian shell iterators. Generated by get_iter_pow().
#

# def get_iter_pow(n):
#     """Gives the ordering within shells.
#     See http://theochem.github.io/horton/2.1.0b1/tech_ref_gaussian_basis.html for details."""
#     for nx in range(n, -1, -1):
#         for ny in range(n - nx, -1, -1):
#             nz = n - nx - ny
#             yield np.array((nx, ny, nz), dtype=int)

iter0 = np.array(((0, 0, 0),), dtype=int)
iter1 = np.array(((1, 0, 0),
                  (0, 1, 0),
                  (0, 0, 1)), dtype=int)
iter2 = np.array(((2, 0, 0),
                  (1, 1, 0),
                  (1, 0, 1),
                  (0, 2, 0),
                  (0, 1, 1),
                  (0, 0, 2)), dtype=int)
iter3 = np.array(((3, 0, 0),
                  (2, 1, 0),
                  (2, 0, 1),
                  (1, 2, 0),
                  (1, 1, 1),
                  (1, 0, 2),
                  (0, 3, 0),
                  (0, 2, 1),
                  (0, 1, 2),
                  (0, 0, 3)), dtype=int)
iter4 = np.array(((4, 0, 0),
                  (3, 1, 0),
                  (3, 0, 1),
                  (2, 2, 0),
                  (2, 1, 1),
                  (2, 0, 2),
                  (1, 3, 0),
                  (1, 2, 1),
                  (1, 1, 2),
                  (1, 0, 3),
                  (0, 4, 0),
                  (0, 3, 1),
                  (0, 2, 2),
                  (0, 1, 3),
                  (0, 0, 4)), dtype=int)
iter5 = np.array(((5, 0, 0),
                  (4, 1, 0),
                  (4, 0, 1),
                  (3, 2, 0),
                  (3, 1, 1),
                  (3, 0, 2),
                  (2, 3, 0),
                  (2, 2, 1),
                  (2, 1, 2),
                  (2, 0, 3),
                  (1, 4, 0),
                  (1, 3, 1),
                  (1, 2, 2),
                  (1, 1, 3),
                  (1, 0, 4),
                  (0, 5, 0),
                  (0, 4, 1),
                  (0, 3, 2),
                  (0, 2, 3),
                  (0, 1, 4),
                  (0, 0, 5)), dtype=int)
iter6 = np.array(((6, 0, 0),
                  (5, 1, 0),
                  (5, 0, 1),
                  (4, 2, 0),
                  (4, 1, 1),
                  (4, 0, 2),
                  (3, 3, 0),
                  (3, 2, 1),
                  (3, 1, 2),
                  (3, 0, 3),
                  (2, 4, 0),
                  (2, 3, 1),
                  (2, 2, 2),
                  (2, 1, 3),
                  (2, 0, 4),
                  (1, 5, 0),
                  (1, 4, 1),
                  (1, 3, 2),
                  (1, 2, 3),
                  (1, 1, 4),
                  (1, 0, 5),
                  (0, 6, 0),
                  (0, 5, 1),
                  (0, 4, 2),
                  (0, 3, 3),
                  (0, 2, 4),
                  (0, 1, 5),
                  (0, 0, 6)), dtype=int)
iter7 = np.array(((7, 0, 0),
                  (6, 1, 0),
                  (6, 0, 1),
                  (5, 2, 0),
                  (5, 1, 1),
                  (5, 0, 2),
                  (4, 3, 0),
                  (4, 2, 1),
                  (4, 1, 2),
                  (4, 0, 3),
                  (3, 4, 0),
                  (3, 3, 1),
                  (3, 2, 2),
                  (3, 1, 3),
                  (3, 0, 4),
                  (2, 5, 0),
                  (2, 4, 1),
                  (2, 3, 2),
                  (2, 2, 3),
                  (2, 1, 4),
                  (2, 0, 5),
                  (1, 6, 0),
                  (1, 5, 1),
                  (1, 4, 2),
                  (1, 3, 3),
                  (1, 2, 4),
                  (1, 1, 5),
                  (1, 0, 6),
                  (0, 7, 0),
                  (0, 6, 1),
                  (0, 5, 2),
                  (0, 4, 3),
                  (0, 3, 4),
                  (0, 2, 5),
                  (0, 1, 6),
                  (0, 0, 7)), dtype=int)

iter_pow = (iter0, iter1, iter2, iter3, iter4, iter5, iter6, iter7)
